[{"content":"\u003ch1 id=\"presentation-patterns\"\u003ePresentation Patterns\u003c/h1\u003e\n\u003cp\u003eWritten by \u003cstrong\u003e\u003ca href=\"https://nealford.com/\"\u003eNeal Ford\u003c/a\u003e, \u003ca href=\"https://matthewjmccullough.com\"\u003eMatthew McCullough\u003c/a\u003e and \u003ca href=\"http://ntschutta.io\"\u003eNathaniel Schutta\u003c/a\u003e\u003c/strong\u003e, \u003cstrong\u003e\u0026ldquo;Presentation Patterns - Techniques for Crafting Better Presentations\u0026rdquo;\u003c/strong\u003e is an encyclopedia of patterns, tips and common mistakes experienced by the authors, who have delivered thousands of presentations. In particular, they introduce â€œ\u003ca href=\"https://www.nofluffjuststuff.com\"\u003eNo Fluff, Just Stuff\u003c/a\u003eâ€œ, a traveling technical conference series covering a\nwide variety of topics related to software development and management.\u003c/p\u003e\n\u003cp\u003eDuring the years, they have build up their toolbox of patterns to provide killer presentations, which are divided in three main sections: \u003cstrong\u003ePrepare\u003c/strong\u003e (thinking and setting up the presentationâ€™s key concepts), \u003cstrong\u003eBuild\u003c/strong\u003e (creating the slides), \u003cstrong\u003eDeliver\u003c/strong\u003e (present the content). While reading, I decided to categorize the items into \u003cstrong\u003ePatterns\u003c/strong\u003e, \u003cstrong\u003eAntipatterns\u003c/strong\u003e and â€œ\u003cstrong\u003eOthers\u003c/strong\u003eâ€ (type of slides or special kind of presentations which I didn\u0026rsquo;t consider as a pattern).\u003c/p\u003e\n\u003cp\u003eThe book is very conference-centric with a precise focus on the IT world, which does makes sense from the authorâ€™s experience. Thatâ€™s welcomed with great joy by me, even if some patterns are difficult to apply in my corporate environment, where the â€œInfoDeckâ€ structure is requested almost every time.\u003c/p\u003e\n\u003cp\u003eNonetheless, I think that there are numerous key concepts to learn in â€œPresentation Patternâ€! Thanks to its clear structure the reading is entertaining and I immediately grasped a lot of notions that I will apply in my presentations. That is one of the most useful books Iâ€™ve read!\u003c/p\u003e\n\u003cp\u003eâ€œPresentation Patternsâ€ has a \u003ca href=\"https://presentationpatterns.com/glossary/\"\u003edetailed glossary\u003c/a\u003e with a recap of each pattern, but I decided to write down my notes in my own way to make sure to understand every concept. By sharing them, I hope they will be useful and help making more interesting content!\u003c/p\u003e\n\u003cp\u003eYou can buy the book \u003ca href=\"https://presentationpatterns.com/\"\u003ehere\u003c/a\u003e: all credits go to the authors, who I would like to thank for their amazing job.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eKey Takeaway: donâ€™t let the presentation tools influence your message, and you canâ€™t either have a document or a presentation.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2 id=\"span-stylecolorgreen--patternsspan\"\u003e\u003cspan style=\"color:green\"\u003e âœ” Patterns\u003c/span\u003e\u003c/h2\u003e\n\u003ch3 id=\"prepare\"\u003ePrepare\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eğŸ‘€ \u003cstrong\u003eKnow Your Audience\u003c/strong\u003e\nFollow this point to avoid the majority of antipatterns. Explore the event and understand as precise as possible the kind of participants and what they want. Itâ€™s important to understand the tone of the event, if itâ€™s technical or more business-oriented. Social media can help.\u003c/li\u003e\n\u003cli\u003eğŸ‘ª \u003cstrong\u003eSocial Media Advertising\u003c/strong\u003e\nSponsor your talk with social media, by posting about the event and with a brief reminder a few hours before starting.\u003c/li\u003e\n\u003cli\u003eâ“ \u003cstrong\u003eThe Big Why\u003c/strong\u003e\nBefore signing up (or if itâ€™s a Required presentation, thinking about the topic), ask yourself why do you want to talk about that specific thing: you should be truly passionate, otherwise the audience will feel that!\nFor example, you may want to sell a product, introduce a technological improvement, teach something useful, help a community, improve your skills, gain visibility, or achieve personal glory.\u003c/li\u003e\n\u003cli\u003eğŸ“– \u003cstrong\u003eNarrative Arc\u003c/strong\u003e\nThatâ€™s the story we want to tell, as the \u003cstrong\u003eusers are naturally interested in stories\u003c/strong\u003e, and itâ€™s a crucial part for any successful 9and interesting) presentation.\nThe typical schema is\n\u003ccode\u003eIntroduction \u0026amp; Exposition â†’ Complication â†’ Climax â†’ Resolution\u003c/code\u003e\nIntroduce a context, then a problem, then show the solution. Take inspiration from superheroes, where the origin story always raises interest. When presentation attendees recognize the narrative arc, it helps them understand your material because they understand the basic framework and they can follow it in an easier way. Itâ€™s not easy to create from scratch as you have to understand the story behind your presentation, nonetheless you should always start from there.\u003c/li\u003e\n\u003cli\u003eğŸ§  \u003cstrong\u003eForethought\u003c/strong\u003e\nBefore using the presentation tool (PowerPoint, KeyNote,â€¦), \u003cstrong\u003ethink\u003c/strong\u003e. Use Post-It, mind maps, notes, but try not to immediately jump into the slide-based pattern of the tool you are using. Donâ€™t let the presentation tool guide you but follow those four steps:\u003c/li\u003e\n\u003c/ul\u003e\n\u003col\u003e\n\u003cli\u003e\u003cem\u003eIdeate\u003c/em\u003e: generate the idea and how you are going to present it\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eCapture\u003c/em\u003e: capture the idea in an unstructured way, not on the presentation tool yet. Authors suggest an outlining tool\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eOrganize\u003c/em\u003e: find connection, think about the timeline and the structure, eventually cut or expand content\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eDesign\u003c/em\u003e: now you can start using the presentation tool!\u003c/li\u003e\n\u003c/ol\u003e\n\u003cul\u003e\n\u003cli\u003eğŸ§ª \u003cstrong\u003eCrucible\u003c/strong\u003e\nAfter presenting the presentation, you will usually realize that there is something to tweak and improve. Embrace the change, the majority of the authors is constantly reworking their presentations after each conference! After presenting, remember the things that didnâ€™t convince the public (ideally, you should find someone with brutal honesty and criticism to tell you) and update your work.\u003c/li\u003e\n\u003cli\u003eğŸ¤¼ \u003cstrong\u003eConcurrent Presentation\u003c/strong\u003e\nIf you are creating a group presentation, assign a Slide Wrangler who will handle the Master deck and start using the same template so merging pieces wonâ€™t be chaotic. If you want to highlight a â€œTODOâ€ Slide to be enhanced, you can drift out from the template with the ugliest combination of font/colors to draw attention to the issue. Then, each participant will send his piece to the Slide Wrangler, who will put them together.\u003c/li\u003e\n\u003cli\u003e3ï¸âƒ£ \u003cstrong\u003eTriad\u003c/strong\u003e\nBuild your presentation around 3 central ideas, donâ€™t try to overload the public with too much data. It is connected to the Narrative Arc pattern (exposition, conflict, and resolution).\u003c/li\u003e\n\u003cli\u003eğŸ• \u003cstrong\u003eBrain Breaks\u003c/strong\u003e\nEspecially when delivering a presentation with a lot of information: add a break, usually with contextualized humor, to break the tension. Inside jokes add credibility as they mark you as an insider. Neal Ford calculates one joke every 15 minutes, but donâ€™t make them Alienating Artifacts.\u003c/li\u003e\n\u003cli\u003eğŸ¤µ \u003cstrong\u003eLeet Grammars\u003c/strong\u003e\nIt is an alternative alphabet (aka slang) that you can use to be perceived as part as the audience, an insider. It can be easily applied when speaking technical jargon, but be sure to not overuse words you don\u0026rsquo;t know or you will immediately ruin the result (see Tower of Babble antipattern).\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"build\"\u003eBuild\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eğŸ‘¬ \u003cstrong\u003ePeer Review\u003c/strong\u003e\nDonâ€™t let grammar mistakes or common errors ruin the presentation! Try to get help from copyeditors or anyone willing to proofread your work. Avoid the most common issues such as using \u003cstrong\u003epassive voices when unnecessary\u003c/strong\u003e or \u003cstrong\u003eusing complete phrases\u003c/strong\u003e (presentations should summarize my thoughts).\u003c/li\u003e\n\u003cli\u003eğŸ”® \u003cstrong\u003eForeshadowing\u003c/strong\u003e\nPlace little hints at the beginning of the presentation that lead to a final revelation: it will bring the audience to a shared epiphany. It synergies with the Narrative Arc pattern, hovewer use it only once. It can be implicit (an hidden detail) or simply a slide with a question and â€œStay tuned!â€.\u003c/li\u003e\n\u003cli\u003eğŸ› \u003cstrong\u003eGreek Chorus (and Posse)\u003c/strong\u003e\nBring friends to the talk to support you and show positive feedbacks, influencing the other participants.\u003c/li\u003e\n\u003cli\u003eğŸ§© \u003cstrong\u003eComposite Animations\u003c/strong\u003e\nFor a unique animation effect that catches the audience\u0026rsquo;s attention, layer two or more animations on top of each other. Donâ€™t overdo it, use it for key slides and only if you know well which animations you should use.\u003c/li\u003e\n\u003cli\u003eğŸ½ \u003cstrong\u003eÃ la Carte Content\u003c/strong\u003e\nAt the beginning of the presentation, you can poll the audience to construct their agenda by choosing what they want to hear between small chunks of content (Talklets). This is a very complex strategy as you need to be extremely prepared to the different scenarios and create additional material\u0026hellip; It works well in case of a presentation you need to share several times with groups with different knowledge levels.\u003c/li\u003e\n\u003cli\u003eğŸ“» \u003cstrong\u003eAnalog Noise\u003c/strong\u003e\nPlace unpolished elements in the presentation to make a key message stand out (e.g. an ugly font for the title of a slide introducing a problem). Donâ€™t overuse the tecnique. Stand out from the overly polished and aesthetic presentations we currently have.\u003c/li\u003e\n\u003cli\u003eğŸš« \u003cstrong\u003eDefy Defaults\u003c/strong\u003e\nDonâ€™t follow the default settings, stand out from the typical presentation style, especially corporate ones which are riddled with antipatterns. Donâ€™t go directly against the rules, but try to apply the patterns you have learned in a subtle way\u0026hellip; For example by using the corporate template when you have to, but then showing your style in the body of the presentation.\u003c/li\u003e\n\u003cli\u003eâ¤´ \u003cstrong\u003eGradual Consistency (and Soft Transitions)\u003c/strong\u003e\nUse many animations to better convey your message. Difficult to explain without examples, the concept is that by making elements move (e.g. â€œAs Isâ€ â†’ animation that kicks it out of the screen â†’ â€œTo Beâ€ fades in) you can tell an animated story, super effective. Personally, I donâ€™t like animations but the pattern can be useful for simple, key concepts. Use it sparsely, the book relies too much on that. Use soft transitions (dissolve, push) to shift delicately from slide to slide.\u003c/li\u003e\n\u003cli\u003eğŸ‘» \u003cstrong\u003eInvisibility\u003c/strong\u003e\nIn case of an audience that has already read the presentation and knows what you are going to talk about. Add an animation that begins with a blank page (and everyone will be focused on what you are talking about as they canâ€™t be distracted), and then show the content. They canâ€™t expect it in the printout: it will be a surprising moment, but in my opinion itâ€™s too showy.\u003c/li\u003e\n\u003cli\u003eğŸ‘„ \u003cstrong\u003eLipsync\u003c/strong\u003e\n(For Live Demos). Playing live with the tool can be risky, as there are numerous unpredictable issues that can happen. Record yourself before the talk when using the tool and play the video while talking over it or in case of emergency. You can be less stressed, you can skip boring or lengthy moments, you can highlight certain parts. However, you canâ€™t improvise if the audience asks you anything. Suggestion: hide Windows Tray and another unnecessary parts of the screen, as they will distract audience.\u003c/li\u003e\n\u003cli\u003eğŸ“¼ \u003cstrong\u003eLive on Tape\u003c/strong\u003e\nIf travelling issues occur, video-record your presentation like you were live in that same room: this makes the video more natural and engaging.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"deliver\"\u003eDeliver\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eâ›¹ï¸â€â™€ï¸ \u003cstrong\u003ePreparation\u003c/strong\u003e\nAlways be ready for the worst-case scenario. Hard drives can fail, you can come in late, you lose your laptop chargerâ€¦ Prepare your kit in advance the night before and check all the setup (better overdress than not being formal enough), have a backup of the presentation and stay hydrated.\u003c/li\u003e\n\u003cli\u003eğŸ¤ \u003cstrong\u003eSeeding Satisfaction\u003c/strong\u003e\nLike Rock Bands that start with an opening act, you can shake hands, chat and warm up the audience before beginning the talk. Even one friendly face can make the difference, so introducing yourself to strangers and making some good impressions can help. It is also convenient to build connection with other people with the same interests and maybe make the expectations they have about you very clear. Donâ€™t push too much if you see hat they donâ€™t want to socialize.\u003c/li\u003e\n\u003cli\u003eğŸ’µ \u003cstrong\u003eDisplay of High Value\u003c/strong\u003e\nBy instinct, the audience consider the speaker as valuable with an high social status and interesting things to say. Use this concept at your advantage, show that you are prepared and comfortable with the situation. Donâ€™t apologize for technical issues, but move on and keep talking. Donâ€™t let other people (Hecklers) hijack your presentation. Donâ€™t look confused when you canâ€™t reply to a question, suggest ways to follow up later instead.\u003c/li\u003e\n\u003cli\u003eğŸ” \u003cstrong\u003eCarnegie Hall\u003c/strong\u003e\nPractice. Practice.Practice. Present it to your pets first, then to a friendly crowd (friends, colleagues), record yourself if you want to. Trying to repeat it as much as possible forces yourself to get used to talk and to gain confidence and tweak out the small details of the presentation.\u003c/li\u003e\n\u003cli\u003eğŸ» \u003cstrong\u003eEmotional State\u003c/strong\u003e\nTry to understand the overall mood of the people involved, if they are having a good day and how they are feeling. Usually you can achieve it by chatting with the key stakeholders or through social media. Pattern difficult to apply as it may bring to misunderstandings.\u003c/li\u003e\n\u003cli\u003eğŸŒ¬ \u003cstrong\u003eBreathing Room\u003c/strong\u003e\nYou donâ€™t have to speak all the time. Embrace silences. When stressed, you tend to speak faster, to fill up every gap and constantly be active, which reveals your nervousness. Plan some tactical breaks during (and before) key moments, pay attention to the rhythm of your voice. Sometimes the author writes a symbol in the notes to remember to breathe.\u003c/li\u003e\n\u003cli\u003eğŸ¦¶ \u003cstrong\u003eShoeless\u003c/strong\u003e\nAchieve relax with little quirks to help ignoring the stress. Removing shoes may be a bit odd in corporate environments, but the pattern can be extended to everything that makes you more comfortable. Wear your best shirt, some comfortable sneaker, your lucky socks.\u003c/li\u003e\n\u003cli\u003eğŸ‘¨â€ğŸ« \u003cstrong\u003eMentor\u003c/strong\u003e\nDonâ€™t build your presentation with your role being a humble helper. You have to be the mentor of the audience, their guide to a new world they donâ€™t know. They need to feel that you care about it and leave the event enlightened with your wisdom. Preparing a strong Narrative Arc does help.\u003c/li\u003e\n\u003cli\u003eğŸŒ§ \u003cstrong\u003eWeatherman\u003c/strong\u003e\nFace the camera like a Weatherman on the news, donâ€™t look at the screen behind you but speak directly to your audience.\u003c/li\u003e\n\u003cli\u003eğŸ’ \u003cstrong\u003eSeeding the First Question\u003c/strong\u003e\nUsually the audience is embarrassed to ask the first question, you need to find a way to break the ice. A good idea is to serve an obvious question in your presentation. An idea could be mentioning advanced concepts so people can ask questions about them at the end as they are curious.\u003c/li\u003e\n\u003cli\u003eâ›ˆ \u003cstrong\u003eMake It Rain\u003c/strong\u003e\nMove things around (chairs, props, papers) to make the audience more comfortableÃ§ very useful in educational settings, but discouraged in corporate environments. E.g. a speaker moving chairs to visually show concurrency in web applications.\u003c/li\u003e\n\u003cli\u003eğŸ§™â€â™€ï¸ \u003cstrong\u003eEntertainment\u003c/strong\u003e\nUse humor and jokes to better convey your message, as the audience will remember a concept when associated with something funny. Donâ€™t overuse it (leave the joke out if in doubt) or there is high risk of alienating the public; also, it should be relevant to your Narrative Arc and pay attention to not offend anyone.\u003c/li\u003e\n\u003cli\u003eğŸ•¶ \u003cstrong\u003eThe Stakeout\u003c/strong\u003e\nALWAYS go to the talk earlier to avoid last-minute issues, get familiar with the environment, and, if possible, start chatting with the public.\u003c/li\u003e\n\u003cli\u003eğŸ”¦ \u003cstrong\u003eLightsaber\u003c/strong\u003e\nUse the laser pointer judiciously like a skilled Jedi, highlighting the point of the slide you want to focus on when necessary. Itâ€™s not the best way as it attracts the complete attention of the audience, itâ€™s better to use Traveling Highlights, but it gives you more freedom.\u003c/li\u003e\n\u003cli\u003eğŸ”‚ \u003cstrong\u003eEcho Chamber\u003c/strong\u003e\nWhen someone asks you anything, repeat it back to the audience (paraphrased). This pattern helps other people who didnâ€™t hear (or understood) the question well and avoids duplicate questions, and is a good training for summarizing complex concepts.\u003c/li\u003e\n\u003cli\u003eğŸ—‚ \u003cstrong\u003eRed, Yellow, Green\u003c/strong\u003e\n(Difficult to apply in my context, I would use an online form like Microsoft Forms). At the end of the talk, you can ask the public to give a positive, negative or neutral feedback by voting with a colored card.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"span-stylecolorred--antipatternsspan\"\u003e\u003cspan style=\"color:red\"\u003e âŒ Antipatterns\u003c/span\u003e\u003c/h2\u003e\n\u003ch3 id=\"prepare-1\"\u003ePrepare\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eğŸ“› \u003cstrong\u003eAbstract Attorney\u003c/strong\u003e\nInstead of learning from your material, the attorney tries to find whatever tiny detail is not coherent or meaningful compared to his/her expectations (given by the abstract). Usually the complaints come via social media, anyway you donâ€™t need to focus on why the attorney acts like that, but how you can prevent this antipattern.\nâœ” â†’ Keep a vague and mysterious abstract (summary in a couple of lines) at the beginning of the presentation to satisfy the attorney while keeping a lot of flexibility.\u003c/li\u003e\n\u003cli\u003eğŸ‘½ \u003cstrong\u003eAlienating Artifact\u003c/strong\u003e\nThis antipattern happens when a joke goes wrong, negating any possible benefit.\nâœ” â†’ Donâ€™t risk too much with shocking images, cursing or heavy jokes unless you really really know what you are doing and whoâ€™s your audience otherwise you risk to alienate part of the public which wonâ€™t remember your talk for your content, but because of the negatively-perceived event.\u003c/li\u003e\n\u003cli\u003eğŸ¥’ \u003cstrong\u003eCelery\u003c/strong\u003e\nLike celery, a presentation should not burns more calories in consumption than it provides in usable energy: it shouldn\u0026rsquo;t require much effort to attend it. It sometimes happens with Required presentation, too simple/technical topics (lack of knowledge of the audience) or due date if you made it very quickly.\nThe result of a celery presentation is â€œwell, thatâ€™s an hour of my life Iâ€™ll never get backâ€.\nâœ” â†’ Know your audience and stick to your story and present a compelling Narrative Arc.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"build-1\"\u003eBuild\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eğŸª \u003cstrong\u003eCookie Cutter\u003c/strong\u003e\nPutting too much content in a single slide will saturate your presentation and have a negative effect to the audience. When you start filling all the blank gaps in slides, you are allowing the medium to alter the message.\nâœ” â†’ Forget that all slides must be complete. Be free to expand ideas into multiple slides by keeping the same title but switching the body\u003c/li\u003e\n\u003cli\u003eğŸš‘ \u003cstrong\u003eInjured Outlines\u003c/strong\u003e\nTools often push you to make outlines of everything, including lists of one element.\nâœ” â†’ Transform broken outlines into Heading and Subheading slides and think in advance (Forethought) to avoid getting influenced\u003c/li\u003e\n\u003cli\u003eğŸ¯ \u003cstrong\u003eBullet-Riddled Corpse\u003c/strong\u003e\nIt\u0026rsquo;s the most frequently mentioned antipattern because its omnipresence in corporate environments. Itâ€™s a slide that uses too many bullet points, which is the default for many tools (e.g. PowerPoint scaling down font to make more space for the next bullet).\nIt will bore the audience to death as \u003cstrong\u003ethey will read each single point instead of listening to you\u003c/strong\u003e\u0026hellip; Which is great for Infodecks which are pseudo documents, but terrible in presentations.\nâœ” â†’ Use it in the adeguate context. Think in advance before filling the slide with bullets. If you really have to, reveal each point with a transition while talking (Charred Trail).\u003c/li\u003e\n\u003cli\u003eğŸœ \u003cstrong\u003eAnt Fonts\u003c/strong\u003e\nAntipattern caused by putting as much content as possible inside a slide, reducing the font size (and readability). The audience focus is now on reading this wall of text, losing whatâ€™s important and ruining their vision.\nâœ” â†’ Disable automatic font shrinking on PowerPoint and plan your content in advance. Recommended font and size for code snippets: 18pt and \u003ca href=\"https://fonts.google.com/specimen/Inconsolata\"\u003eInconsolata\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eğŸ¸ \u003cstrong\u003eFontaholic\u003c/strong\u003e\nThis antipattern happens when you add too many fonts to â€œjazz upâ€ the presentation, resulting in hangover-like headaches.\nâœ” â†’ Stick with the classic fonts: Helvetica Neue, Arial, Verdana\u003c/li\u003e\n\u003cli\u003eâ˜” \u003cstrong\u003eFloodmarks\u003c/strong\u003e\nAt sponsored events or in the corporate world, you may be asked to insert logos and watermarks in each slide, cluttering the interface and unnecessarily bringing the same images over and over.\nâœ” â†’ If possible (this may depend on the rules given), slap all the logos and visuals in the first (or in the last) slide and keep using the minimal theme in the others.\u003c/li\u003e\n\u003cli\u003eğŸ“¸ \u003cstrong\u003ePhotomaniac\u003c/strong\u003e\nUsing outdated clip arts, low-res, unnecessary or irrelevant photos or too much material will cause a negative effect instead of helping you better explaining your message.\nâœ” â†’ Take some time to research your photos (and credit the authors!), use them sparingly (e.g. in Brain Breaks or for Intermezzi). Avoid the handshake image clichÃ© at the end of the presentation, please.\u003c/li\u003e\n\u003cli\u003eğŸ‘Ÿ \u003cstrong\u003eBorrowed Shoes\u003c/strong\u003e\nDonâ€™t present another personâ€™s slides! It is surprisingly difficult to integrate your style with someone elseâ€™s one.\nâœ” â†’ Rework the initial material into something suitable for you\u003c/li\u003e\n\u003cli\u003eâ˜  \u003cstrong\u003eSlideuments\u003c/strong\u003e\nAnother beloved antipattern from the authors, and a classic in the business world: a presentation that has to be also a document. Thereâ€™s no free lunch: \u003cstrong\u003eyou canâ€™t have both of them\u003c/strong\u003e!\nâœ” â†’ There is no real solution. Check Infodecks for an example of a working system. A workaround could be to create the presentation as usual, keeping it minimal, and then attach a more prosaic document (presentation notes) as .pdf so the audience can read it when looking for documentation.\u003c/li\u003e\n\u003cli\u003eğŸ’€ \u003cstrong\u003eDead Demo\u003c/strong\u003e\nIt typically happens with Live Demos when the presenter is not prepared and fiddles around with the tool for lack of material or for personal ego. Boring.\nâœ” â†’ As said, it is very difficult to nail a Live Demo. Practice a lot (typing in public is way more stressful) and keep it short if you really have to show the tool.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"deliver-1\"\u003eDeliver\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eğŸ”ª \u003cstrong\u003eShortchanged\u003c/strong\u003e\nSomeone else is still talking when itâ€™s your time for presenting, making you lose precious time.\nâœ” â†’ It happens. Donâ€™t feel rushed, donâ€™t let anyone feel that this could be an issue. Be ready to skip some slides or sections. Donâ€™t be afraid to assert yourself and ask the other person to stop the talk by hinting and setting your things up (or even interrupting).\u003c/li\u003e\n\u003cli\u003eğŸ¥› \u003cstrong\u003eHiccup Words\u003c/strong\u003e\nWhen you pollute your talk with nonwords such as â€˜uhmâ€™, â€˜ohâ€™, â€˜ehâ€™ or overused words such as â€˜definitelyâ€™, â€˜franklyâ€™, â€˜actuallyâ€™. Happens during stressful moments, the brain is more comfortable with these words rather than awkward pauses. Very difficult to identify.\nâœ” â†’ Recognize your hiccup words by asking a friend to count them or recording yourself. Try to spot when the antipattern happens and take a breath, or rephrase it into something more articulate like â€˜Iâ€™ll get to that detail laterâ€™. Donâ€™t be afraid to be silent for a second.\u003c/li\u003e\n\u003cli\u003eğŸ”‡ \u003cstrong\u003eDisowning Your Topic\u003c/strong\u003e\nDonâ€™t change your presentation on the fly because you think your audience is not interested.\nâœ” â†’ Be prepared and Know Your Audience and this antipattern wonâ€™t occur. Remember that social hints may be misleading, and that you canâ€™t please everyone. Just stick to what you have planned to minimize risk.\u003c/li\u003e\n\u003cli\u003eğŸ– \u003cstrong\u003eLipstick on a Pig\u003c/strong\u003e\nWhen you try to fix a bad presentation by to making it more aesthetically appealing. The slides are initially good, but your talk doesnâ€™t leave any result in the long run.\nâœ” â†’ The authors recommend to set up a solid base before adding lipstick, suggesting â€œ\u003cem\u003eone hour of preparation for every minute of presentation\u003c/em\u003eâ€ (a bit too much in my case ğŸ˜„). Time is the key, and all the previous pattern about having a clear and meaningful structure in mind.\u003c/li\u003e\n\u003cli\u003eğŸ—¼ \u003cstrong\u003eTower of Babble\u003c/strong\u003e\nUse technical jargon can be effective with the right audience, but can backfire, especially if you are doing it for flaunting your intellect. Difficult to notice if you talk â€œITâ€ every day.\nâœ” â†’ Know your audience and understand when and how much you can be more technical. For a business audience, stick to a simpler and more practical wording.\u003c/li\u003e\n\u003cli\u003eâ˜¢ \u003cstrong\u003eBunker\u003c/strong\u003e\nMetaphorically â€hidingâ€ behind the podium or showing distance from the audience, which is a natural behavior if oneâ€™s stressed.\nâœ” â†’ Know your audience and practice with your talk to achieve confidence, pay attention to your body language.\u003c/li\u003e\n\u003cli\u003eğŸ“£ \u003cstrong\u003eHecklers\u003c/strong\u003e\nThat kind of guest who monopolize your talk by continuously asking (often tricky) questions, making you lose time and patience. The agenda is at risk with heckers!\nâœ” â†’ Donâ€™t be afraid to be the bad guy! Your scope is to protect your audience from time sinks. Donâ€™t fell for the traps, but tell the heckler to follow up after the talk and remind him that you have a lot more to talk about. Deal decisively (eye contact, short sentences, firm tone).\u003c/li\u003e\n\u003cli\u003eğŸ \u003cstrong\u003eGo Meta\u003c/strong\u003e\nDonâ€™t talk about the talk, boooooring (e.g. technical issues you had before starting or anecdotes about the preparation).\nâœ” â†’ You already have limited time: focus on your Narrative Arc!\u003c/li\u003e\n\u003cli\u003eğŸ”™ \u003cstrong\u003eBackchannel\u003c/strong\u003e\nItâ€™s basically people tweeting or chatting with other people about the talk while you are speaking, which can bring distress and present a challenge. Itâ€™s not an antipattern, just a more complicate scenario because you may have to handle criticism in real time.\nâœ” â†’ Think about that when preparing the slides: can your message be condensed in a tweet? Whatâ€™s the central point? Donâ€™t be afraid to reply to questions and criticism during the event.\u003c/li\u003e\n\u003cli\u003eâš” \u003cstrong\u003eLaser Weapons\u003c/strong\u003e\nLaser pointers can be effective for highlighting sections in dense slides, but they may be difficult to see for users in the back and are temporary: when you turn off the laser, the attention is gone.\nâœ” â†’ Better to use the Traveling Highlights and highlight directly in the slide\u003c/li\u003e\n\u003cli\u003eğŸ™‹â€â™‚ï¸ \u003cstrong\u003eNegative Ignorance\u003c/strong\u003e\nIf you ask things like â€œWhoâ€™s not familiar with the XXX concept?â€ to better understand the level of the audience, itâ€™s very likely that nobody will tell you the truth as they donâ€™t want to feel stupid. Having incorrect feedbacks may bomb the presentation as you could act as too technical.\nâœ” â†’ Donâ€™t ask these questions but be prepared (and, of course, Know Your Audience to avoid doubts). Keep in mind that part of the audience will know too much, part has no idea about the topic and the majority is in the middle. Prepare a 30-60 seconds summary of the advanced concept you want to introduce to keep as many people as possible engaged and informed.\u003c/li\u003e\n\u003cli\u003eğŸ‘¾ \u003cstrong\u003eDual-Headed Monster\u003c/strong\u003e\nThis point is about the technical issues that can happen in case of an hybrid/online talk, which is not a real antipattern, just a slightly more difficult scenario. Outdated, as every presentation I make is online.\nâœ” â†’ Check the equipment, including the connection speed, and avoid Going Meta when an things break.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"-others-presentations-slides\"\u003eâ“ Others (presentations, slides)\u003c/h2\u003e\n\u003ch3 id=\"prepare-2\"\u003ePrepare\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eğŸ˜© \u003cstrong\u003eRequired \u0026amp; Proposed (also Invited) Presentations\u003c/strong\u003e\nRequired â†’ You have to speak (usually a difficult situation, yet it can become a low-risk opportunity to impress management and audience)\nProposed â†’ You send an application for speaking at a conference, usually you are interested in the topic.\nInvited â†’ You are so famous that conferences are asking you to speak there\u003c/li\u003e\n\u003cli\u003eğŸ”¨ \u003cstrong\u003eExpansion Joints\u003c/strong\u003e\nIt is a clever trick to keep some slides that can be either skippable or a source for digression in case of time issues. Difficult to implement, they are a safety net if you have a fixed time slot to fulfill.\u003c/li\u003e\n\u003cli\u003eğŸ£ \u003cstrong\u003eTalklet\u003c/strong\u003e\nA talklet is a presentation inside another presentation, to be used for a little digression with its own Narrative Arc. Psychological research shows that the average adult attention span is about 20 minutes. It is a good idea to split each Arc into that time frame, while the main Arc acts as a container for the entire talk.\u003c/li\u003e\n\u003cli\u003eğŸ‘ \u003cstrong\u003eUnifying Visual Theme\u003c/strong\u003e\nA visual theme provides benefits as it is easier to connect visual elements to the topics you are presenting. Be creative, donâ€™t use the default clip art and images, but at the same time donâ€™t bend your presentation to match a theme. Itâ€™s nice to use metaphors and include them as images in the presentations. E.g. a plan sprouting from soil is a theme picked by Neal Ford in its emerging tech talk.\u003c/li\u003e\n\u003cli\u003eâ›ˆ \u003cstrong\u003eLightning Talk\u003c/strong\u003e\nIt is a kind of presentation with fixed time limit, short in duration. It is difficult to create a meaningful story with limited material as it requires extensive preparation and there is no time for mistakes\u0026hellip; However it is a great occasion for being creative. You can cheat by using multiple slides with the same image and no transitions, which counts as 1 slide. \u003ca href=\"https://ignite.microsoft.com/en-US/home\"\u003eIgnite conferences\u003c/a\u003e are an example of Lightning Talks.\u003c/li\u003e\n\u003cli\u003eğŸ”« \u003cstrong\u003eTakahashi\u003c/strong\u003e\nAlso known as Lessig, it is a style of presentation with minimal imagery/verbiage and super fast transitions. Unlikely to be used with technical talks unless you want to insert a break in between, but very effective when delivering keynotes. You only need a lot of slides with one element each! Check \u003ca href=\"https://www.youtube.com/watch?v=8Ab3ArE8W3s\"\u003ethis example\u003c/a\u003e by Jack Rusher at Strange Loop 2022.\u003c/li\u003e\n\u003cli\u003eğŸ–Œ \u003cstrong\u003eCave Painting\u003c/strong\u003e\nAn innovative layout that uses a huge sectioned canvas where you can zoom in and out with each slide instead of the classic transition. It works well with fractal subjects and stories and the outcomes can be really beautiful however it doesnâ€™t scale and it requires more preparation, I am not seeing it around. Check out \u003ca href=\"https://prezi.com/product/?click_source=logged_element\u0026amp;page_location=header_product_dropdown\u0026amp;element_text=prezi_present\"\u003ePrezi\u003c/a\u003e Design which is a (paid) tool to make these special layouts.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"build-2\"\u003eBuild\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eğŸ¹ \u003cstrong\u003eCoda\u003c/strong\u003e\nProvide a list of further readings at the end of the presentation to provide more resource without distracting readers from the core of your material. Itâ€™s like a bibliography.\u003c/li\u003e\n\u003cli\u003eâ„¹ \u003cstrong\u003eInfodeck\u003c/strong\u003e\nA standalone document created with a presentation tool. It is not meant to be presented, but rather consumed by a single person. Here you can include diagrams, (SHORT) bullet points, few words and work with a spatial layout. Pay attention to not transform it into a Slideument and create it knowing that you wonâ€™t likely have to present it â†’ no animations, no big images, no Brain Breaks.\u003c/li\u003e\n\u003cli\u003eğŸš¢ \u003cstrong\u003eVacation Photos\u003c/strong\u003e\nSlides with only full-screen images and very few (if no) words: extremely effective with storytelling, less in technical presentations, but keep it in mind as it is a key concept of the book. Users need to have an image in their minds, otherwise they will spend time and attention creating their own. Donâ€™t distract them with too flashy images.\u003c/li\u003e\n\u003cli\u003eğŸ§¯ \u003cstrong\u003eCharred Trail\u003c/strong\u003e\nA kind of slide specifically made to fix the issues with Slideuments and Bullet-Riddled Corpses. Itâ€™s an animated bullet point list where each point is appears one at a time and then grays out to keep the audience focused on the last element. The â€œprintedâ€ outcome will be like a classic bulleted slide, which is OK for documents, but while presenting you can make sure that the users wonâ€™t read all the bullets instead of listening. It requires a bit of tweaking with PowerPoint.\u003c/li\u003e\n\u003cli\u003eğŸ© \u003cstrong\u003eExuberant Title Top\u003c/strong\u003e\nA slide type strictly related to the Charred Trail pattern (also in this case the printout will be Infodeck-friendly). The heading begins in the center of the slide and the hovers at the top while the body appear. Used to center the attention on the title, especially when itâ€™s a bold assertion.\u003c/li\u003e\n\u003cli\u003eğŸ“‘ \u003cstrong\u003eContext Keeper\u003c/strong\u003e\nSimilar to Breadcrumbs but at a slide level: you can keep the same element (e.g. an image or a title) between slides while the rest changes to reveal the structure of the topic you are introducing. Suggestion: use the Morph animation in PowerPoint.\u003c/li\u003e\n\u003cli\u003eğŸ \u003cstrong\u003eBreadcrumbs\u003c/strong\u003e\nIt is easy to lose track of the agenda if the presentation is long. A breadcrumb is a slide that can be added while transitioning between the points of the agenda to remind the audience whatâ€™s the general plan and at what point of the presentation we are. It can be a copy of the agenda slide with the current bullet highlighted in bold.\u003c/li\u003e\n\u003cli\u003eğŸ“š \u003cstrong\u003eBookends (and Preroll and Crawling Credits)\u003c/strong\u003e\nSlides at the beginning and at the end of the presentation with your name and contacts. Useless in my current case, but it can reassure the audience that they are in the correct room, introduce yourself and, when concluding, they can contain other URLs, for example for downloading the slides or asking for feedbacks.\nPreroll is an automatic carousel of slides to play before the beginning two or three slides with information so you can save time and attention resources.\nCrawling Credits is the opposite: an animation in Star-Wars style of the Coda at the end. Cool yet nothing special to me.\u003c/li\u003e\n\u003cli\u003eğŸ¬ \u003cstrong\u003eIntermezzi\u003c/strong\u003e\nAlternative to Breadcrumbs. While changing each logical part of the presentation, add a slide to introduce the new concept. We have it in our template, OK.\u003c/li\u003e\n\u003cli\u003eğŸ”™ \u003cstrong\u003eBacktracking\u003c/strong\u003e\nA slide to bring the attention back to another slide you have shown in the past. This element is used in case of a little digression where you open a Talklet and want to come back to the original agenda. Suggestion: use a distinctive â€œbackâ€ transition to close the digression.\u003c/li\u003e\n\u003cli\u003eğŸ¦ \u003cstrong\u003eLive Demo\u003c/strong\u003e\nA special kind of presentation where you donâ€™t need many slides, but you mostly use and present a tool. It can be the right way if you are talking about the tool and the audience is expected to mimic you and learn.\nIt is particuarly difficult to make a good Live Demo! Practice a lot, practice how to talk while using the tool to keep the audience interested, and expect to make mistakes.\u003c/li\u003e\n\u003cli\u003eâœˆ \u003cstrong\u003eTraveling Highlights (and Crawling Code)\u003c/strong\u003e\nFor slides with source code or huge amount of information, highlight the section you are talking about with a subtle window animation.\nCrawling Code adds boxed or highlights to the part of code mentioned, hiding all the rest to avoid distractions (e.g. \u003ca href=\"https://www.slideshare.net/matthewmccullough/encryption-boot-camp-on-the-jvm\"\u003eSlide 24 of Encryption Boot Camp on the JVM\u003c/a\u003e)\u003c/li\u003e\n\u003cli\u003eğŸ”” \u003cstrong\u003eEmergence\u003c/strong\u003e\nIf you want to reveal the key slide of your presentation, which requires a buildup first, slowly build hype with subtle animations to initially obscure part of the slide and then suddenly reveal the content, piece by piece.\u003c/li\u003e\n\u003c/ul\u003e\n","description":"","image":"/images/presentation_patterns_cover.jpg","permalink":"https://mutt0-ds.github.io/posts/2023/01/personal-notes-about-presentation-patterns/","title":"Personal Notes about Presentation Patterns"},{"content":"\u003cp\u003eThere is something bizarre with me if two of my favourite activities are writing documentation and hitting my head against tests, which are notoriously unexciting activities for many developers ğŸ˜«\u003c/p\u003e\n\u003cp\u003eLuckily, we are all unique in our own way and I decided to contribute to \u003ca href=\"https://codecov.io/github/ramnes/notion-sdk-py\"\u003ethe testing module\u003c/a\u003e of one of my favorite libraries, \u003ca href=\"https://github.com/ramnes/notion-sdk-py\"\u003enotion-sdk-py\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eBeing \u003ca href=\"https://www.credly.com/badges/f15407b3-5fa8-4d9b-99cf-d862399a1543/public_url\"\u003ea certified Notion user\u003c/a\u003e, I use its Web App on a daily basis, and the Python library helps me automatically organize my notes. I even used it for custom bots and documentation. If you donâ€™t know \u003ca href=\"https://www.notion.so/\"\u003ethe tool\u003c/a\u003e yet, I recommend trying it out: it may be a bit more complex compared to a classic note editor like Google Keep or Evernote, but its potential is huge.\u003c/p\u003e\n\u003cp\u003eFor better understanding this article, just keep in mind that Notion is like a wiki: each page is an element, which contains several blocks that could be paragraphs, tables (called databases), subpages or links to other pages. Each Notion element has a unique ID.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://cdn.gosquared.com/blog/wp-content/uploads/2020/04/Screenshot-2022-07-20-at-15.38.59.png\" alt=\"Notion Page\"\u003e\u003c/p\u003e\n\u003ch2 id=\"-brief-introduction-to-testing-and-coverage\"\u003eğŸ” Brief introduction to testing and coverage\u003c/h2\u003e\n\u003cp\u003eTests are important for making sure that the code does whatâ€™s expected to do, by creating functions that simulate common (and uncommon) cases to make sure that the behaviour is always coherent with our expectations. For example, in \u003ca href=\"https://github.com/ramnes/notion-sdk-py/tree/main/tests\"\u003enotion-sdk-py the tests\u003c/a\u003e have to create a new page, update its metadata, delete it, compare that all the requests are working. Iâ€™m using \u003ca href=\"https://docs.pytest.org/en/6.2.x/contents.html\"\u003epytest\u003c/a\u003e in this article, which is one of the most used testing libraries in Python.\u003c/p\u003e\n\u003cp\u003eWriting tests is not enough: coverage (ideally) plays an important part. The idea is to count the percentage of lines of code that are executed during test runs. The higher percentage of code is covered, the more likely the program does what itâ€™s supposedÂ to.\u003c/p\u003e\n\u003cp\u003eAt least, in theory: \u003ca href=\"https://www.google.com/search?q=a+100%25+coverage+doesn%27t+mean+anything\"\u003ea 100% coverage doesnâ€™t mean anything if the tests arenâ€™t good\u003c/a\u003e, as itâ€™s surprisingly easy to write meaningless tests that increase the numbers but arenâ€™t really improving anything. For this reason, it is a common point of view that coverage is basically useless if done with an incorrect approach.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eAchieving a 100% coverage should not be considered the one and only objective, yet improving it is a noble and useful challenge: as you will see, there is a lot to learnâ€¦\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eExample: I have a simple function that checks if a number is positive (True) or zero/negative (False), printing out a statement.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003enumber_sign_detector\u003c/span\u003e(num: int) \u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003e bool:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e num \u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    print(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;The number is positive\u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eelif\u003c/span\u003e num \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    print(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;The number is zero\u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eFalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    print(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;The number is negative\u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eFalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eI write down a simple test with pytest:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e main \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e number_sign_detector\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etest_number_sign_detector\u003c/span\u003e():\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eassert\u003c/span\u003e number_sign_detector(\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eassert\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003enot\u003c/span\u003e number_sign_detector(\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cimg src=\"https://github.com/mutt0-ds/mutt0-ds.github.io/blob/master/images/notion_coverage/pytest_example.png?raw=true\" alt=\"test_passes\"\u003e\u003c/p\u003e\n\u003cp\u003e100% of the tests (1/1 ğŸ¤—) passed, in theory my function is solidâ€¦ Isnâ€™t it?\u003c/p\u003e\n\u003cp\u003eWell, it could be better. The coverage is 78% because I didnâ€™t consider all the cases that can happen: in this case, if \u003ccode\u003enum==0\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eLuckily, pytest has an option for saving an interactive coverage report with the command \u003ccode\u003epytest --cov=./path/src/folder --cov-report=term-missing --cov-report=html\u003c/code\u003e where I can quickly see which lines are covered by the tests.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://github.com/mutt0-ds/mutt0-ds.github.io/blob/master/images/notion_coverage/coverage.png?raw=true\" alt=\"coverage_report\"\u003e\u003c/p\u003e\n\u003ch2 id=\"-how-can-i-test-notion-api-sdk\"\u003eâ“ How can I test Notion API SDK?\u003c/h2\u003e\n\u003cp\u003eI must admit that in my case, creating tests wasnâ€™t trivial: the majority of the \u003ca href=\"https://github.com/ramnes/notion-sdk-py/blob/main/notion_client/api_endpoints.py\"\u003efunctions in notion-sdk-py\u003c/a\u003e is interacting with Notion serversâ€¦ Which require an API key and a Notion account with a page where run tests, since almost every element in Notion requires an ID to be queried:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# code for retrieving a page\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e notion_client \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e Client\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eclient \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e Client(auth\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eNOTION_API_TOKEN)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eresponse \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e client\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003epages\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eretrieve(page_id\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eUNIQUE_PAGE_ID)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprint(response)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# JSON data...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThese API calls were initially a big issue for creating reliable tests, as the response depends on the server\nside. A big rule with tests is that they need to be as isolated as possible, minimizing any possible interference from external factors.\u003c/p\u003e\n\u003cp\u003eThere may be a connection issue, for example, or permission issues. Also, if another user wants to execute the test on its pc, they needs to create a testing environment on its own Notion account with a new API key, add the necessary permissions and make sure that the environment is the same for each independent runâ€¦Painful, yet still feasible for a library maintainer.\u003c/p\u003e\n\u003cp\u003eHowever \u003ca href=\"https://github.com/ramnes/notion-sdk-py/actions\"\u003enotion-sdk-py uses Github Actions in its CI/CD pipeline\u003c/a\u003e for running tests on external VMs, complicating things.\u003c/p\u003e\n\u003cp\u003eAlso, many Notion objects are dependent from each other: if I want to test a comment, I must create a block first (that the comment is referring to) and a parent page containing the block. This results is a big sequenceof API calls for creating, updating and deleting objects. How can I simulate them?\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://thomasjfrank.com/wp-content/uploads/2021/05/Notion-Complete-Block-Reference.gif\" alt=\"navigation\"\u003e\u003c/p\u003e\n\u003ch2 id=\"-the-solution-fixtures\"\u003eğŸ’¡ The solution: fixtures\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://docs.pytest.org/en/6.2.x/fixture.html\"\u003eFixtures\u003c/a\u003e are a basic component of testing libraries: like the name says, they are â€œfixedâ€ elements that are can be used by all the tests that are needing it for generating an initial state.\u003c/p\u003e\n\u003cp\u003eTo use a fixture, we can just add its name as an input parameter of the test function. This is an example of â€œdependency injectionâ€, a design that aims to isolate the testing phase, which has only the task of checking that something works as expected, and its initiation phase:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e pytest\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e notion_client \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e Client\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e@pytest.fixture\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eclient\u003c/span\u003e():\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e Client(auth\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eTOKEN)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etest_a\u003c/span\u003e(client):\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# client gets created\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eassert\u003c/span\u003e client \u003cspan style=\"color:#f92672\"\u003eis\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003enot\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etest_b\u003c/span\u003e(client):\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# another client gets created\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eassert\u003c/span\u003e client\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003epages \u003cspan style=\"color:#f92672\"\u003eis\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003enot\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eBoth tests need a client (which manages all the requests to the Notion API so it is called for many cases): by using the same fixture, both functions have the same (but independent) environment without worrying about its initiation.\u003c/p\u003e\n\u003cp\u003eI previously said that for testing many functions, I need a parent page first, which has to be manually set up: it can be considered as the initial path. The easiest way to share its ID is with another fixture:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#.. client fixture \u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# os.environ[\u0026#39;NOTION_PARENT_PAGE\u0026#39;] = \u0026#34;f691a0f9-da72-43bd-94ef-365793610746\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e@pytest.fixture\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003epage_id\u003c/span\u003e():\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e os\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eenviron[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;NOTION_PARENT_PAGE\u0026#39;\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etest_pages_delete\u003c/span\u003e(client, page_id):\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    response \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e client\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eblocks\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edelete(block_id\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003epage_id)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eassert\u003c/span\u003e response\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etest_pages_retrieve\u003c/span\u003e(client, page_id):\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    response \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e client\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003epages\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eretrieve(page_id\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003epage_id)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eassert\u003c/span\u003e response[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;object\u0026#34;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;page\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eHowever, if you run the tests in this exact order they will fail. They are sharing the same static fixture, thus the \u003ccode\u003etest_pages_delete\u003c/code\u003e will delete the testing environment before \u003ccode\u003etest_pages_retrieve\u003c/code\u003e will be able of retrieving and updating its data! Sure, we can change their orders, but it is better to fix the issue: each test should not be influenced by the othersâ€¦\u003c/p\u003e\n\u003ch2 id=\"-the-upgraded-solution-function-scoped-fixtures\"\u003eğŸ’¡ğŸ’¡ The upgraded solution: function-scoped fixtures\u003c/h2\u003e\n\u003cp\u003eA \u003ca href=\"https://betterprogramming.pub/understand-5-scopes-of-pytest-fixtures-1b607b5c19ed?gi=fe628b6947b5\"\u003efixture can have the following scopes\u003c/a\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eâ€œsessionâ€ (one object for all tests)\u003c/li\u003e\n\u003cli\u003eâ€œpackageâ€ (one object for each package)\u003c/li\u003e\n\u003cli\u003eâ€œmoduleâ€: one object for each module (e.g. test_client.py and test_endpoints.py will have one copy each of the fixture)\u003c/li\u003e\n\u003cli\u003eâ€œclassâ€ (one object for each class)\u003c/li\u003e\n\u003cli\u003eâ€œfunctionâ€ (one object for each test, default option)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIn this case I used â€œsessionâ€ and â€œfunctionâ€ scopes. The Notion client can be used once for session, for example, to improve efficiency.\nThe page_id of each test, however, must be generated each time starting from the initial \u003ccode\u003eNOTION_PARENT_PAGE\u003c/code\u003e for granting independency and atomicity: thatâ€™s when the â€œfunctionâ€ scope gets useful. It is the default option for fixtures, but I want to make clear that the functions Iâ€™m going to use are being called each time.\u003c/p\u003e\n\u003cp\u003eFor avoiding conflicting tests r, I decided to create unique subpages from the initial parent page. The fixture returns a dynamic Notion ID, which basically a shortcut for generating a new environment page each time a test begins:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# long way\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etest_pages_retrieve\u003c/span\u003e(client):\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    payload \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e {parent:{\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;page_id\u0026#34;\u003c/span\u003e: os\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eenviron[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;NOTION_PARENT_PAGE\u0026#39;\u003c/span\u003e]},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e              properties:{\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;title\u0026#34;\u003c/span\u003e: [{\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;text\u0026#34;\u003c/span\u003e: {\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;content\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Test Page\u0026#34;\u003c/span\u003e}}}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    parent_page_id \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e client\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003epages\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecreate(\u003cspan style=\"color:#f92672\"\u003e**\u003c/span\u003epayload)[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e] \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eassert\u003c/span\u003e response[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;object\u0026#34;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;page\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    client\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eblocks\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edelete(block_id\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eparent_page_id)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# short way\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e@pytest.fixture\u003c/span\u003e(scope\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;function\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eparent_page_id\u003c/span\u003e():\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e os\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eenviron[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;NOTION_PARENT_PAGE\u0026#39;\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e@pytest.fixture\u003c/span\u003e(scope\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;function\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003epage_id\u003c/span\u003e(client, parent_page_id):\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  payload \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e {parent:{\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;page_id\u0026#34;\u003c/span\u003e: parent_page_id},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            properties:{\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;title\u0026#34;\u003c/span\u003e: [{\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;text\u0026#34;\u003c/span\u003e: {\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;content\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Test Page\u0026#34;\u003c/span\u003e}}}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  response \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e client\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003epages\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecreate(\u003cspan style=\"color:#f92672\"\u003e**\u003c/span\u003epayload)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eyield\u003c/span\u003e response[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e] \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  client\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eblocks\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edelete(block_id\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eresponse[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e])\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etest_pages_retrieve\u003c/span\u003e(client, page_id):\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# the page_id is generated by the function-scoped fixture\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  response \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e client\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003epages\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eretrieve(page_id\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eparent_page_id)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eassert\u003c/span\u003e response[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;object\u0026#34;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;page\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# the parent page is then deleted\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eBy using \u003ccode\u003eyield\u003c/code\u003e, I can give the ID of the parent page to the test that is asking for it (which only cares about its specific task), and then deleting it with \u003ccode\u003eclient.blocks.delete\u003c/code\u003e before the end. This is a \u003ca href=\"https://wiki.python.org/moin/Generators\"\u003egenerator\u003c/a\u003e, a function that returns a lazy iterator which doesnâ€™t store its content in memory.\u003c/p\u003e\n\u003cp\u003eWith this method, there will be a final step for cleaning up everything and resetting the environment even in case of a failure. Before that, I was finding 20+ new subpages in my personal Notion page and cleaning them up wasnâ€™t very funny ğŸ˜…\u003c/p\u003e\n\u003cp\u003eThe final solution used the library is a bit more complex, because from a general parent page (session-scoped), depending on each case the module creates a function-scoped subpage containing another function-scoped block, comment or database. In fact, fixtures can call other fixtures and so on. You better check out \u003ca href=\"https://github.com/ramnes/notion-sdk-py/blob/main/tests/conftest.py\"\u003ethe code\u003c/a\u003e if you are curious.\u003c/p\u003e\n\u003cp\u003eThere is one problem left: we still canâ€™t control the responses of the APIâ€¦ If the connection times out, or a user is not authenticated, the tests will fail.\u003c/p\u003e\n\u003ch2 id=\"-the-almost-final-solution-cassettes\"\u003eğŸ’¡ğŸ“¼ The almost-final solution: cassettes\u003c/h2\u003e\n\u003cp\u003eThe concept of a \u003ca href=\"https://betterprogramming.pub/your-api-tests-must-be-reproducible-6e1c57986f4?gi=119ee926cb4e\"\u003ecassette\u003c/a\u003e is very cool: they are objects that capture an HTTP response and can be rewinded for an undefined number of times as the JSON data is stored locally. This makes tests that are working with external requests reproducible, as the response is always the same, independently from connection or permission issues. Also, they speed up the testing time, as they donâ€™t require a connection anymore.\u003c/p\u003e\n\u003cp\u003eThe plugin \u003ca href=\"https://pytest-vcr.readthedocs.io/en/latest/\"\u003epytest-vcr\u003c/a\u003e integrates cassettes for pytest as a decorator: the decorated test will send a request the first time, save it in a local .yaml file, and use it for all the successive runs.\u003c/p\u003e\n\u003cp\u003eSometimes Notion introduces \u003ca href=\"https://developers.notion.com/reference/changes-by-version\"\u003ebreaking changes in its API\u003c/a\u003e, but there is nothing to worry about: we can just update the \u003ca href=\"https://github.com/ramnes/notion-sdk-py/blob/5829ae16df7dae6429de22201939c2a443324026/notion_client/client.py#L52\"\u003eâ€œNotion-Versionâ€ header\u003c/a\u003e in the request, regenerate the cassettes, and see if there are new issues.\u003c/p\u003e\n\u003cp\u003eWith this methodology, we can stay pretty safe that the cassettes are reliably simulating real requests.\u003c/p\u003e\n\u003cp\u003eLetâ€™s pick up again the pages_retrieve test:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#.. client and parent page id fixtures\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e@pytest.mark.vcr\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etest_pages_retrieve\u003c/span\u003e(client, page_id):\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    response \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e client\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003epages\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eretrieve(page_id\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003epage_id)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eassert\u003c/span\u003e response[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;object\u0026#34;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;page\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ePytest will locally store the response data in YAML format the first time the test is run.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003einteractions\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e- \u003cspan style=\"color:#f92672\"\u003erequest\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# data about the create request for the parent page\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e- \u003cspan style=\"color:#f92672\"\u003erequest\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ebody\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eheaders\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eaccept\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;*/*\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eaccept-encoding\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003egzip, deflate\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eauthorization\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003esecret_...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003econnection\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ekeep-alive\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003ehost\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eapi.notion.com\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003enotion-version\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;2022-06-28\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003emethod\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eGET\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003euri\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ehttps://api.notion.com/v1/pages/09462f1b-f4a9-4d52-8f9f-3061df0fa937\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eresponse\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003econtent\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{\u0026#34;object\u0026#34;:\u0026#34;page\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;09462f1b-f4a9-4d52-8f9f-3061df0fa937\u0026#34;,\u0026#34;created_time\u0026#34;:\u0026#34;2022-11-16T15:44:00.000Z\u0026#34;,\u0026#34;last_edited_time\u0026#34;:\u0026#34;2022-11-16T15:44:00.000Z\u0026#34;,\u0026#34;created_by\u0026#34;:{\u0026#34;object\u0026#34;:\u0026#34;user\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;823cf07b-34df-4ae6-9fbc-dbc600a815c6\u0026#34;},\u0026#34;last_edited_by\u0026#34;:{\u0026#34;object\u0026#34;:\u0026#34;user\u0026#34;,\u0026#34;id\u0026#34;:\u0026#34;823cf07b-34df-4ae6-9fbc-dbc600a815c6\u0026#34;},\u0026#34;cover\u0026#34;:null,\u0026#34;icon\u0026#34;:null,\u0026#34;parent\u0026#34;:{\u0026#34;type\u0026#34;:\u0026#34;page_id\u0026#34;,\u0026#34;page_id\u0026#34;:\u0026#34;f691a0f9-da72-43bd-94ef-365793610746\u0026#34;},\u0026#34;archived\u0026#34;:false,\u0026#34;properties\u0026#34;:{\u0026#34;title\u0026#34;:{\u0026#34;id\u0026#34;:\u0026#34;title\u0026#34;,\u0026#34;type\u0026#34;:\u0026#34;title\u0026#34;,\u0026#34;title\u0026#34;:[{\u0026#34;type\u0026#34;:\u0026#34;text\u0026#34;,\u0026#34;text\u0026#34;:{\u0026#34;content\u0026#34;:\u0026#34;Test\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      2022-11-16 16:44:37.054647\u0026#34;,\u0026#34;link\u0026#34;:null},\u0026#34;annotations\u0026#34;:{\u0026#34;bold\u0026#34;:false,\u0026#34;italic\u0026#34;:false,\u0026#34;strikethrough\u0026#34;:false,\u0026#34;underline\u0026#34;:false,\u0026#34;code\u0026#34;:false,\u0026#34;color\u0026#34;:\u0026#34;default\u0026#34;},\u0026#34;plain_text\u0026#34;:\u0026#34;Test\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      2022-11-16 16:44:37.054647\u0026#34;,\u0026#34;href\u0026#34;:null}]}},\u0026#34;url\u0026#34;:\u0026#34;https://www.notion.so/Test-2022-11-16-16-44-37-054647-09462f1bf4a94d528f9f3061df0fa937\u0026#34;}\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eheaders\u003c/span\u003e: {}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ehttp_version\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eHTTP/1.1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003estatus_code\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e200\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e- \u003cspan style=\"color:#f92672\"\u003erequest\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# data about the delete request for the parent page\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eA few things to highlight:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe cassette contains all the data about the requests made by \u003ccode\u003etest_pages_retrieve\u003c/code\u003e, including the two â€œhiddenâ€ create and delete by the client fixture. I cut them out here for keeping the post short.\u003c/li\u003e\n\u003cli\u003eThe test will use the stored response for all the future runs, indpendently by the user, connection, time or zone\u003c/li\u003e\n\u003cli\u003eIf the code that makes the request changes pytest will throw an error and we will have to recreate a new cassette\u003c/li\u003e\n\u003cli\u003eThe API Token has to be hidden (like we did \u003ca href=\"https://github.com/ramnes/notion-sdk-py/blob/5829ae16df7dae6429de22201939c2a443324026/tests/conftest.py#L12-L22\"\u003ehere\u003c/a\u003e) or it will be stored in plain text in the cassette!\u003c/li\u003e\n\u003cli\u003eA cassette canâ€™t also be a fixture because the two decorators will interfere\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"-conclusions\"\u003eğŸ”¨ Conclusions\u003c/h2\u003e\n\u003cp\u003eWith cassettes and fixtures \u003ca href=\"https://github.com/ramnes/notion-sdk-py/pull/168\"\u003eI managed to achieve 100% test coverage\u003c/a\u003e on notion-sdk-py, which was absolutely unthinkable to me just a few weeks before! I learned so much by contributing on the library, and this posts represents a quick sumup of my takeaways. Hopefully it will help you if you will be in my same situation, where I was lost trying to understand how to test something that was so dependant on external sources.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://github.com/mutt0-ds/mutt0-ds.github.io/blob/master/images/notion_coverage/final_coverage.png?raw=true\" alt=\"100_coverage\"\u003e\u003c/p\u003e\n\u003cp\u003eA big thank to \u003ca href=\"https://github.com/ramnes\"\u003eramnes\u003c/a\u003e for the precious feedbacks, the proofereading and for his amazing library!\u003c/p\u003e\n","description":null,"image":"/images/notion_coverage/title.png","permalink":"https://mutt0-ds.github.io/posts/2022/12/road-100-coverage-notion/","title":"Road to 100% Test Coverage on notion-sdk-py"},{"content":"\u003cp\u003eOne of the most annoying issues I have when working with Power BI files is that source control is a real pain.\nConsidering that Microsoft owns Azure, Github, and Power BI, one would hope that they will come up with a solution for comparing two reports without using third-party tools or overly complicated solutions\u0026hellip; But that day seems still far in the future.\u003c/p\u003e\n\u003cp\u003eHere is a story about how I managed to set up a CI/CD pipeline through Azure DevOps Pipeline for providing rudimental version control of our Power BI reports.\u003c/p\u003e\n\u003ch2 id=\"-the-problem\"\u003eâ“ The problem\u003c/h2\u003e\n\u003cp\u003eWhile textual formats like markdown or .json can be compared using an editor, binary formats like .pbix are not supported, being binary files. This results in a confusing situation where we have to document what exactly has been changed after every update, losing the powerful features available with git. So, lots of time wasted, plus insecurity and confusion.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/power_bi_source_control/binary.png\" alt=\"binary\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://code.visualstudio.com/assets/docs/sourcecontrol/overview/overview.png\" alt=\"working-git\"\u003e\u003c/p\u003e\n\u003ch2 id=\"-acknowledgments\"\u003eğŸ™ Acknowledgments\u003c/h2\u003e\n\u003cp\u003eMany people have tried to tackle the problem, in particular, \u003ca href=\"https://www.kerski.tech/bringing-dataops-to-power-bi-part10/\"\u003eKerski\u003c/a\u003e and \u003ca href=\"https://blog.gbrueckl.at/\"\u003eGerhard Brueckl\u003c/a\u003e. I\u0026rsquo;m very thankful for their precious resources.\nAlso, I have to thank the creators of \u003ca href=\"https://tabulareditor.com/\"\u003eTabular Editor\u003c/a\u003e, an open-source tool that offers several functionalities, including extracting the metadata of a .pbix files into .json files, transforming the binary file into a textual format.\u003c/p\u003e\n\u003cp\u003eThe main source for this article is \u003ca href=\"https://blog.gbrueckl.at/2022/02/automating-the-extraction-of-bim-metadata-from-pbix-files-using-ci-cd-pipelines/\"\u003ethis amazing blog post from Gerhard Brueckl\u003c/a\u003e. The code I used mostly comes from his \u003ca href=\"https://github.com/gbrueckl/PowerBI.CICD\"\u003eGithub repository\u003c/a\u003e, with a few tweaks I personally added. I recommend reading its README for the more technical details and the environment variables needed for authentication. You may be interested in \u003ca href=\"https://github.com/gbrueckl/PowerBI.CICD/blob/main/.github/workflows/pbix_to_bim.yml\"\u003ehis Github Action version\u003c/a\u003e, which doesn\u0026rsquo;t require Azure.\u003c/p\u003e\n\u003ch2 id=\"-requisites\"\u003eğŸ“‘ Requisites\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003ea .pbix file with a dataset to track with git\u003c/li\u003e\n\u003cli\u003ea PowerBI Premium per User license (and a Premium workspace already created)\u003c/li\u003e\n\u003cli\u003ean Azure DevOps repository\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://learn.microsoft.com/en-us/azure/active-directory/develop/app-objects-and-service-principals\"\u003ea service principal\u003c/a\u003e (an Active Directory entity with permissions to edit the Power BI Premium workspace)\u003c/li\u003e\n\u003cli\u003eA \u003ca href=\"https://learn.microsoft.com/en-us/azure/devops/pipelines/library/variable-groups?view=azure-devops\u0026amp;tabs=yaml#create-a-variable-group\"\u003evariable group\u003c/a\u003e with auth variables to Power BI for the service principal (explained \u003ca href=\"https://github.com/gbrueckl/PowerBI.CICD#environment-variables\"\u003ehere\u003c/a\u003e)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"-the-idea\"\u003eğŸ’¡ The idea\u003c/h2\u003e\n\u003cp\u003eAs Gerhard says:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe core idea of the solution is to use CI/CD pipelines that automatically extracts the metadata of a .pbix file as soon as it is pushed to the Git repository. To do this, the .pbix file is automatically uploaded to a Power BI Premium workspace using the Power BI REST API and the free version of Tabular Editor 2 then extracts the BIM file via the XMLA endpoint and push it back to the repository.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg src=\"https://blog.gbrueckl.at/wp-content/uploads/2022/02/PBIX_to_BIM_YAML_workflow.png\" alt=\"pipeline\"\u003e\u003c/p\u003e\n\u003cp\u003eIn short, the pipeline retrieves the commit id of the latest two commits in the repository, detects which .pbix files have been modified, then uploads them in the Premium Workspace. This step is needed because the Premium workspace gives access to an XMLA endpoint used by Tabular Editor to access its data. Then, the pipeline extracts all the metadata in .JSON format and pushes it to the DevOps repository.\u003c/p\u003e\n\u003ch2 id=\"-the-code-step-by-step\"\u003eğŸ’¬ The code [Step by Step]\u003c/h2\u003e\n\u003cp\u003eBe free to skip this section if you are not interested in the details about the code, which is fully available \u003ca href=\"https://github.com/mutt0-ds/powerbi-source-control-pipeline/tree/main\"\u003ehere\u003c/a\u003e. I\u0026rsquo;m trying to keep things simple for newbies like me so I  documented every step.\u003c/p\u003e\n\u003cp\u003eFirst, a simple introduction to \u003ca href=\"https://www.reddit.com/r/csharp/comments/this0y/eli5_cicd_with_azure_devops/\"\u003eAzure Pipelines\u003c/a\u003e.\nAn Azure Pipeline is composed of a setup part and different steps. The code is executed in a VM (in my case, hosted by Microsoft) triggered after every commit, which doesn\u0026rsquo;t basically anything about the context. This is good because the code is always executed in a neutral environment, but also requires to install modules every time and complicates some (in theory) simple steps, especially when using git.\u003c/p\u003e\n\u003ch3 id=\"1-setup\"\u003e1. Setup\u003c/h3\u003e\n\u003cp\u003eHere I named the pipeline, which will be triggered only when a .pbix file is committed, on all branches.\nThe \u003ccode\u003ebatch\u003c/code\u003e parameter, as \u003ca href=\"https://stackoverflow.com/questions/67099766/azure-yaml-schema-batch-trigger\"\u003ebadly documented by Windows\u003c/a\u003e, has been set to \u003ccode\u003efalse\u003c/code\u003e: I want to trigger the pipeline for each commit, even if more of them have been pushed in a batch.\nThis is not a very efficient way, but I had some issues when retrieving the commit ids using the DevOps API (step 5) so I decided to keep it simple.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eExtract PBIX metadata\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003etrigger\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ebatch\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# one pipeline for every commit\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ebranches\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003einclude\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;*\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# on all branches\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003epaths\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003einclude\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;**/*.pbix\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# whenever a .pbix file is pushed\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epool\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003evmImage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ewindows-latest\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# windows VM with PowerShell\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"2-variables\"\u003e2. Variables\u003c/h3\u003e\n\u003cp\u003eThe variable group contains the access token that can be accessed like \u003ccode\u003e$env:PBI_USER_NAME\u003c/code\u003e.\nA little, innocent detail I had to remember is that if you flag a variable in your variable group as \u0026ldquo;Secret\u0026rdquo;, \u003ca href=\"https://stackoverflow.com/a/69891660\"\u003eyou have to explicitly declare it in the YAML code\u003c/a\u003e. Otherwise, there is no warning, the value will simply be null. Stupid, but tricky if you don\u0026rsquo;t know that, as I know firsthand\u0026hellip;\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003evariables\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e- \u003cspan style=\"color:#f92672\"\u003egroup\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eMy Variable Group\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# \u0026lt;-- change this to match your library/variable group\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"3-git-checkout\"\u003e3. Git Checkout\u003c/h3\u003e\n\u003cp\u003eThe pipeline is executing a \u003ccode\u003egit checkout\u003c/code\u003e behind the scenes by default to retrive all the files in the repository, but I had to declare it esplicitly. The trick here is to add \u003ccode\u003epersistCredentials: true\u003c/code\u003e to keep the git credentials for the next steps.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003esteps\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e- \u003cspan style=\"color:#f92672\"\u003echeckout\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eself\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eclean\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# resets the environment to a fresh new state\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003epersistCredentials\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# very important to keep the credentials\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003efetchDepth\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"4-download-tabular-editor-portable\"\u003e4. Download Tabular Editor Portable\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e- task\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e:\u003c/span\u003e PowerShell@2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  displayName\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e:\u003c/span\u003e Download-TabularEditor2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  inputs\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    targetType\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;inline\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    script\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e:\u003c/span\u003e |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# Download URL for Tabular Editor portable:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      $TabularEditorUrl = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;https://cdn.tabulareditor.com/files/te2/TabularEditor.Portable.zip\u0026#34;\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# Download destination (root of PowerShell script execution path):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      $DownloadDestination = Join-Path (Get-Location) \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;TabularEditor.zip\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# Download from GitHub:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      Invoke-WebRequest -Uri $TabularEditorUrl -OutFile $DownloadDestination\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# Unzip Tabular Editor portable, and then delete the zip file:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      Expand-Archive -Path $DownloadDestination -DestinationPath (Get-Location).Path\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      Remove-Item $DownloadDestination\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    pwsh\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e:\u003c/span\u003e true \u003cspan style=\"color:#75715e\"\u003e# necessary variable for passing the script values to Powershell\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"5-get-the-commit-ids\"\u003e5. Get the Commit IDs\u003c/h3\u003e\n\u003cp\u003eThis was the part that gave me a bit of a headache, as the original code didn\u0026rsquo;t seem to work in case of merges or, for some reason, was skipping some commits. It\u0026rsquo;s very annoying that Azure DevOps doesn\u0026rsquo;t provide a way to retrieve the git commit id preceding the running build, so I had to use this escamotage by calling the DevOps API and then using \u003ccode\u003egit log\u003c/code\u003e for retrieving the previous commit.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e- task\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e:\u003c/span\u003e PowerShell@2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  displayName\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e:\u003c/span\u003e Get the Commit IDs\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  inputs\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    targetType\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;inline\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    script\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e:\u003c/span\u003e |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# print Information stream\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $InformationPreference = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Continue\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $headers = @{ Authorization = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Bearer \u003c/span\u003e$env:SYSTEM_ACCESSTOKEN\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $uri = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$env:SYSTEM_TEAMFOUNDATIONSERVERURI$env:SYSTEM_TEAMPROJECT\u003cspan style=\"color:#e6db74\"\u003e/_apis/build/builds/\u003c/span\u003e$($env:BUILD_BUILDID)\u003cspan style=\"color:#e6db74\"\u003e/changes?api-version=5.1\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# API Call to DevOps API to retrieve changes\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    $changes = Invoke-RestMethod -Method Get -Headers $headers -Uri $uri\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e ($changes.count \u003cspan style=\"color:#f92672\"\u003e-gt\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# the first commit of the list is the one that triggered the pipeline\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $commit_id_after = $changes.value[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e].id\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# using git for retrieving the preceeding commit\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $commit_id_before = @($(git log --pretty=\u003cspan style=\"color:#66d9ef\"\u003e%\u003c/span\u003eP -n \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e $commit_id_after --max-count=\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e --max-parents=\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Write-Information \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Commit ID before push: \u003c/span\u003e$commit_id_before\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Write-Information \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Commit ID after push:  \u003c/span\u003e$commit_id_after\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# this sets the value as environment variable\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Write-Host \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;##vso[task.setvariable variable=GIT_EVENT_BEFORE]\u003c/span\u003e$commit_id_before\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Write-Host \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;##vso[task.setvariable variable=GIT_EVENT_AFTER]\u003c/span\u003e$commit_id_after\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Write-Warning \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;No changes found in Build \u003c/span\u003e$($env:BUILD_BUILDID)\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  pwsh\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e:\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/power_bi_source_control/git.png\" alt=\"git\"\u003e\u003c/p\u003e\n\u003ch3 id=\"6-extract-pbix-metadata\"\u003e6. Extract PBIX Metadata\u003c/h3\u003e\n\u003cp\u003eThe core of the Pipeline, which requires the MicrosoftPowerBIMgmt Powershell module, the credentials for logging in Power BI and then calling the Premium Workspace endpoint for extracting data using Tabular Editor.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e- task\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e:\u003c/span\u003e PowerShell@2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  displayName\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e:\u003c/span\u003e Extract-PBIXMetadata\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  inputs\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    targetType\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;inline\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    script\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e:\u003c/span\u003e |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# halt on first error\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      $ErrorActionPreference = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Stop\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# print Information stream\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      $InformationPreference = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Continue\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# install the Power BI Powershell module\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      Set-PSRepository PSGallery -InstallationPolicy Trusted\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      Install-Module -Name MicrosoftPowerBIMgmt -Scope CurrentUser\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      Import-Module -Name MicrosoftPowerBIMgmt\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# setup\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      $root_path = (Get-Location).Path\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      $tabular_editor_root_path = $root_path\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      $ind = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e`t\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      $git_event_before = $env:GIT_EVENT_BEFORE\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      $git_event_after = $env:GIT_EVENT_AFTER\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      $triggered_by = $env:BUILD_REASON\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      $workspace_id = $env:PBI_PREMIUM_WORKSPACE_ID\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      $tenant_id = $env:PBI_TENANT_ID\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      $client_id = $env:PBI_CLIENT_ID\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      $client_secret = $env:PBI_CLIENT_SECRET\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# login to Power BI\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      $login_info = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;User ID=app:\u003c/span\u003e$client_id\u003cspan style=\"color:#e6db74\"\u003e@\u003c/span\u003e$tenant_id\u003cspan style=\"color:#e6db74\"\u003e;Password=\u003c/span\u003e$client_secret\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      [\u003cspan style=\"color:#66d9ef\"\u003esecurestring\u003c/span\u003e]$sec_client_secret = ConvertTo-SecureString $client_secret -AsPlainText -Force\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      [\u003cspan style=\"color:#66d9ef\"\u003epscredential\u003c/span\u003e]$credential = New-Object System.Management.Automation.PSCredential ($client_id, $sec_client_secret)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      Connect-PowerBIServiceAccount -Credential $credential -ServicePrincipal -TenantId $tenant_id\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# accessing the workspace\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      $workspace = Get-PowerBIWorkspace -Id $workspace_id\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      Write-Information \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Power BI Workspace: \u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e`n\u003c/span\u003e$($workspace | ConvertTo-Json)\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e-not\u003c/span\u003e $workspace.IsOnDedicatedCapacity) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Write-Error \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;The provided Workspace ID (\u003c/span\u003e$($workspace.id)\u003cspan style=\"color:#e6db74\"\u003e) is not on Premium Capacity!\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# very important: finding the modified files with git diff\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# it has to be triggered by a push to the repo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      Write-Information \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Triggered By: \u003c/span\u003e$triggered_by\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      Write-Information \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Getting changed .pbix files ...\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e ($triggered_by \u003cspan style=\"color:#f92672\"\u003e-like\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*CI\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-or\u003c/span\u003e $triggered_by \u003cspan style=\"color:#f92672\"\u003e-eq\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;push\u0026#34;\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# get the changed .pbix files in the current push\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Write-Information \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;git diff --name-only \u003c/span\u003e$git_event_before\u003cspan style=\"color:#e6db74\"\u003e \u003c/span\u003e$git_event_after\u003cspan style=\"color:#e6db74\"\u003e --diff-filter=ACM \u0026#34;\u0026#34;*.pbix\u0026#34;\u0026#34;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $pbix_files = @($(git diff --name-only $git_event_before $git_event_after --diff-filter=ACM \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*.pbix\u0026#34;\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $pbix_files = $pbix_files | ForEach-Object { Join-Path $root_path $_ | Get-Item }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e ($pbix_files.Count \u003cspan style=\"color:#f92672\"\u003e-eq\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          Write-Warning \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Something went wrong! Could not find any changed .pbix files using the above \u0026#39;git diff\u0026#39; command!\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#75715e\"\u003e# get all .pbix files in the current repository\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#75715e\"\u003e# disable these lines if you don\u0026#39;t want this feature\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          Write-Information \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Getting all .pbix files in the repo to be sure to get all changes!\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          $pbix_files = Get-ChildItem -Path (Join-Path $root_path $manual_trigger_path_filter) -Recurse -Filter \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*.pbix\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-File\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Write-Error \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Invalid Trigger!\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      Write-Information \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Changed .pbix files (\u003c/span\u003e$($pbix_files.Count)\u003cspan style=\"color:#e6db74\"\u003e):\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      $pbix_files | ForEach-Object { Write-Information \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$ind$($_.FullName)\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# we need to set Serialization Options to allow export to Folder via TE2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      $serialization_options = \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e          \u0026#34;IgnoreInferredObjects\u0026#34;: true,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e          \u0026#34;IgnoreInferredProperties\u0026#34;: true,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e          \u0026#34;IgnoreTimestamps\u0026#34;: true,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e          \u0026#34;SplitMultilineStrings\u0026#34;: true,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e          \u0026#34;PrefixFilenames\u0026#34;: false,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e          \u0026#34;LocalTranslations\u0026#34;: false,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e          \u0026#34;LocalPerspectives\u0026#34;: false,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e          \u0026#34;LocalRelationships\u0026#34;: false,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e          \u0026#34;Levels\u0026#34;: [\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e              \u0026#34;Data Sources\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e              \u0026#34;Perspectives\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e              \u0026#34;Relationships\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e              \u0026#34;Roles\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e              \u0026#34;Tables\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e              \u0026#34;Tables/Columns\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e              \u0026#34;Tables/Measures\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e              \u0026#34;Translations\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e          ]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      }\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      $serialization_options | Out-File (Join-Path $tabular_editor_root_path \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;TabularEditor_SerializeOptions.json\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Model.SetAnnotation(\u0026#34;\u0026#34;TabularEditor_SerializeOptions\u0026#34;\u0026#34;, ReadFile(@\u0026#34;\u0026#34;\u003c/span\u003e$(Join-Path $tabular_editor_root_path \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;TabularEditor_SerializeOptions.json\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;));\u0026#34;\u003c/span\u003e `\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        | Out-File (Join-Path $tabular_editor_root_path \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ApplySerializeOptionsAnnotation.csx\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# for each .pbix modified extract metadata with Tabular Editor\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#66d9ef\"\u003eforeach\u003c/span\u003e ($pbix_file \u003cspan style=\"color:#66d9ef\"\u003ein\u003c/span\u003e $pbix_files) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $report = $null\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        $dataset = $null\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003etry\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          Write-Information \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Processing  \u003c/span\u003e$($pbix_file.FullName)\u003cspan style=\"color:#e6db74\"\u003e ... \u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          Write-Information \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$ind\u003cspan style=\"color:#e6db74\"\u003e Checking if PBIX file contains a datamodel ...\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          $zip_entries = [\u003cspan style=\"color:#66d9ef\"\u003eIO.Compression.ZipFile\u003c/span\u003e]::OpenRead($pbix_file.FullName).Entries.Name;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;DataModel\u0026#34;\u003c/span\u003e -notin $zip_entries) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            Write-Information \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$ind\u003cspan style=\"color:#e6db74\"\u003e No datamodel found in \u003c/span\u003e$($pbix_file.Name)\u003cspan style=\"color:#e6db74\"\u003e - skipping further processing of this file!\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003econtinue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            Write-Information \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$ind\u003cspan style=\"color:#e6db74\"\u003e Datamodel found!\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#75715e\"\u003e# upload the file with the dataset to the Premium workspace\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          $temp_name = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$($pbix_file.BaseName)\u003cspan style=\"color:#e6db74\"\u003e-\u003c/span\u003e$(Get-Date -Format \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;yyyyMMddTHHmmss\u0026#39;\u003c/span\u003e)\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          Write-Information \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$ind\u003cspan style=\"color:#e6db74\"\u003e Uploading \u003c/span\u003e$($pbix_file.FullName.Replace($root_path, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e))\u003cspan style=\"color:#e6db74\"\u003e to \u003c/span\u003e$($workspace.Name)\u003cspan style=\"color:#e6db74\"\u003e/\u003c/span\u003e$temp_name\u003cspan style=\"color:#e6db74\"\u003e ... \u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          $report = New-PowerBIReport -Path $pbix_file.FullName -Name $temp_name -WorkspaceId $workspace.Id\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          Start-Sleep -Seconds \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#75715e\"\u003e# retrieving the uploaded data\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          $dataset = Get-PowerBIDataset -WorkspaceId $workspace.Id | Where-Object { $_.Name \u003cspan style=\"color:#f92672\"\u003e-eq\u003c/span\u003e $temp_name }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          $connection_string = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;powerbi://api.powerbi.com/v1.0/myorg/\u003c/span\u003e$($workspace.Name)\u003cspan style=\"color:#e6db74\"\u003e;initial catalog=\u003c/span\u003e$($dataset.Name)\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          Write-Information \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$ind\u003cspan style=\"color:#e6db74\"\u003e Extracting metadata ...\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          $executable = Join-Path $tabular_editor_root_path TabularEditor.exe\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          $output_path = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$(Join-Path $pbix_file.DirectoryName $pbix_file.BaseName)\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          $params = @(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u0026#34;Provider=MSOLAP;Data Source=\u003c/span\u003e$connection_string\u003cspan style=\"color:#e6db74\"\u003e;\u003c/span\u003e$login_info\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u0026#34;\u003c/span\u003e$($dataset.Name)\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-SCRIPT \u0026#34;\u0026#34;\u003c/span\u003e$(Join-Path $tabular_editor_root_path \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ApplySerializeOptionsAnnotation.csx\u0026#39;\u003c/span\u003e)\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-FOLDER \u0026#34;\u0026#34;\u003c/span\u003e$output_path\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34; \u0026#34;\u0026#34;\u003c/span\u003e$($pbix_file.BaseName)\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          )\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          Write-Debug \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$ind\u003cspan style=\"color:#e6db74\"\u003e \u003c/span\u003e$executable\u003cspan style=\"color:#e6db74\"\u003e \u003c/span\u003e$params\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          $p = Start-Process -FilePath $executable -Wait -NoNewWindow -PassThru -RedirectStandardOutput \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$temp_name\u003cspan style=\"color:#e6db74\"\u003e.log\u0026#34;\u003c/span\u003e -ArgumentList $params\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e ($p.ExitCode \u003cspan style=\"color:#f92672\"\u003e-ne\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            Write-Error \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$ind\u003cspan style=\"color:#e6db74\"\u003e Failed to extract PBIX metadata from \u003c/span\u003e$($dataset.WebUrl)\u003cspan style=\"color:#e6db74\"\u003e!\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          Write-Information \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$ind\u003cspan style=\"color:#e6db74\"\u003e Extracted PBIX metadata to FOLDER \u0026#39;(\u003c/span\u003e$output_path\u003cspan style=\"color:#e6db74\"\u003e)\u0026#39;!\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          Write-Information \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$ind\u003cspan style=\"color:#e6db74\"\u003e Overwriting \u0026#39;name\u0026#39; and \u0026#39;id\u0026#39; properties now ...\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#75715e\"\u003e# need to overwrite id and name as they are taken from the temporary dataset\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          $bim_json = Get-Content (Join-Path $output_path \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;database.json\u0026#34;\u003c/span\u003e) | ConvertFrom-Json\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          $bim_json.name = $pbix_file.BaseName\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          $bim_json.id = $pbix_file.BaseName\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          $bim_json | ConvertTo-Json -Depth \u003cspan style=\"color:#ae81ff\"\u003e50\u003c/span\u003e | Out-File (Join-Path $output_path \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;database.json\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          Write-Information \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$ind\u003cspan style=\"color:#e6db74\"\u003e PBIX metadata written to FOLDER \u0026#39;\u003c/span\u003e$output_path\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;!\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ecatch\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          Write-Warning \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;An error occurred:\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          Write-Warning $_\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003efinally\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e ($report \u003cspan style=\"color:#f92672\"\u003e-ne\u003c/span\u003e $null) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            Write-Information \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$ind\u003cspan style=\"color:#e6db74\"\u003e Removing temporary PowerBI report ...\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            Remove-PowerBIReport -WorkspaceId $workspace.Id -Id $report.Id\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e ($dataset \u003cspan style=\"color:#f92672\"\u003e-ne\u003c/span\u003e $null) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            Write-Information \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$ind\u003cspan style=\"color:#e6db74\"\u003e Removing temporary PowerBI dataset ...\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            Invoke-PowerBIRestMethod -Url \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;https://api.powerbi.com/v1.0/myorg/groups/\u003c/span\u003e$($workspace.Id)\u003cspan style=\"color:#e6db74\"\u003e/datasets/\u003c/span\u003e$($dataset.Id)\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e -Method Delete\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      Write-Information \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Finished!\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    pwsh\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e:\u003c/span\u003e true  \n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/power_bi_source_control/extraction.png\" alt=\"extraction\"\u003e\u003c/p\u003e\n\u003ch3 id=\"7-push-the-metadata-to-the-git-repository\"\u003e7. Push the Metadata to the Git repository\u003c/h3\u003e\n\u003cp\u003eThe final step is to push the .json metadata extracted by Tabular Editor to the repository. The script uses the name and email of the original committer and mentions the original id in the message for keeping things clear.\u003c/p\u003e\n\u003cp\u003eIf you get a \u003ccode\u003eGenericContribute\u003c/code\u003e permission error, remember to add the service principal account as Contributor as shown \u003ca href=\"https://stackoverflow.com/a/56542631\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bat\" data-lang=\"bat\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e- task: CmdLine@2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    displayName: Push PBIX metadata to Git repo\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    inputs:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      script: |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eSET\u003c/span\u003e _full_branch_name=$(Build.SourceBranch)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eSET\u003c/span\u003e _full_branch_name=%_full_branch_name:refs/heads/=%\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eSET\u003c/span\u003e _commit_message=\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ğŸ¤– PBIX Metadata Extraction for #\u003c/span\u003e%GIT_EVENT_AFTER%\u003cspan style=\"color:#e6db74\"\u003e $(Build.RequestedFor) [skip ci]\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        git config --global user.name \u0026#39;$(Build.RequestedFor)\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        git config --global user.email \u0026#39;$(Build.RequestedForEMail)\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        git checkout %_full_branch_name%\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        git stash\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        git pull\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        git stash apply\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        git add **/*.json\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        git status --porcelain\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        git commit -am %_commit_message%\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        git push origin HEAD:%_full_branch_name%\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"-conclusions\"\u003eğŸ”š Conclusions\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/power_bi_source_control/commit.png\" alt=\"commit\"\u003e\u003c/p\u003e\n\u003cp\u003eKeeping track of the changes inside Power BI files is still a painful process at the moment, and I sincerely hope that Microsoft will soon find a solution to the issue.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/power_bi_source_control/result.png\" alt=\"result\"\u003e\u003c/p\u003e\n\u003cp\u003eThe method I set up is working if the report contains a dataset and something has changed in the schema and the measures, but unfortunately it still can\u0026rsquo;t detect visual changes, which is the most common cause of confusion, especially when users begin messing around with bookmarks and filters. Since many of our reports are using external datasets as source, they are untracked by the system.\u003c/p\u003e\n\u003cp\u003eThe only solution currently available is \u003ca href=\"https://pbi.tools/cli/\"\u003epbi-tools\u003c/a\u003e, which is unfortunately unusable in a pipeline as it requires a Power BI Desktop instance on the VM (we can\u0026rsquo;t use the Core edition for extracting metadata). From \u003ca href=\"https://community.powerbi.com/t5/Desktop/docker/m-p/426116\"\u003ewhat I could find\u003c/a\u003e, containerizing the app is not a suitable solution, but I\u0026rsquo;m keeping an eye on \u003ca href=\"https://github.com/pbi-tools/pbi-tools/issues/176\"\u003ean open issue on Github\u003c/a\u003e that could be the final solution.\u003c/p\u003e\n\u003cp\u003eIn that case, we could just import the correct VM Image with the pre-installed pbi-tools, extract the metadata and commit the changes in a few steps (and I\u0026rsquo;ll be happy to update the guide).\u003c/p\u003e\n\u003cp\u003eFor now, be free to adapt my solution if it suits your needs!\u003c/p\u003e\n","description":"","image":"/images/power_bi_source_control/title.jpg","permalink":"https://mutt0-ds.github.io/posts/2022/11/turbulent-journey-power-bi-source-control/","title":"A turbulent journey through Power BI source control"},{"content":"\u003cp\u003eThis is a post for my future self when I will be asking myself: \u003cem\u003eâ€œHow were my first days at Acer like?â€\u003c/em\u003e.\u003cbr\u003e\nNote: I\u0026rsquo;m working at Acer EMEA HQ, so when I mention \u0026ldquo;\u003cem\u003eAcer\u003c/em\u003e\u0026rdquo;, for simplicity, I mean \u0026ldquo;\u003cem\u003eAcer Europe\u003c/em\u003e\u0026rdquo;.\u003c/p\u003e\n\u003ch2 id=\"-my-expectations\"\u003eğŸ’­ My expectations\u003c/h2\u003e\n\u003cp\u003eMy previous experience was in a small company and a very different sector. Considering this, I was expecting the following challenges in the upcoming scenario:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eAn organization with thousands of employees and decades of history\u003c/li\u003e\n\u003cli\u003eSeveral departments and key stakeholders to interact with, each one with specific priorities\u003c/li\u003e\n\u003cli\u003eA huge IT department where I\u0026rsquo;m the youngest member here\u003c/li\u003e\n\u003cli\u003eNew technologies to discover: in particular, I\u0026rsquo;ve never worked with most of the Azure tools we are using\u003c/li\u003e\n\u003cli\u003eA whole new level of complexity\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eI wasn\u0026rsquo;t too worried about the previous points, as I\u0026rsquo;m happy to learn new things and I\u0026rsquo;m used to managing projects with different stakeholders. Being a \u003cstrong\u003eBusiness Intelligence Developer\u003c/strong\u003e, my tasks were going to be about managing Power BI dashboards and collecting data from databases, more or less what I was used to doing before\u0026hellip;\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://learn.microsoft.com/it-it/power-bi/create-reports/media/sample-sales-and-marketing/sales1.png\" alt=\"example dashboard\"\u003e\u003cbr\u003e\n\u003cem\u003eExample of a typical Power BI report I work with\u003c/em\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eğŸ¤¯ What caught me off-guard was the \u003cstrong\u003escale\u003c/strong\u003e of Acer\u0026rsquo;s IT structure!\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul\u003e\n\u003cli\u003eWhile I was used to querying a DB with a few dozen tables, now I have to deep dive into hundreds (if not thousands) of tables and views.\u003c/li\u003e\n\u003cli\u003eWhile I set up a simple ETL with a few data sources and a couple of MB of data, the new process I\u0026rsquo;ve been shown features hundreds of queries, with different environments and edge cases to handle.\u003c/li\u003e\n\u003cli\u003eWhile I created a few Power BI reports with single datasets, we have tons of different ongoing projects and dozens of users editing and creating their own that.\u003c/li\u003e\n\u003cli\u003eWhile I was using only a small subset of Azure services, there are several new tools to learn, such as DevOps, Synapse (ETL), Purview (Data Governance), Active Directory (Permissions)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"1-first-week\"\u003e1ï¸âƒ£ First Week\u003c/h2\u003e\n\u003cp\u003eYou may laugh at my inexperience, but the first week I was coming home with a serious case of information overload. My head was so full that it was hurting. There was so much to learn, understand, write down\u0026hellip; I was feeling very tired and also a bit stressed.\u003c/p\u003e\n\u003cp\u003eEvery day I was looking at new things, meeting different people, discovering new dynamics to be aware of.\u003c/p\u003e\n\u003cp\u003eLuckily the team\u0026rsquo;s mentality is very dynamic, favoring independence and resourcefulness. The challenges are super stimulating, but I\u0026rsquo;ve never felt frustrated about them, as I\u0026rsquo;m capable to handle my assigned tasks. I was well supported, and this helped me a lot in the first difficult days, as I never felt alone.\u003c/p\u003e\n\u003cp\u003eI also noticed that, despite the huge scale of the organization, the architecture I\u0026rsquo;ve explored is rather clean and documented. I didn\u0026rsquo;t feel too lost, I was just disoriented by the mass of data.\u003c/p\u003e\n\u003ch2 id=\"2-second-week\"\u003e2ï¸âƒ£ Second Week\u003c/h2\u003e\n\u003cp\u003eStarting from the second week, I feel that I\u0026rsquo;m quickly getting used to my new world, as some of the challenges are becoming familiar and all the distinct pieces I\u0026rsquo;ve seen are clicking together.\u003c/p\u003e\n\u003cp\u003eEvery day I feel just a bit more skilled in my tasks and many things are becoming easier and easier, in perspective, compared to a few days ago.\u003c/p\u003e\n\u003cp\u003eOnce I got familiar to the basics of the services we use, Azure doesn\u0026rsquo;t look too confusing. For example, I had to write some PowerShell scripts to automate basic tasks and I was surprised of how little time it took me!\u003c/p\u003e\n\u003cp\u003eThe amount of data to explore is still overwhelming, but step after step I identified the more important tables, which are going to be used for the majority of the reports.\u003c/p\u003e\n\u003ch2 id=\"concluding\"\u003eConcluding\u003c/h2\u003e\n\u003cp\u003eDespite the difficulties in the first days, I feel more confident than ever about my adventure in Acer. That\u0026rsquo;s where I\u0026rsquo;ll grow a lot and create new, amazing things for the company.\u003c/p\u003e\n\u003cp\u003eI just miss using Python a bit, as Powershell has become my main scripting language (it\u0026rsquo;s synergizing better with Azure\u0026rsquo;s APIs)\u0026hellip; Yet this is part of a new experience, learning new things!\u003c/p\u003e\n","description":"","image":"/images/acer.png","permalink":"https://mutt0-ds.github.io/posts/2022/10/first-weeks-acer/","title":"My first weeks at Acer Europe"},{"content":"\u003cp\u003eDisclaimer: this will be a long, long post, written in my own way. Itâ€™s essentially a dump of my personal notes, taken when reading \u003ca href=\"https://www.sqlbi.com/books/the-definitive-guide-to-dax-2nd-edition/\"\u003eâ€œThe Definitive Guide to DAXâ€\u003c/a\u003e written by \u003cstrong\u003eAlberto Ferrari\u003c/strong\u003e and \u003cstrong\u003eMarco Russo\u003c/strong\u003e. At my new workplace Iâ€™m going to use PowerBI and DAX a lot, thus my boss suggested me to read the book.\u003c/p\u003e\n\u003cp\u003eYep, it is big and very technical, with 700+ pages rich in contents, but trust me, thatâ€™s the â€œBibleâ€, a must-read for anyone willing to work with PowerBI and DAX. Thereâ€™s everything you need, from the basics commands to the most advanced functions, with complex topics such as context transition, query plan, and storage engine. Many examples, in addition, apart from explaining every concept introduced in the book (which focuses a lot on giving clear, practical explanations) explore edge cases that gave me lots of headaches in the past. Further examples and insights can be found on the authorsâ€™ site \u003ca href=\"https://www.sqlbi.com/\"\u003eSQLBI\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eIt took me several weeks for finishing it, but I felt extremely prepared after the experience and grateful for such a useful resource that will be fundamental in my future. The authors did a terrific job and I am happy to support them and share a positive feedback of their work on my blog. Knowing that my memory is terrible I took accurate notes of everything I found interesting and what I have to read again. I hope it will help you as well!\u003c/p\u003e\n\u003ch3 id=\"my-personal-classification-of-each-chapter\"\u003eMy personal classification of each chapter\u003c/h3\u003e\n\u003cp\u003eâš ï¸ \u003cstrong\u003eVERY IMPORTANT\u003c/strong\u003e, read it several times and understand everything\u003c/p\u003e\n\u003cp\u003eğŸ”„ To read again, plenty of examples/documentation\u003c/p\u003e\n\u003cp\u003eâœ¨ Useful\u003c/p\u003e\n\u003cp\u003eâ“ Minor insights\u003c/p\u003e\n\u003ch2 id=\"1--what-is-dax\"\u003e1 âœ¨ What is DAX?\u003c/h2\u003e\n\u003cp\u003eIntroductive chapter that introduces the concept of  \u003cstrong\u003eD\u003c/strong\u003eata \u003cstrong\u003eA\u003c/strong\u003enalysis e\u003cstrong\u003eX\u003c/strong\u003epressions, thereâ€™s nothing more to add. Thereâ€™s an interesting presentation of all the different points of view of possible users (the ones who come from an Excel Background, or a PowerBI one, a SQL oneâ€¦). Personally, I felt in synthony with the â€˜typicalâ€™ SQL user: learning that the \u003ccode\u003eFILTER\u003c/code\u003e DAX clause is the equivalent of a \u003ccode\u003eWHERE\u003c/code\u003e immediately cleared some doubts I had.\u003c/p\u003e\n\u003ch2 id=\"2--introducing-dax\"\u003e2 ğŸ”„ Introducing DAX\u003c/h2\u003e\n\u003cp\u003eVery important section for beginners, explaining the most common functions and the difference between calculated column and measure.\u003c/p\u003e\n\u003cp\u003eIt introduces the different data types, which are the classic ones (Integer, Float, Currency, Datetime, Boolean, Strings, Binary), with just a new type, Variant, which is DAX-specific and simply means that there could be different data types (such as \u003ccode\u003eAny\u003c/code\u003ein Python).\u003c/p\u003e\n\u003cp\u003eThere are brief introductions of the operators: arithmetic (+-*/), comparatives (\u0026lt;,\u0026gt;,=,\u0026lt;\u0026gt;,â‰¥,â‰¤), logic (\u0026amp;\u0026amp;, ||, IN, NOT) and tables, created with {} and must include parenthesis in case of multiple values. E.g. \u003ccode\u003eColours = {â€Redâ€, â€œWhiteâ€, â€œBlueâ€}\u003c/code\u003e. \u003ccode\u003eAnimals = {(â€Dogâ€, â€œWoofâ€),( â€œCatâ€, â€œMeowâ€)}\u003c/code\u003e\u003c/p\u003e\n\u003ch3 id=\"calculated-columns\"\u003eCalculated Columns\u003c/h3\u003e\n\u003cp\u003eWritten as \u003ccode\u003eâ€˜Table Nameâ€™[Column Name]\u003c/code\u003e, calculated columns are new columns added to the data model, and you can use them just like a default one, independently from the context. Just be aware that in Import Mode (the standard one), they are calculated during the data refresh, then stored in memory, occupying some precious RAM! If you have a complex formula, donâ€™t break it down into intermediate steps as you do in Excel, but rather create and test it in DAX Studio and store the result in a single calculated column to optimize the model.\u003c/p\u003e\n\u003cp\u003eYou should use a calculated column if:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe result will be in a slicer, matrix, pivot, or \u003ccode\u003eFILTER\u003c/code\u003e condition\u003c/li\u003e\n\u003cli\u003eYou have an expression that is relative to the single row and doesnâ€™t require aggregation, like \u003ccode\u003ePrice * Quantity\u003c/code\u003e which must use the Price of the row and the Quantity of the row\u003c/li\u003e\n\u003cli\u003eYou have to categorize text or numbers, e.g. assigning a High, Medium, Low range, or 0-18, 18-25, 25+. Again, itâ€™s when you donâ€™t want to aggregate results\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"measures\"\u003eMeasures\u003c/h3\u003e\n\u003cp\u003eA measure is not directly associated with a table and itâ€™s written as \u003ccode\u003e[Measure Name]\u003c/code\u003e. Generally, you should use them when you donâ€™t want to calculate values for each row, but you want an aggregation: in fact, a measure has an implicit CALCULATE clause in its formula and is modified by the context (see Chapter 5). Hereâ€™s a good example:\u003c/p\u003e\n\u003cp\u003eIf you create a calculated column like \u003ccode\u003eSales[GrossMarginPct] = Sales[GrossMargin] / Sales[SalesAmount]\u003c/code\u003e, you will see that the total is more than 100% (If our ten products have a 50% Gross Margin each, the table displays 50*10 â†’ 500%)! DAX is applying the formula row-by-row, but we want to see the total instead. A measure \u003ccode\u003eGrossMarginPct := SUM ( Sales[GrossMargin] ) / SUM (Sales[SalesAmount] )\u003c/code\u003e will give the correct result instead.\u003c/p\u003e\n\u003cp\u003eYou should use a measure if:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe value depends on the context and userâ€™s selections\u003c/li\u003e\n\u003cli\u003eValues are in an aggregate form\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"variables\"\u003eVariables\u003c/h3\u003e\n\u003cp\u003eWrite them at the beginning of the DAX formula as \u003ccode\u003eVAR TotalSales = SUM(Sales[SalesAmount])  ... RETURN *result\u003c/code\u003e (there must be a RETURN at the end). They are IMMUTABLE and generated at the start of the calculation. They are temporary measures existing only internally to the measure you are using, and they are very useful for breaking down a formula into more readable steps and for avoiding repetitions.\u003c/p\u003e\n\u003ch3 id=\"basic-functions\"\u003eBasic Functions\u003c/h3\u003e\n\u003cp\u003eNote: many of them have an iterative version (\u003ccode\u003eSUM\u003c/code\u003e/\u003ccode\u003eSUMX\u003c/code\u003e), these examples are the same:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSales[DaysToDeliver] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e INT ( Sales[Delivery Date] \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e Sales[\u003cspan style=\"color:#66d9ef\"\u003eOrder\u003c/span\u003e Date] )\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAvgDelivery :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e AVERAGE ( Sales[DaysToDeliver] )\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e They \u003cspan style=\"color:#66d9ef\"\u003eare\u003c/span\u003e the same, but the \u003cspan style=\"color:#66d9ef\"\u003esecond\u003c/span\u003e one \u003cspan style=\"color:#66d9ef\"\u003eis\u003c/span\u003e better optimized\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAvgDelivery :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAVERAGEX (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tSales,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tINT ( Sales[Delivery Date] \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e Sales[\u003cspan style=\"color:#66d9ef\"\u003eOrder\u003c/span\u003e Date] ))\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eBasic: \u003ccode\u003eSUM, AVERAGE, COUNT, COUNTBLANK, COUNTROWS, DISTINCTCOUNT, DISTINCTCOUNTNOBLANK\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eLogic: \u003ccode\u003eAND, OR, IF, IFERROR, NOT, TRUE, SWITCH\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eInformation: \u003ccode\u003eISBLANK, ISERROR, ISLOGICAL, ISNONTEXT, ISNUMBER, ISTEXT\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eMathematical: \u003ccode\u003eABS, EXP, FACT, LN, LOG, LOG10, MOD, PI, POWER, QUOTIENT, SIGN, SQRT, RANDOM, RANDBETWEEN, ROUND, EVEN, ODD\u003c/code\u003e e many more\u003c/li\u003e\n\u003cli\u003eTextual: \u003ccode\u003eCONCATENATE, CONCATENATEX, EXACT, FIND, FIXED, FORMAT, LEFT, LEN, LOWER, MID, REPLACE, REPT, RIGHT, SEARCH, SUBSTITUTE, TRIM, UPPER, VALUE\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eConversions: \u003ccode\u003eCURRENCY, INT, DATE, TIME, VALUE, DATEVALUE, FORMAT\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eDate \u0026amp; Time:\u003ccode\u003eDATE, DATEVALUE, DAY, EDATE, EOMONTH, HOUR, MINUTE, MONTH, NOW, SECOND, TIME, TIMEVALUE, TODAY, WEEKDAY, WEEKNUM, YEAR, YEARFRAC\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eRelational: \u003ccode\u003eRELATED\u003c/code\u003e e \u003ccode\u003eRELATEDTABLE\u003c/code\u003e. They are very powerful, we will explore them later\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"3--using-basic-table-functions\"\u003e3 âš ï¸ Using basic table functions\u003c/h2\u003e\n\u003ch3 id=\"filter\"\u003eFILTER\u003c/h3\u003e\n\u003cp\u003eThe book introduces \u003ccode\u003eFILTER\u003c/code\u003e and the \u003ccode\u003eEVALUATE\u003c/code\u003e concept, to be used on DAX Studio. With \u003ccode\u003eFILTER\u003c/code\u003e with multiple conditions, a good tip is to put the most restrictive at the top of the query, to optimize it in case of big tables.\u003c/p\u003e\n\u003ch3 id=\"all\"\u003eALL*\u003c/h3\u003e\n\u003cp\u003eALL* gets introduced too, they are extremely powerful: \u003ccode\u003eALL, ALLEXCEPT, ALLCROSSFILTERED, ALLNOBLANKROW, ALLSELECTED\u003c/code\u003e. \u003ccode\u003eALL\u003c/code\u003e IGNORES EVERY ACTIVE FILTER in the report and itâ€™s useful when you calculate ratios and percentages compared to the total, regardless of filters and usersâ€™ selections. It returns a list of unique values, requiring a table or a list of columns, not an expression; if you use \u003ccode\u003eALL\u003c/code\u003e with more than a column, it will give back all the possible unique combinations existing in the table. \u003ccode\u003eALLEXCEPT\u003c/code\u003e can be translated as â€˜take everything from that table except the following columnsâ€™. The rest will be explained in Chapter 14.\u003c/p\u003e\n\u003ch3 id=\"valuesdistinctblank\"\u003eVALUES,DISTINCT,BLANK\u003c/h3\u003e\n\u003cp\u003eLike \u003ccode\u003eALL\u003c/code\u003e, \u003ccode\u003eVALUES\u003c/code\u003e and \u003ccode\u003eDISTINCT\u003c/code\u003e return a list of unique values tooâ€¦ With a big difference. \u003ccode\u003eVALUES\u003c/code\u003e returns the visible values, so itâ€™s not ignoring the active filters, and the same does \u003ccode\u003eDISTINCT\u003c/code\u003e. They are different in the case of invalid relations. Thereâ€™s a great example in the chapter: if, for example, a product is missing from the Product table, the join between it and the Sales table will have blank rows in the results. In this case, \u003ccode\u003eDISTINCT\u003c/code\u003e gets confused when calculating the average amount for product, while \u003ccode\u003eVALUES\u003c/code\u003e considers the blank row correctly in the division. TL;DR: use \u003ccode\u003eVALUES\u003c/code\u003e most of the cases.\u003c/p\u003e\n\u003cp\u003eThereâ€™s a brief insight  about \u003ccode\u003eHASONEVALUE\u003c/code\u003e, a shortcut for \u003ccode\u003eIF ( COUNTROWS ( VALUES ( [colonna] ) ) = 1, VALUES ( [colonna] )\u003c/code\u003e; it has a second argument for returning a message if thereâ€™s more than a value: it can be useful for cards and elements that expect only one value to be selected.\u003c/p\u003e\n\u003ch2 id=\"4--understanding-evaluation-context\"\u003e4 âš ï¸ Understanding Evaluation Context\u003c/h2\u003e\n\u003cp\u003eâš ï¸ï¸ The authors say that this chapter and #5 are the most important of the entire book. If you understand context, you will avoid the most common errors when you code in DAX. Read it several times until you understand everything!\u003c/p\u003e\n\u003cp\u003eIn DAX, there are two completely different contexts impacting your formulas. \u003cstrong\u003eFilter Context\u003c/strong\u003e, which \u003cstrong\u003efilters data\u003c/strong\u003e, and \u003cstrong\u003eRow Context\u003c/strong\u003e, which \u003cstrong\u003eiterates through tables\u003c/strong\u003e. A context is, in short, the environment where the expression is evaluated.\u003c/p\u003e\n\u003ch3 id=\"filter-context\"\u003eFilter Context\u003c/h3\u003e\n\u003cp\u003eIâ€™m not able to explain it as well as in the book without examples, but hereâ€™s my personal interpretation.\u003c/p\u003e\n\u003cp\u003eLetâ€™s take a table with a measure, say \u003ccode\u003eTotalSales = SUMX(Sales[Amount]\u003c/code\u003e. A table has rows and cells. Every expression is evaluated based on its cell, which in turn is modified based on active filters and the selected column. So, the TotalSales measure will be, say, 30Mln if I put it into a card with no filters and just a cell, but if I use it in a table with multiple rows the is split based on the rowâ€™s contents (imagine a division by Area: Europe, US, Asia â†’ 30mln will become 10mln x 3 cells. Behind the scenes, DAX is adding a \u003ccode\u003eFILTER\u003c/code\u003e saying \u003ccode\u003eFILTER (Area = â€˜Europeâ€™)\u003c/code\u003e and so on, for every cell). So, the filter context changes the outcome of the expression considering the filters that become active if, for example, itâ€™s inside a specific cell of a table. Whatâ€™s important is the context of the cell containing it: which is precisely the filter context.\u003c/p\u003e\n\u003ch3 id=\"row-context\"\u003eRow Context\u003c/h3\u003e\n\u003cp\u003eThe example I recommend to read carefully uses this calculated column \u003ccode\u003eSales[Gross Margin] = Sales[Quantity] * ( Sales[Net Price] - Sales[Unit Cost] )\u003c/code\u003e. Now remember, this column reasons in terms of rows, so, how does DAX manages to understand which row is working on? Using row context, which is basically a cursor. Row context, then, calculates the expression by considering the row that contains it.\u003c/p\u003e\n\u003cp\u003eIf you write Gross Margin as a measure, you lose the row context, thus you need the iterative version ending with X: \u003ccode\u003eGross Margin := SUMX ( Sales, Sales[Quantity] * ( Sales[Net Price] - Sales[Unit Cost] ) )\u003c/code\u003e  . The iterative version works because it uses SUMX, capable of keeping the row context. \u003ccode\u003eGross Margin := Sales[Quantity] * ( Sales[Net Price] - Sales[Unit Cost] )\u003c/code\u003e is invalid.\u003c/p\u003e\n\u003ch3 id=\"other-notes\"\u003eOther Notes\u003c/h3\u003e\n\u003cp\u003eâ€¦ The chapter goes on with several interesting examples and questions for understanding the contexts, especially when used in filters.\u003c/p\u003e\n\u003cp\u003eIn the case of complex functions that work in two different contexts, thereâ€™s the \u003ccode\u003eEARLIER\u003c/code\u003e function for accessing the more external layer. Honestly, I hope to never use it, itâ€™s extremely tricky, read the book to understand how the switch works, but even the authors admit that variables work better.\u003c/p\u003e\n\u003cp\u003eGolden rule: \u003cstrong\u003erow context iterates, filter context filters\u003c/strong\u003e. Thus you canâ€™t use the row context without a \u003ccode\u003eRELATED/RELATEDTABLE\u003c/code\u003e. On the contrary, the filter context uses relationships automatically, but be aware that its behavior can be different depending on the relationshipâ€™s direction (see chapter 15). I point out a very interesting example with \u003ccode\u003eSUMMARIZE\u003c/code\u003e in the case of the calculation of the average customersâ€™ age without including duplicates: the code shows how to include a different column, read it carefully.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCorrect Average :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e AVERAGEX ( \u003cspan style=\"color:#75715e\"\u003e-- Iterate on \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\t\tSUMMARIZE ( \u003cspan style=\"color:#75715e\"\u003e-- all the existing combinations \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\t\tSales, \u003cspan style=\"color:#75715e\"\u003e-- that exist in Sales \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\t\tSales[CustomerKey], \u003cspan style=\"color:#75715e\"\u003e-- of the customer key and \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\t\tSales[Customer Age] \u003cspan style=\"color:#75715e\"\u003e-- the customer age \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\t), \u003cspan style=\"color:#75715e\"\u003e-- \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003eSales[Customer Age] \u003cspan style=\"color:#75715e\"\u003e-- and average the customer\u0026#39;s age \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e) \u003cspan style=\"color:#75715e\"\u003e-- TODO: you should break it down in a variable and use AVERAGEX too\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"5--understanding-calculate-and-calculatetable\"\u003e5 âš ï¸ Understanding CALCULATE and CALCULATETABLE\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003eCALCULATE\u003c/code\u003e is the most important and powerful DAX function and the one with significant nuances to understand. \u003ccode\u003eCALCULATETABLE\u003c/code\u003e  is the same but returns a table. Their complexity is caused by their unique characteristic: \u003cstrong\u003ethey can create new filters\u003c/strong\u003e thus modifying the filter context seen in Chapter 4. Here again, the authors recommend reading the section several times until perfectly understand it.\u003c/p\u003e\n\u003cp\u003eThe formula is \u003ccode\u003eCALCULATE ( Expression, Condition1, ... ConditionN )\u003c/code\u003e, accepting every expression as a first parameter, then N filters. For filters, which are tables or lists of values, you can use an expression like \u003ccode\u003e'Product'[Brand] = \u0026quot;Contosoâ€\u003c/code\u003e; behind the scenes, DAX changes it to \u003ccode\u003eFILTER ( ALL ( 'Product'[Brand] ), 'Product'[Brand] = \u0026quot;Contoso\u0026quot; )\u003c/code\u003e. For readability, use the compact form, but be aware of some edge cases that require the extended \u003ccode\u003eFILTER\u003c/code\u003e one.\u003c/p\u003e\n\u003cp\u003eIn short, \u003ccode\u003eCALCULATE\u003c/code\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eMakes a copy of the existing filter context\u003c/li\u003e\n\u003cli\u003eEvaluates every filter in its arguments, and, for each condition, creates a list of valid values for the specific column (in the example, it will be \u003ccode\u003e{â€™Contoso}â€™\u003c/code\u003e). Itâ€™s like a \u003ccode\u003eFILTER ALL\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eIf  2+ filters concern the same columns, they will be joined with an \u003ccode\u003eAND\u003c/code\u003estatement\u003c/li\u003e\n\u003cli\u003eUses the new condition for replacing the existing filters (thus ignoring previous selections or filters!) or adding it to the context if they are new\u003c/li\u003e\n\u003cli\u003eIf thereâ€™s a row context, it applies a \u003cstrong\u003eCONTEXT TRANSITION\u003c/strong\u003e (VERY IMPORTANT, SEE BELOW) transforming it into a filter context and removing the aforementioned row context\u003c/li\u003e\n\u003cli\u003eWhen itâ€™s done, it applies the new filter context to the model, makes the calculation then comes back to the original situation. Itâ€™s just a temporary modification\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eNow, remember: since \u003ccode\u003eCALCULATE\u003c/code\u003e  uses a \u003ccode\u003eFILTER ( ALL)\u003c/code\u003e behind the scenes, if you want to avoid losing all the previous filters you have to use the extended form with \u003ccode\u003eVALUES\u003c/code\u003e in the argument instead of \u003ccode\u003eALL\u003c/code\u003e. With this method, the existing filters will be kept. I point out another interesting example that shows a Ratio in relationship with the unfiltered Sales table, while the Date table has to keep its filters.\u003c/p\u003e\n\u003ch3 id=\"filtering-with-complex-conditions\"\u003eFiltering with complex conditions\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e WRONG\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003e There \u003cspan style=\"color:#66d9ef\"\u003eare\u003c/span\u003e two different columns, you have \u003cspan style=\"color:#66d9ef\"\u003eto\u003c/span\u003e use the extended form\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSales \u003cspan style=\"color:#66d9ef\"\u003eLarge\u003c/span\u003e Amount :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tCALCULATE (\t [Sales Amount],\t Sales[Quantity] \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Sales[Net Price] \u003cspan style=\"color:#f92672\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1000\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e CORRECT\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSales \u003cspan style=\"color:#66d9ef\"\u003eLarge\u003c/span\u003e Amount :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tCALCULATE ( [Sales Amount],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e FILTER (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t \u003cspan style=\"color:#66d9ef\"\u003eALL\u003c/span\u003e ( Sales[Quantity], Sales[Net Price] ),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t Sales[Quantity] \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e Sales[Net Price] \u003cspan style=\"color:#f92672\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1000\u003c/span\u003e ))\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThereâ€™s an example with a slicer trying to filter a table with a measure using \u003ccode\u003eCALCULATE\u003c/code\u003e, but obviously since thereâ€™s an \u003ccode\u003eALL\u003c/code\u003ein the compact form, the slicer doesnâ€™t work! You must use a \u003ccode\u003eKEEPFILTERS\u003c/code\u003e  for wrapping the filter condition.\u003c/p\u003e\n\u003ch3 id=\"context-transition\"\u003eContext Transition\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003eCALCULATE\u003c/code\u003e invalidates any row context. It automatically adds as filter arguments all the columns that are currently being iterated in any row contextâ€”filtering their actual value in the row being iterated\nIn short, \u003ccode\u003eCALCULATE\u003c/code\u003e transforms the row context into a new filter to be added to the filter context, since thereâ€™s no way for it to understand the row context. Thatâ€™s the transition!\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eAn excellent example for reviewing the concept. The formula \u003ccode\u003eSum Num Of Sales := SUMX ( Sales, COUNTROWS ( Sales ) )\u003c/code\u003e, surprisingly, shows the squared \u003ccode\u003eCOUNTROWS\u003c/code\u003e! In fact, the amount of Contoso rows is, say, 37000, and \u003ccode\u003eSUMX\u003c/code\u003e iterates 37000 times for each row, thus the outcome will be 37000*37000 since itâ€™s targeting the row context!\u003c/p\u003e\n\u003cp\u003eAnother example:  \u003ccode\u003eSales Amount := SUMX ( Sales, CALCULATE ( SUM ( Sales[Quantity])))\u003c/code\u003e. The secret is that, behind the scenes, CALCULATE is using row-by-row filters since itâ€™s following the row context in the SUM, thus itâ€™s calculating \u003ccode\u003eTot = CALCULATE(SUM ( Sales[Quantity] ), Sales[Product] = â€œAâ€)  + CALCULATE(SUM ( Sales[Quantity] ), Sales[Product] = â€œBâ€)\u003c/code\u003e\u0026hellip; for n times.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe context transition (from now, CT) is expensive. Use \u003ccode\u003eCALCULATE\u003c/code\u003esparingly, because during iterations it will apply filters on every row\u003c/li\u003e\n\u003cli\u003eCT doesnâ€™t filter one row only! \u003cstrong\u003eThe new filter filters all the rows with the same value\u003c/strong\u003e! So, if in the example above \u003ccode\u003eSales[Product] = â€œAâ€\u003c/code\u003e, there could be more than one result based on the input data\u003c/li\u003e\n\u003cli\u003eCT may use columns not included in the formula\u003c/li\u003e\n\u003cli\u003eCT creates a filter context from a row context\u003c/li\u003e\n\u003cli\u003eCT happens only when thereâ€™s a row context (in iterators and calculated columns). Remember that measures contain implicit \u003ccode\u003eCALCULATE\u003c/code\u003e too!\u003c/li\u003e\n\u003cli\u003eCT transforms all the row contexts, without exceptions\u003c/li\u003e\n\u003cli\u003eCT invalids every existing row context once the transition happens\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/definitive_guide_dax/dax_1.png\" alt=\"SUMX without CALCULATE example\"\u003e\n\u003cem\u003e\u003ccode\u003eSUMX\u003c/code\u003e without CALCULATE ignores the row context. The solution work because the Sales column has unique IDs, so there arenâ€™t duplicates!\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003eUnfortunately, the CT doesnâ€™t filter a single row but works with unique values, so we will have extremely tricky errors in case of tables with duplicates! Using this tactic is not only incorrect, but also very slow since the engine has to iterate for all the rows of the table. Using a measure is wrong too, because:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eWhenever you read a measure call in DAX, you should always read it as if \u003ccode\u003eCALCULATE\u003c/code\u003e were there\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/definitive_guide_dax/dax_2.png\" alt=\"Wrong formula\"\u003e\n\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/definitive_guide_dax/dax_3.png\" alt=\"Wrong formula Results\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eWrong formula: the Right Sales Amount doesnâ€™t use \u003ccode\u003eCALCULATE\u003c/code\u003e\u003c/em\u003e\u003c/p\u003e\n\u003ch2 id=\"calculate-modifiers-see-chapter-14\"\u003eCALCULATE modifiers (see Chapter 14)\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eUSERELATIONSHIP\u003c/code\u003e, used in some edge cases (e.g. you have an Order Date and a Delivery Date, which one should you use as a Relationship Key with the Date table?). You will have to make two relationships, one active and one inactive, then add in the expressions using the inactive relationship the expression \u003ccode\u003eUSERELATIONSHIP(Key1, Key2)\u003c/code\u003e in the \u003ccode\u003eCALCULATE\u003c/code\u003e, which tells DAX to temporarily change the status of the inactive relationship.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eCROSSFILTER\u003c/code\u003e, which is similar, but more powerful: it can disable the relationship between tables and change its direction (more on this later). I\u0026rsquo;ve never used it though\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eKEEPFILTERS\u003c/code\u003e keeps the existing filters like \u003ccode\u003eVALUES\u003c/code\u003e, for example in \u003ccode\u003eAudio Sales KeepFilters := CALCULATE ( [Sales Amount], KEEPFILTERS ( 'Product'[Category] = \u0026quot;Audio\u0026quot; ) )\u003c/code\u003e. However, it doesn\u0026rsquo;t overwrite the filter context, but simply adds the filters in its arguments with an \u003ccode\u003eAND\u003c/code\u003e operator. The outcome will then have BLANK rows if they aren\u0026rsquo;t included in the filter condition. Observe the differences:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/definitive_guide_dax/dax_4.png\" alt=\"CALCULATE example\"\u003e\n\u003cem\u003e\u003ccode\u003eCALCULATE ( [Sales Amount], 'Product'[Category] = \u0026quot;Audio\u0026quot; )\u003c/code\u003e\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/definitive_guide_dax/dax_5.png\" alt=\"CALCULATE KEEPFILTERS example\"\u003e\n\u003cem\u003e\u003ccode\u003eCALCULATE ( [Sales Amount], KEEPFILTERS ( 'Product'[Category] = \u0026quot;Audio\u0026quot; ) )\u003c/code\u003e\u003c/em\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eALL\u003c/code\u003e shows a different behavior if used inside a \u003ccode\u003eCALCULATE\u003c/code\u003e, becoming a sort of \u003ccode\u003eREMOVEFILTER\u003c/code\u003e and removing the effect of any \u003ccode\u003eKEEPFILTERS\u003c/code\u003e, even if it\u0026rsquo;s used after the statement. That\u0026rsquo;s because the ALL* modifiers have higher execution priority than normal filters\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/definitive_guide_dax/dax_6.png\" alt=\"They are the same\"\u003e\n\u003cem\u003eThey are the same\u003c/em\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eALLSELECTED\u003c/code\u003e, like \u003ccode\u003eALL\u003c/code\u003e, has a different behavior: see Chapter 14 and be very careful when using it, it should be avoided!\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"6--variables\"\u003e6 âœ¨ Variables\u003c/h2\u003e\n\u003cp\u003eThey are important for code readability and performance optimization, use them if you see repetitions. The only thing to remember well is that they are immutable CONSTANTS calculated at the beginning of the calculation containing them. Every variables must be introduced with \u003ccode\u003eVAR\u003c/code\u003e.\nPay attention to the definition order: a variable can\u0026rsquo;t reference another variable declared later.\u003c/p\u003e\n\u003cp\u003eAnother peculiarity is the name: it must be different from every existing table\u0026rsquo;s name, otherwise DAX gets confused. A best practice is to use long names precisely describing their purpose. The engine, when creating variables, uses two \u003ccode\u003e__\u003c/code\u003eas prefix\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/definitive_guide_dax/dax_7.png\" alt=\"good example about variablesâ€™ immutability\"\u003e\n\u003cem\u003eHereâ€™s a good example about variablesâ€™ immutability\u003c/em\u003e\u003c/p\u003e\n\u003ch2 id=\"7--working-with-iterators-and-with-calculate\"\u003e7 ğŸ”„ Working with iterators and with CALCULATE\u003c/h2\u003e\n\u003cp\u003eMost of the iterators require a table and an expression used to calculate something row-by-row inside that table (e.g. \u003ccode\u003eSUMX\u003c/code\u003e calculates the sum). Specifically, the expression will iterate every row, collecting its value, then will apply the operation (in this case, a sum). Thus, all the iterators are working in the same way, except for the final operation they apply.\u003c/p\u003e\n\u003cp\u003eKeyword: \u003cstrong\u003eiterator cardinality\u003c/strong\u003e â†’ it\u0026rsquo;s the number of rows scanned by the iterator and it should be kept as low as possible. You should avoid nesting different iterations, making the cardinality grow exponentially.\u003c/p\u003e\n\u003cp\u003eThe chapter goes on with several interesting examples, such as how to calculate the day of the biggest sale by nesting \u003ccode\u003eMAXX\u003c/code\u003e and \u003ccode\u003eSUMX\u003c/code\u003e, or showing the list of visible colors by using CONCATENATEX\u003ccode\u003ee\u003c/code\u003eVALUES\u003ccode\u003e, or how\u003c/code\u003e ALLSELECTED\u003ccode\u003emakes more sense when used together with\u003c/code\u003eRANKX\u003ccode\u003eis the user is applying a filter, and how\u003c/code\u003eAVERAGEX\u003ccode\u003eshould be changed with\u003c/code\u003eDIVIDE` in case some blank values are in the data since the latter can manage automatically the division by zero and gives a correct result.\u003c/p\u003e\n\u003ch2 id=\"8--time-intelligence-calculations\"\u003e8 ğŸ”„ Time Intelligence Calculations\u003c/h2\u003e\n\u003cp\u003eVery useful chapter, since dates in DAX are handled in a not-so-intuitive way.\u003c/p\u003e\n\u003cp\u003eA great tip is to always have a date table called Date in relationship with all the others for working with dates exclusively there, for optimizing performances, simply the structure and improving the user experience.\u003c/p\u003e\n\u003cp\u003eBy default, PowerBI creates a hidden date table for every Time/DateTime column of the model, to create slicers and drilldowns with a calendar logic (year, quarter, month, day etc\u0026hellip;). Unfortunately, this method creates a table for every column, causing overheads, and you can\u0026rsquo;t either view or modify them. It\u0026rsquo;s better to deactivate the automatic creation and use your user-created Date table.\u003c/p\u003e\n\u003ch3 id=\"some-notes\"\u003eSome notes\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eDon\u0026rsquo;t make it huge, like 1900-2100 (ooooops ğŸ˜•). It increases the cardinality and slows down calculations\u003c/li\u003e\n\u003cli\u003eUse â€œ â€œ when mentioning the \u0026ldquo;Date\u0026rdquo; table, because \u003ccode\u003eDATE\u003c/code\u003e is a reserved keyword in DAX (being a function)\u003c/li\u003e\n\u003cli\u003eYou can quickly create your \u0026ldquo;Date\u0026rdquo; table using \u003ccode\u003eCALENDAR\u003c/code\u003e and \u003ccode\u003eCALENDARAUTO\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eUseful template from the authors: \u003ca href=\"https://www.sqlbi.com/tools/dax-date-template/\"\u003ehttps://www.sqlbi.com/tools/dax-date-template/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eUse \u003ccode\u003eUSERELATIONSHIP\u003c/code\u003e for making calculations with different Date columns as key (see Chapter 5 with active/inactive relationships)\u003c/li\u003e\n\u003cli\u003eDAX takes a different approach when using a Date filter in a \u003ccode\u003eCALCULATE\u003c/code\u003e with two columns connected with Date relationships (both keys are dates): the engine automatically adds \u003ccode\u003eALL (â€™Dateâ€™)\u003c/code\u003e to the formula for making possible time intelligence calculations without messing up with the context transition (see the examples)\u003c/li\u003e\n\u003cli\u003eYou can apply the same special behavior with the \u003cstrong\u003eâ€œMark as Date Tableâ€\u003c/strong\u003e command to avoid putting \u003ccode\u003eALL\u003c/code\u003e in every measure if you have a non-Time formatted key (e.g. int YYYYMMMDD)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"some-useful-functions\"\u003eSome useful functions\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eDATESYTD\u003c/code\u003e returns all the dates from the beginning of the year till now, for a quick filter in a \u003ccode\u003eCALCULATE\u003c/code\u003e. There are equivalent expressions, \u003ccode\u003eDATESMTD\u003c/code\u003e and \u003ccode\u003eDATESQTD\u003c/code\u003e, for months and quarters\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eAvoid the deprecated \u003ccode\u003eTOTALYTD ( [Sales Amount], 'Date'[Date] )\u003c/code\u003e, equivalent to \u003ccode\u003eCALCULATE ([Sales Amount], DATESYTD(â€™Dateâ€™))\u003c/code\u003e: it has a hidden \u003ccode\u003eCALCULATE\u003c/code\u003e!\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eSTARTOFYEAR, ENDOFYEAR, PREVIOUSYEAR, NEXTYEAR, DATESYTD, TOTALYTD, OPENINGBALANCEYEAR\u003c/code\u003e, \u003ccode\u003eCLOSINGBALANCEYEAR\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eSAMEPERIODLASTYEAR\u003c/code\u003e returns a set of dates shifted one year before\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eDATEADD\u003c/code\u003e is very powerful and flexible: you can decide how much to add (a number) and what (years, quarters, months, etc\u0026hellip;), such as \u003ccode\u003ePQ Sales := CALCULATE ( [Sales Amount], DATEADD ( 'Date'[Date], -1, QUARTER ) )\u003c/code\u003e. It always returns days included in the Date table and it can become cumbersome during some edge cases, read well this section.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003ePARALLELPERIOD\u003c/code\u003e is useful if you are looking for the entire period despite the presence of row filters. So, for example, if you want the result of the previous quarter in the rows January, February, March write \u003ccode\u003ePQ Total Sales :=CALCULATE ( [Sales Amount], PARALLELPERIOD ( 'Date'[Date], -1, QUARTER ) )\u003c/code\u003e and see the results in the example:\n\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/definitive_guide_dax/dax_8.png\" alt=\"PARALLELPERIOD\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThe functions \u003ccode\u003ePREVIOUSYEAR, PREVIOUSQUARTER, PREVIOUSMONTH, PREVIOUSDAY, NEXTYEAR, NEXTQUARTER, NEXTMONTH,\u003c/code\u003e and \u003ccode\u003eNEXTDAY\u003c/code\u003e are using the same \u0026lsquo;independent\u0026rsquo; context\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eDATESINPERIOD\u003c/code\u003e is a classic for calculating the Moving Annual Total (the total of the last 12 months). There are some alternative examples with \u003ccode\u003eDATESBETWEEN\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ePay attention to the semi-additive measures, which can be cumbersome. For example, a bank account balance: it\u0026rsquo;s not the sum of all the rows in the previous period, but the value at the end of the month! The suggestion is to use \u003ccode\u003eLASTDATE\u003c/code\u003e and \u003ccode\u003eLASTNONBLANK\u003c/code\u003e to calculate the balance on the last available day, without messing up with the row context.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eSTARTOFYEAR, STARTOFQUARTER, STARTOFMONTH, ENDOFYEAR, ENDOFQUARTER, ENDOFMONTH\u003c/code\u003e are mostly used for financial data, see the stock chart example\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"9--calculations-group\"\u003e9 â“ Calculations Group\u003c/h2\u003e\n\u003cp\u003eThey are a great way for grouping similar measures, but they currently have a great problem: they are not available on PowerBI, but you have to use the Tabular model underneath with \u003ca href=\"https://tabulareditor.github.io/\"\u003eTabular Editor\u003c/a\u003e, which is a new tool. I won\u0026rsquo;t talk about them here because I found groups more complicated than useful in my case, even if I acknowledge their potentialities. Eventually, read the chapter again when you\u0026rsquo;ll notice many similar, repeated measures.\u003c/p\u003e\n\u003cp\u003eIn short, instead of having many measures like\n\u003ccode\u003eYTD Sales Amount := CALCULATE ( [Sales Amount], DATESYTD ( 'Date'[Date] ) )  YTD Total Cost := CALCULATE ( [Total Cost], DATESYTD ( 'Date'[Date] ) )  YTD Margin := CALCULATE ( [Margin], DATESYTD ( 'Date'[Date] ) )\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eYou can create a Calculation Group, hereby called â€œTime Intelligenceâ€, and use them as \u003ccode\u003eCALCULATE ( [Sales Amount], 'Time Intelligence'[Time calc] = \u0026quot;YTD\u0026quot; )\u003c/code\u003e etc\u0026hellip; The Time Intelligence group is like a function accepting as input parameter the field to apply to its in-memory formula. They must be simple, without aggregating different calculations. Avoid recursions and follow the best practices in the chapter\u0026rsquo;s examples. Low priority for me, as said.\u003c/p\u003e\n\u003ch2 id=\"10--working-with-the-filter-context\"\u003e10 ğŸ”„ Working with the filter context\u003c/h2\u003e\n\u003ch3 id=\"understanding-the-differences\"\u003eUnderstanding the differences\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eSELECTEDVALUE\u003c/code\u003e vs \u003ccode\u003eHASONEVALUE\u003c/code\u003e: when using a filter, remember that filters should never return anything, but rather a default value. Use the \u003ccode\u003eSELECTEDVALUE\u003c/code\u003e shortcut, equivalent to \u003ccode\u003eIF(HASONEVALUE, â€¦)\u003c/code\u003e, that accepts a second parameter to return in case of #value != 1. To be used with slicers\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eISFILTERED\u003c/code\u003e vs \u003ccode\u003eISCROSSFILTERED\u003c/code\u003e: the first returns a boolean about the presence of filters on the table, while the latter also checks the filters on related tables that have relationships with the element passed as a parameter. In fact, if you crossfilter a column, the entire table is classified as True by \u003ccode\u003eISCROSSFILTERED\u003c/code\u003e. Remember that a table can be filtered (thus \u003ccode\u003eISFILTERED\u003c/code\u003e gives True), yet it shows all the values (e.g. filter \u003ccode\u003eCustomer[City] \u0026lt;\u0026gt; \u0026quot;DAXâ€\u003c/code\u003e, which won\u0026rsquo;t ever happen), so treat is carefully\u0026hellip;\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eVALUES\u003c/code\u003e vs \u003ccode\u003eFILTERS\u003c/code\u003e: the first shows all the values visible in the filter context, the latter the values filtered in the filter context given as an argument. Sometimes they are the same, but if there are other active filters, \u003ccode\u003eVALUES\u003c/code\u003e may show fewer results! I think that \u003ccode\u003eFILTERS\u003c/code\u003e should be used only for telling the user that at the moment he has selected those values in his slicer, or for creating tables/showing values independently from other filters\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eALLEXCEPT\u003c/code\u003e vs \u003ccode\u003eALL\u003c/code\u003e/\u003ccode\u003eVALUES\u003c/code\u003e: a classic from the book, it compares the two functions several times. They are used for selecting a single filter context from the total, using \u003ccode\u003eALL\u003c/code\u003e(no filters) \u003ccode\u003eEXCEPT\u003c/code\u003e (filter). The first can have dangerous side effects (see Chapter 14) because it removes other filters, while a formula like \u003ccode\u003eAll Values Type := CALCULATE ( [NumOfCustomers], ALL ( Customer ), VALUES ( Customer[Customer Type] ) )\u003c/code\u003e gives you back the \u0026lsquo;pure\u0026rsquo; result, only considering the filter on the type and removing the famous context transition. Use it.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eISEMPTY\u003c/code\u003e vs \u003ccode\u003eCOUNTROWS(VALUES) = 0\u003c/code\u003e: they are the same but the first has better performances\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"data-lineage-and-treatas\"\u003eData Lineage and TREATAS\u003c/h3\u003e\n\u003cp\u003eData lineage (\u003ca href=\"https://www.sqlbi.com/articles/understanding-data-lineage-in-dax/\"\u003esimply explained here\u003c/a\u003e) is a tag that identifies the original column in the data model that we are querying. When selecting some values, PowerBI keeps some metadata, including the lineage specifying which \u0026lsquo;connected\u0026rsquo; columns can be queried using the selected columns. If you use some expressions such as \u003ccode\u003eADDCOLUMNS\u003c/code\u003e, you\u0026rsquo;ll lose the lineage, thus you will just get a raw outpout. This is important to understand for avoiding annoying side effects with filters and slicers.\u003c/p\u003e\n\u003cp\u003eE.g. having an intermediate table created manually like \u003ccode\u003eNewTable = {â€™Redâ€™,â€™Blueâ€™}\u003c/code\u003e, it can\u0026rsquo;t possibly know to be originated from the column \u003ccode\u003eProduct[Color]\u003c/code\u003e, losing all the original relationships. A slicer using NewTable won\u0026rsquo;t filter anything! With \u003ccode\u003eTREATAS\u003c/code\u003e you can forcefully assign another table\u0026rsquo;s characteristics (they must have the same structure of course!). Another good example is when you\u0026rsquo;re creating a table with custom years and you want to use it as a Date table, applying a personalized filter without iterating. Check them out.\u003c/p\u003e\n\u003ch2 id=\"11--handling-hierarchies\"\u003e11 â“ Handling hierarchies\u003c/h2\u003e\n\u003cp\u003eHierarchies aren\u0026rsquo;t natively supported on DAX formulas, thus implementing them can be very tricky. A classic example is when a measure behaves differently based on the active hierarchy, for example with product categories and subcategories. In the book\u0026rsquo;s example, a combination of  \u003ccode\u003ePercOnSubcategory := DIVIDE ( [Sales Amount], CALCULATE ( [Sales Amount], ALLSELECTED ( Product[Product Name] ) ) )\u003c/code\u003e is used for calculating the percentage of each subcategory compared to all the rows of the selected category. Changing the element in the hierarchy can be done by replacing the argument in \u003ccode\u003eALLSELECTED\u003c/code\u003e (Category, Product Name, etc\u0026hellip;).\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eISINSCOPE\u003c/code\u003e is a useful function that simulates a hierarchy focus, returning TRUE if the arg column is filtered and has been used for grouping (thus both row and filter contexts are using it). In the book, it is used for showing BLANK if the calculation is not about the selected hierarchy.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/definitive_guide_dax/dax_9.png\" alt=\"ISINSCOPE 1\"\u003e\n\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/definitive_guide_dax/dax_10.png\" alt=\"ISINSCOPE 2\"\u003e\u003c/p\u003e\n\u003cp\u003eThere are very advanced examples here, I wouldn\u0026rsquo;t recommend them unless they are heavily used in the current. At the moment I\u0026rsquo;m not writing down anything else.\u003c/p\u003e\n\u003ch2 id=\"12--working-with-tables\"\u003e12 ğŸ”„ Working with tables\u003c/h2\u003e\n\u003ch3 id=\"exploring-calculatetable\"\u003eExploring CALCULATETABLE\u003c/h3\u003e\n\u003cp\u003eA common question is about the differences between \u003ccode\u003eFILTER\u003c/code\u003e (which returns a table) and \u003ccode\u003eCALCULATETABLE\u003c/code\u003e (which is like \u003ccode\u003eCALCULATE\u003c/code\u003e but with a table). The latter is very powerful: it changes the context filter first and then calculates the expression; \u003ccode\u003eFILTER\u003c/code\u003e iterates the table and groups together the rows that are included in the filter \u003cstrong\u003ewithout changing the context\u003c/strong\u003e. You should use \u003ccode\u003eCALCULATETABLE\u003c/code\u003e whenever you want a context transition, but there\u0026rsquo;s a limit: it must be applied only on columns that belong to the data model; with measures, \u003ccode\u003eFILTER\u003c/code\u003e becomes necessary. E.g. (\u003ccode\u003eLarge Customers = FILTER ( Customer, [Sales Amount] \u0026gt; 1000000)\u003c/code\u003e). More info about performances \u003ca href=\"https://www.sqlbi.com/articles/filter-vs-calculatetable-optimization-using-cardinality-estimation/\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003ch3 id=\"functions-for-manipulating-tables\"\u003eFunctions for manipulating tables\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eADDCOLUMNS\u003c/code\u003e returns all the rows and columns of the first parameter and adds new columns (as name, column; e.g. \u003ccode\u003eColorsWithSales = ADDCOLUMNS ( VALUES ( 'Product'[Color] ), \u0026quot;Sales Amount\u0026quot;, [Sales Amount] )\u003c/code\u003e). It\u0026rsquo;s used in complex formulas whenever creating some intermediate table, to be filtered at the end, becomes necessary.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eSUMMARIZE\u003c/code\u003e is often used for grouping values on one or more columns\u0026hellip; A sort of GROUP BY in SQL. For example, \u003ccode\u003eNum of colors sold := COUNTROWS ( SUMMARIZE ( Sales, 'Product'[Color] ) )\u003c/code\u003e scans the Sales table and returns all the visible values there. With \u003ccode\u003eVALUES\u003c/code\u003e, I would\u0026rsquo;ve seen ALL the colors, whether they had sales or not. Warning: do not use it alone for creating temporary columns: use \u003ccode\u003eADDCOLUMNS\u003c/code\u003e + \u003ccode\u003eSUMMARIZE\u003c/code\u003e, better optimized.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eCROSSJOIN\u003c/code\u003e is like a SQL FULL JOIN, returning all the unique combinations between two tables. It seems slow and badly optimized at first, but sometimes it\u0026rsquo;s better to create a small table with all the combinations between two big tables and scan them with filters, especially when there are many duplicated values. As always, read the examples.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eUNION\u003c/code\u003e unites all the values between two tables/columns and keeps the duplicates (use \u003ccode\u003eDISTINCT\u003c/code\u003e for removing them); it keeps the data lineage only if both sources have the same (so, a self-JOIN): if it loses it, use \u003ccode\u003eTREATAS\u003c/code\u003e for telling the result to which column in the data model belongs.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eINTERSECT\u003c/code\u003e is the opposite: it returns the common values between two columns; less used\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eEXCEPT\u003c/code\u003e is a subtraction: it removes from the first table the rows existing in the second table\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"functions-for-generating-tables\"\u003eFunctions for generating tables\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eSELECTCOLUMNS\u003c/code\u003e selects only the desired columns of a table: it accepts a list of column names, and it can be used when generating a new table from an existing one, usually in an intermediate step for reducing cardinality and ignoring unnecessary columns. If more than a column is passed as parameters, the data lineage is lost.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eROW\u003c/code\u003e returns a table with a single row. It requires a couple of names and expressions like \u003ccode\u003eROW ( \u0026quot;Sales\u0026quot;, [Sales Amount], \u0026quot;Quantity\u0026quot;, SUM ( Sales[Quantity] ) )\u003c/code\u003e; it\u0026rsquo;s deprecated, just use \u003ccode\u003e{}\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eDATATABLE\u003c/code\u003e is a more advanced table constructor; it has a more complex syntax since it requires specifying the type of each column, and you usually use it for hard-coded simple tables. I prefer making them in SQL, so I doubt I\u0026rsquo;ll use the function frequently.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eGENERATESERIES\u003c/code\u003e is like the \u003ccode\u003erange\u003c/code\u003e function: it returns a sequence of elements (dates, numbers) from the starting and ending parameters\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"13--authoring-queries\"\u003e13 âœ¨ Authoring Queries\u003c/h2\u003e\n\u003cp\u003eHere we explore DAX Studio, very useful for testing, formatting and debugging DAX queries. A must-have. Since this article is becoming very long, I recommend watching some Youtube Tutorials like this \u003ca href=\"https://www.youtube.com/watch?v=qeelmG7jcnc\"\u003eone\u003c/a\u003e or this \u003ca href=\"https://www.youtube.com/watch?v=fV2ZK4q3FBQ\"\u003eone\u003c/a\u003e to save time. It\u0026rsquo;s simpler than writing down everything that is presented in the chapter.\u003c/p\u003e\n\u003cp\u003eIn short, with DAX studio you must begin your DAX scripts with the \u003ccode\u003eEVALUATE\u003c/code\u003e statement, which requires a table as the first argument (so, remember: you have to switch \u003ccode\u003eCALCULATE\u003c/code\u003e with \u003ccode\u003eCALCULATETABLE\u003c/code\u003e). With the \u003ccode\u003eDEFINE MEASURE\u003c/code\u003e keyword you can create temporary measures (which need a host table, differently from PowerBI) or variables.\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eDEFINE\r\n VAR Threshold = 200 // VAR is the same\r\n MEASURE Sales[LargeSales] = //LargeSales must be honested on a table like a Calculated Col\r\n\t CALCULATE (\r\n\t [Sales Amount],\r\n\t Sales[Net Price] \u0026gt;= Threshold \t )\r\nEVALUATE\r\n\tADDCOLUMNS (   // using ADDCOLUMNS because it needs a table as input\r\n\t VALUES ( \u0026#39;Product\u0026#39;[Category] ),\r\n\t \u0026#34;Large Sales\u0026#34;, [LargeSales]\r\n\t)\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eSome functions you\u0026rsquo;ll be using for authoring queries:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eSUMMARIZECOLUMNS\u003c/code\u003e (great explanation \u003ca href=\"https://www.sqlbi.com/articles/introducing-summarizecolumns/\"\u003ehere\u003c/a\u003e, a sort of LEFT JOIN) is very useful for composing a query: it requires a set of columns to group (like \u003ccode\u003eSUMMARIZE\u003c/code\u003e), another set of columns to add to the result (like \u003ccode\u003eADDCOLUMNS\u003c/code\u003e) and a set of filters to apply (like the extended form of \u003ccode\u003eCALCULATETABLE\u003c/code\u003e) as arguments. It also removes blank results (bypassable with \u003ccode\u003eIGNORE\u003c/code\u003e). Its huge limitation, making it usable on DAX Studio but not on PowerBI reports, is that it becomes unusable in case of context transition, which punctually happens in charts or matrixes. It\u0026rsquo;s useful for a rapid debug though, I\u0026rsquo;ll keep it in mind\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eTOPN\u003c/code\u003e is another useful expression for scripting: it returns the first N rows of a table, selecting only the columns passed as parameters. It\u0026rsquo;s useful for analyzing a new table without polluting the view with useless columns. \u003ccode\u003eSAMPLE\u003c/code\u003e is similar, but it takes the first and last rows and N rows, returning a sample of the table\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eISONAFTER, GENERATE, TOPNSKIP, ADDMISSINGITEMS, GROUPBY, NATURALINNERJOIN, NATURALLEFTOUTERJOIN, SUBSTITUTEWITHINDEX\u003c/code\u003e are functions internally used by the PowerBI engine, rarely used by a user, since there are more optimized solutions. Maybe read again their definitions if you see them in some formulas\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"14--advanced-dax-concepts\"\u003e14 ğŸ”„ Advanced DAX concepts\u003c/h2\u003e\n\u003ch3 id=\"expanded-tables\"\u003eExpanded Tables\u003c/h3\u003e\n\u003cp\u003eExpanded Tables are the core of DAX. Remember that every time you select a table, there\u0026rsquo;s a hidden world behind it that includes all its relationships!\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/definitive_guide_dax/dax_11.png\" alt=\"Expanded Tables 1\"\u003e\n\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/definitive_guide_dax/dax_12.png\" alt=\"Expanded Tables 2\"\u003e\u003c/p\u003e\n\u003cp\u003eWhen selecting a \u003ccode\u003eCALCULATE\u003c/code\u003e filter on the Color column of Product, we can observe that the filter context uses all the linked tables, including Sales! Using \u003ccode\u003eRELATED\u003c/code\u003e, you can work on the related tables existing in the expanded table.\u003c/p\u003e\n\u003ch3 id=\"the-all-functions\"\u003eThe ALL* functions\u003c/h3\u003e\n\u003cp\u003eThese functions can become extremely cumbersome, especially when used inside a \u003ccode\u003eCALCULATE\u003c/code\u003e. Pay a lot of attention to them:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eALL\u003c/code\u003e: it returns all of the DISTINCT values in a column/table. If used in a \u003ccode\u003eCALCULATE\u003c/code\u003e statement, it \u003cstrong\u003eremoves\u003c/strong\u003e any active filter, becoming a sort of REMOVEFILTER. If a column is cross-filtered it does nothing\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eALLEXCEPT\u003c/code\u003e: just like \u003ccode\u003eALL\u003c/code\u003e, but the second parameter is a list of columns that should keep their active filters. It\u0026rsquo;s slightly different from the \u003ccode\u003eALL/VALUES\u003c/code\u003e combination (suggested by the authors): in this case, \u003ccode\u003eALL\u003c/code\u003e removes all filters while \u003ccode\u003eVALUES\u003c/code\u003e keeps the cross-filtering by adding a new filter for the visible values. On the opposite, \u003ccode\u003eALLEXCEPT\u003c/code\u003e only removes filters\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eALLNOBLANKROW\u003c/code\u003e: it returns all the DISTINCT values of a column/table except for, eventually, the blank rows caused by broken relationships in the data model (but not \u0026rsquo;normal\u0026rsquo; blanks, blanks existing because the row just has a NULL value). If used in a \u003ccode\u003eCALCULATE\u003c/code\u003e it adds a filter for ignoring any blank in the result, which is very different!\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eALLSELECTED\u003c/code\u003e: very dangerous, it returns the distinct values in a column/table related to the latest active shadow filter. Remember that \u003cstrong\u003eDAX has no idea about which visual/slicer the user is using on PowerBI\u003c/strong\u003e, thus \u003ccode\u003eALLSELECTED\u003c/code\u003e is using shadow filters behind the scenes for simulating what the user is viewing. You should never use the function in a measure that will be called by other measures, or you will cause dangerous side effects difficult to debug. Read the chapter about shadow filters for more. If used in a \u003ccode\u003eCALCULATE\u003c/code\u003e context, it restores the most recent shadow filter (or does nothing if there isn\u0026rsquo;t any); in the case of multiple columns, it restores a shadow filter for each parameter\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eALLCROSSFILTERED\u003c/code\u003e: it doesn\u0026rsquo;t work as a table function, but only with \u003ccode\u003eCALCULATE\u003c/code\u003e, and removes every filter from the expanded table, so, every table that can be reached used the relationships of the target table. It only removes, never adds filters\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"other-things-to-remember\"\u003eOther things to remember\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eBe careful with shadow filters (which work on the expanded table); they are used by \u003ccode\u003eALLSELECT\u003c/code\u003e and you should never touch them unless you really know what you are doing. Use column filters, and never table filters as arguments for \u003ccode\u003eCALCULATE\u003c/code\u003e expressions for avoiding them as well\u003c/li\u003e\n\u003cli\u003eEvery column of a table has its own data lineage, which is actually its representation on the data model. Whenever a filter acts, it works on the corresponding column in the model. Thus, if you lose the data lineage you won\u0026rsquo;t be able to filter. You have to use \u003ccode\u003eTREATAS\u003c/code\u003e to \u0026rsquo;teach\u0026rsquo; the item about his lost position in the data model and force it back\u003c/li\u003e\n\u003cli\u003eUsually functions for grouping data keep the data lineage; filters with an aggregation generate a new one; same for \u003ccode\u003eROW\u003c/code\u003e and \u003ccode\u003eADDCOLUMNS\u003c/code\u003e (see examples)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"15--advanced-relationship\"\u003e15 âš ï¸ Advanced Relationship\u003c/h2\u003e\n\u003ch3 id=\"calculated-physical-relationships\"\u003eCalculated Physical Relationships\u003c/h3\u003e\n\u003cp\u003eWhen using calculated columns for creating relationships (e.g. the \u003ccode\u003eDiscountDayKey\u003c/code\u003e calculated column, which uses \u003ccode\u003eDay + ProductKey in Sales\u003c/code\u003e for generating the % Discount with a join with the Discount table), be careful about the following details:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eUse \u003ccode\u003eDISTINCT\u003c/code\u003e instead of \u003ccode\u003eVALUES\u003c/code\u003e to avoid circular dependencies\u003c/li\u003e\n\u003cli\u003eUse \u003ccode\u003eALLNOBLANKROW\u003c/code\u003e instead of \u003ccode\u003eALL\u003c/code\u003e to avoid circular dependencies (rare)\u003c/li\u003e\n\u003cli\u003eRemember that \u003ccode\u003eCALCULATE\u003c/code\u003e with the compact syntax hides its \u003ccode\u003eFILTER\u003c/code\u003e and can cause circular dependencies in case of specific blanks. Use the extended version in this situation and read the examples\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"virtual-relationships\"\u003eVirtual Relationships\u003c/h3\u003e\n\u003cp\u003eSometimes creating a relation inside the DAX query is simpler, without setting it up in the data model. It\u0026rsquo;s the same for the final user. However, they are less performant, hard to find in the codebase and more complex to handle.\u003c/p\u003e\n\u003cp\u003eThere\u0026rsquo;s a nice example showing how to transfer a filter with \u003ccode\u003eKEEPFILTERS(TREATAS)\u003c/code\u003e (and maybe \u003ccode\u003eSUMMARIZE\u003c/code\u003e first for extracting the columns we need), then doing the calculations with the same filters applied on the new table; remember to use \u003ccode\u003eKEEPFILTERS\u003c/code\u003e or \u003ccode\u003eTREATAS\u003c/code\u003e will reset them!\u003c/p\u003e\n\u003ch3 id=\"relationships\"\u003eRelationships\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eSMR\u003c/strong\u003e Single-Many Relationship\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eSSR\u003c/strong\u003e Single-Single Relationship (rare)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMMR\u003c/strong\u003e Many-Many Relationship (the most complex; it corresponds to two hidden bridge tables, thus it\u0026rsquo;s weak by nature and doesn\u0026rsquo;t include table expansion. Use the \u0026rsquo;extended form\u0026rsquo; by creating bridge tables whenever you want to show blank values for invalid formats/relationships, otherwise they will be filtered out)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCross-filtering gets mentioned (if a table can filter another one):\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eSingle\u003c/strong\u003e: in one direction only, usually the \u0026lsquo;1\u0026rsquo; in SMR can filter the \u0026lsquo;Many\u0026rsquo; but not vice versa, but you can change it\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eBoth\u003c/strong\u003e: both directions. It\u0026rsquo;s necessary for SSR and the default setting for MMR; be careful, because they can generate ambiguity, creating paths between tables where there shouldn\u0026rsquo;t be one.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eUnless it\u0026rsquo;s necessary, try to use single relationships in the model: if you have two slicers, with a single relationship you won\u0026rsquo;t filter out the second slicer when one is active. With a \u0026lsquo;both\u0026rsquo; relationship, the second element will display only the available values based on the first filter. It depends on your requirements.\u003c/p\u003e\n\u003cp\u003eBe very careful with ambiguity, it can cause nasty bugs: there could be paths between relationships (e.g. Sales â†’ Date â†’ Store e Sales â†’ Ticket â†’ Date â†’ Store) which can become complicated with the presence of unnecessary cross-filtering. PowerBI takes the shortest road by default, but maybe that\u0026rsquo;s not what you are looking for.\u003c/p\u003e\n\u003ch2 id=\"16--advanced-calculations\"\u003e16 ğŸ”„ Advanced Calculations\u003c/h2\u003e\n\u003cp\u003eShort chapter with a couple of interesting use cases, I liked the first and the last the most:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eWorking days between two dates: it shows some strategies like creating a boolean \u0026lsquo;Is Holiday\u0026rsquo; in the Date Table and counting days while skipping the ones with \u0026lsquo;Is Holiday\u0026rsquo; == False, or, for reducing iterations, groups all orders by date pairs. Read the code in the examples, you\u0026rsquo;ll learn a lot. The best solution is a calculated table with all the distinct combinations, which greatly reduces the iterations during the scanning process.\u003c/li\u003e\n\u003cli\u003eBudget and Sales together: not useful in my situation. It creates a measure for every row with a month that shows the expected budget for the future (when Sales are still null), or the past Sales. It uses \u003ccode\u003eKEEPFILTERS\u003c/code\u003e with a cool trick with Max Date for reducing iterations\u003c/li\u003e\n\u003cli\u003eComputing same-store sales: not useful, the example describes a measure for considering the sales on the multi-year total only if the store was open on that specific year\u003c/li\u003e\n\u003cli\u003eNumbering events: it can be valuable because if you try to brute-force this one you\u0026rsquo;ll have a bad time. The author wants to number the rows of a table based on the occurrences of the customer\u0026rsquo;s name (so the rows will be 1 Jon 33 EUR, 2 Jon 34 EUR, 1 Bob 2 EUR, 1 Sam 4 EUR, 2 Sam 5 EUR etc\u0026hellip;). The right tool is \u003ccode\u003eRANKX\u003c/code\u003e with a \u003ccode\u003ecustomerkey = currentCustomerKey\u003c/code\u003e filter, very effective.\u003c/li\u003e\n\u003cli\u003eComputing LY YTD: very useful, I\u0026rsquo;ve already challenged this one in the past. It uses a \u003ccode\u003eTREATAS\u003c/code\u003e to keep the data lineage, then \u003ccode\u003eSAMEPERIODLASTYEAR\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"17--the-dax-engine\"\u003e17 âœ¨ The DAX Engine\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/definitive_guide_dax/dax_13.png\" alt=\"DAX Engine\"\u003e\u003c/p\u003e\n\u003cp\u003eA technical segment that shows what\u0026rsquo;s happening behind the scenes. It isn\u0026rsquo;t focused on \u003cstrong\u003eDirectQuery\u003c/strong\u003e, which is just a SQL query translated and optimized by the Formula Engine, but rather on \u003cstrong\u003eVertiPaq\u003c/strong\u003e, which uses an in-memory copy of the table which will be queried by the Formula Engine too (it doesn\u0026rsquo;t work with uncompressed tables).\u003c/p\u003e\n\u003cp\u003eA third query mode can be \u003cstrong\u003eDual\u003c/strong\u003e, with a table read in-memory during data refresh, but read with DirectQuery at query time.\u003c/p\u003e\n\u003cp\u003eVertiPaq is a columnar database, very effective when you want to filter many rows on a few columns, but slower when filtering a few rows on many columns. Its structure is a transposition of a classic database. Its objective is to be as efficient as possible by compressing data with several methods: hash encryption, unit encoding, RLE, intermediate tables and so on\u0026hellip;\u003c/p\u003e\n\u003ch3 id=\"optimization\"\u003eOptimization\u003c/h3\u003e\n\u003cp\u003eYou have to keep in mind only one thing from this section: the performance cost of a relationship depends on the cardinality (the number of unique values) of the columns used in the relationship. Over 100k unique values the delay becomes noticeable, so pay attention when using \u003ccode\u003eRELATED\u003c/code\u003e or cross-filtering different tables.\u003c/p\u003e\n\u003ch3 id=\"materialization\"\u003eMaterialization\u003c/h3\u003e\n\u003cp\u003eIt\u0026rsquo;s a step in the query execution process used with columnar DBs. Every time the formula engine makes a request, it receives back a temporary table called datacache; it\u0026rsquo;s a materialization that will be consumed in both cases: DirectQuery or VertiPaq. It\u0026rsquo;s the engine\u0026rsquo;s way to get access to raw data. If the datacache has the same cardinality of the final result it\u0026rsquo;s considered \u0026rsquo;late\u0026rsquo; (very rare for complex calculations), otherwise, it will be \u0026rsquo;early\u0026rsquo;. Just remember that datacaches are intermediate data between the raw DB query in SQL and the processing engines.\u003c/p\u003e\n\u003ch3 id=\"aggregation\"\u003eAggregation\u003c/h3\u003e\n\u003cp\u003eIt\u0026rsquo;s an engine trick for optimizing the storage engine queries by using group by clauses. The most common aggregations are already included in the tables, ready to be used.\u003c/p\u003e\n\u003cp\u003eFurthermore, there are details about the Hardware, not interesting in my case.\u003c/p\u003e\n\u003ch2 id=\"18--optimizing-vertipaq\"\u003e18 â“ Optimizing VertiPaq\u003c/h2\u003e\n\u003cp\u003eThe book introduces DVM, with several examples for monitoring every table\u0026rsquo;s size and relationships. I will not go into it further.\u003c/p\u003e\n\u003ch3 id=\"denormalization\"\u003eDenormalization\u003c/h3\u003e\n\u003cp\u003eEvery relationship has a memory cost. VertiPaq tries to denormalize unused tables, reducing their column and relationships. There could be problems (technical problems) when this clashes with another tendency of VertiPaq: normalizing everything for speeding up operations and creating tons of intermediate tables. Eventually, the book suggests forcefully creating inactive/active relationships \u0026lsquo;forcing\u0026rsquo; the engine to denormalize some tables/columns and avoiding performance issues. I didn\u0026rsquo;t understand this part well, honestly.\u003c/p\u003e\n\u003ch3 id=\"cardinality\"\u003eCardinality\u003c/h3\u003e\n\u003cp\u003eAs said before, it\u0026rsquo;s the number of unique values that a column contains; it\u0026rsquo;s an important measure for calculating the size of the column, which will in turn impacts the VertiPaq performances. Here are some tricks for reducing cardinality:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRound floats whenever possible\u003c/li\u003e\n\u003cli\u003eFor images: store a URL string, PowerBI can\u0026rsquo;t process plain images\u003c/li\u003e\n\u003cli\u003eTransactions IDS: they are unique values, causing max cardinality, but are rarely used. Take them away\u003c/li\u003e\n\u003cli\u003eDate and Time: it\u0026rsquo;s better to split the Date column into two: a Date (with days only) and Time (with values from 00.00 to 23.59): there are some example scripts, reducing the cardinality of the Date table by A LOT. It\u0026rsquo;s a great way to optimize a model\u003c/li\u003e\n\u003cli\u003eAudit columns: they are rarely used (such as \u0026rsquo;last edited\u0026rsquo; and \u0026rsquo;last edited by\u0026rsquo;), don\u0026rsquo;t import them\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"calculated-columns-1\"\u003eCalculated Columns\u003c/h3\u003e\n\u003cp\u003eThey can be useful for optimization since they are evaluated row-by-row after a table refresh, but it\u0026rsquo;s always the case. Predicting if the performance will be better or worse is difficult because calculated columns aren\u0026rsquo;t as optimized as the \u0026rsquo;normal\u0026rsquo; columns on the DB. You have to try and compare the outputs. Usually, they are suggested when filtering and grouping data, and when considering boolean types.\u003c/p\u003e\n\u003cp\u003eRemember that unnecessary ID columns that aren\u0026rsquo;t used in the model have the highest cardinality and are just slowing down the model. Prioritize qualitative columns (such as category or date range) and import quantitative columns, which often have high cardinality, only if necessary.\u003c/p\u003e\n\u003ch2 id=\"19--analyzing-dax-queries\"\u003e19 ğŸ”„ Analyzing DAX Queries\u003c/h2\u003e\n\u003cp\u003eWith DAX Studio it is possible to analyze all the queries we are making through PowerBI and recognize the slower ones. It\u0026rsquo;s shown that the Formula Engine creates a Logical Tree (by translating DAX into instructions) and then a Physical Tree (lower level instructions for the machine)\u003c/p\u003e\n\u003ch3 id=\"plans\"\u003ePlans\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eDAX\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/definitive_guide_dax/dax_14.png\" alt=\"DAX\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eLogical Query Plan: it\u0026rsquo;s still easy to trace back its relationship with the original DAX version. In this case, it corresponds to â€œCreate a table with a column named Value, filled with the content of a SUM operation, performed by the storage engine by scanning the Quantity column in the Sales table.â€\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/definitive_guide_dax/dax_15.png\" alt=\"Logical Query Plan\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ePhysical Query Plan: it looks similar to the Logical Tree, but it goes deeper, with different operators and a more complex structure, difficult to interpret. Some important details are hidden here though! Pay attention to ProjectionSpool, which shows the number of records picked up by the engine from the DB with a SQL query. Being the step a single thread and using memory, it could be a bottleneck\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/definitive_guide_dax/dax_16.png\" alt=\"Physical Query Plan\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ethe XmSQL query generated by the Storage Engine\u0026rsquo;s ProjectionSpool, which is what the database will receive as input. This is just the SQL conversion of the previous step, you can\u0026rsquo;t intervene\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/definitive_guide_dax/dax_17.png\" alt=\"XmSQL\"\u003e\u003c/p\u003e\n\u003cp\u003eThen, there are some technicalities about xmSQL, not really my cup of tea. Just a final reminder: remember to clean up the cache before analyzing performances, since the engine stores previous datacaches in memory and the processing speed will be faster than in reality.\u003c/p\u003e\n\u003ch3 id=\"callbackdataid\"\u003eCallbackDataId\u003c/h3\u003e\n\u003cp\u003eIf in the DAX formula there are complex elements such as \u003ccode\u003eIF\u003c/code\u003e or \u003ccode\u003eSQRT\u003c/code\u003e, then the Formula Engine will insert in its XmSQL query plan the CallbackDataId statement. E.g. for a \u003ccode\u003eROUND\u003c/code\u003e, there will be something like\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eWITH\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eExpr0 :\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [CallbackDataID ( ROUND ( Sales[Line Amount]] ), \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e ) ]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e( PFDATAID ( Sales[Line Amount] ) )\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eSELECT\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eSUM\u003c/span\u003e ( \u003cspan style=\"color:#f92672\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e$\u003c/span\u003eExpr0 )\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eFROM\u003c/span\u003e Sales;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThese calls are more expensive and they can\u0026rsquo;t be stored in the cache. Knowing that you can optimize some measures by using simple elements, like replacing a \u003ccode\u003eIF denominator != 0\u003c/code\u003estatement with a \u003ccode\u003eSUMX + FILTER (denominator \u0026lt;\u0026gt; 0)\u003c/code\u003e. Yeah, just avoid \u003ccode\u003eIF\u003c/code\u003es if you can. Of course, sometimes CallbackDataID must be used, there\u0026rsquo;s no problem\u0026hellip; Just be aware of that\u003c/p\u003e\n\u003ch2 id=\"20--optimizing-dax\"\u003e20 â“ Optimizing DAX\u003c/h2\u003e\n\u003cp\u003eLast chapter with some ideas for speeding up executions, but it really depends on the data underneath so these aren\u0026rsquo;t fixed rules. Try every solution before accepting it.\u003c/p\u003e\n\u003cp\u003eThe optimization process in DAX is:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eIdentify a SINGLE query in DAX. With complex formulas, try to break them down into smaller steps (well commented)\u003c/li\u003e\n\u003cli\u003eCreate a query in DAX Studio simulating the selected step. Use \u003ccode\u003eEVALUATE\u003c/code\u003e and \u003ccode\u003eCALCULATE(TABLE)\u003c/code\u003e as we have seen in Chapter 13. DAX Studio has a \u0026ldquo;Define Measureâ€ button that already creates a query in the lateral panel, check it out!\u003c/li\u003e\n\u003cli\u003eAnalyze the execution times of the server and the information in the query plan\u003c/li\u003e\n\u003cli\u003eIdentify bottlenecks in both SE and FE. For example, if %SE \u0026raquo; %FE something\u0026rsquo;s wrong with the DAX formula. Start from the Storage Engine queries (both Physical and Logical) and see how many records are picking up\u003c/li\u003e\n\u003cli\u003eImplement changes and re-run the query to observe if the performances have improved\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"optimizing-dax-expressions\"\u003eOptimizing DAX expressions\u003c/h3\u003e\n\u003cp\u003eUsually, the causes of long runtimes of a DAX formula are:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eLonger scan times: cardinality matters here: the more unique values you have, the more time the scanning operators need\u003c/li\u003e\n\u003cli\u003eHigh Cardinality: same. It will be an issue for \u003ccode\u003eCOUNT\u003c/code\u003e and \u003ccode\u003eCALCULATE\u003c/code\u003e\u0026rsquo;s filters in particular\u003c/li\u003e\n\u003cli\u003eHigh presence of CallbackDataID: remember to use simple operators if you can\u003c/li\u003e\n\u003cli\u003eLarge Materialization: if the datacache is large, more RAM will be needed. Usually, this depends on the size of the data you want to analyze\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"tips\"\u003eTips\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eOptimizing filters: in \u003ccode\u003eCALCULATE\u003c/code\u003e statements, the filter parameter must act on columns and not on entire tables (avoiding both the use of shadow filters and storing the whole table in memory). You should use a \u003ccode\u003eKEEPFILTERS\u003c/code\u003e instead for keeping the current filters and then selecting just the columns you want\u003c/li\u003e\n\u003cli\u003eOptimizing context transition: this is more complex, please read the example. Here, instead of using a \u003ccode\u003eSUMX\u003c/code\u003e over \u003ccode\u003eCustomers, Sales Amount x Cashback %\u003c/code\u003e, the book uses \u003ccode\u003eSUMX\u003c/code\u003e over \u003ccode\u003eVALUES(Customer[Cashback%], Sales Amount x Cashback %\u003c/code\u003e. By just using \u003ccode\u003eVALUES\u003c/code\u003e and selecting only the visible cashback in the current filters, there is a smaller datacache in memory and a faster query. Otherwise, the default strategy would have been of calculating the cashback for every combination of customerKey in the table, and then filter\u003c/li\u003e\n\u003cli\u003eOptimizing \u003ccode\u003eIF\u003c/code\u003e conditions: \u003ccode\u003eIF\u003c/code\u003es are slow because they always need a CallbackDataID, and this can slow the query down, especially when multiple conditional checks happen for every row. Avoid them by using a \u003ccode\u003eCALCULATE\u003c/code\u003e+\u003ccode\u003eKEEPFILTERS\u003c/code\u003estatement during some edge cases (see example)\u003c/li\u003e\n\u003cli\u003eChoose between \u003ccode\u003eIF\u003c/code\u003e and \u003ccode\u003eDIVIDE\u003c/code\u003e: already mentioned before. For divisions, where you don\u0026rsquo;t want errors in the case of denominators == 0, use \u003ccode\u003eDIVIDE\u003c/code\u003e instead of an \u003ccode\u003eIF\u003c/code\u003e statement because the first is way better optimized\u003c/li\u003e\n\u003cli\u003eOptimizing \u003ccode\u003eIF\u003c/code\u003e in iterators: another strategy for avoiding slowdowns with conditional statements and iterations is to use two \u003ccode\u003eCALCULATE\u003c/code\u003e with filters. Again, see the example, sometimes this strategy can be slow, but it\u0026rsquo;s easily scalable\u003c/li\u003e\n\u003cli\u003eReducing the use of CallbackDataID: this is very nice; you can replace \u003ccode\u003eSUMX(Sales, Sales[Quantity] * ROUND(Sales[Net Price],0))\u003c/code\u003e with \u003ccode\u003eSUMX(VALUES(Sales[Net Price], CALCULATE(SUM(Sales[Quantity]) * ROUND(Sales[Net Price]0)\u003c/code\u003e and the engine will store part of the query in memory, speeding up future operations! Then CallbackDataID will be used for the second part, but at least it\u0026rsquo;s an improvement. Be careful that if Net Price has high cardinality the trick is useless\u003c/li\u003e\n\u003cli\u003eAvoid table filters for \u003ccode\u003eDISTINCTCOUNT\u003c/code\u003e: if used with a \u003ccode\u003eCALCULATE\u003c/code\u003e and a filter on, say, the Sales table, it will apply a query for each product! Slow, veeeery slow! The optimized version uses \u003ccode\u003eKEEPFILTERS(FILTER(ALL(Sales[Quantity], Sales[Net Price]), *your_filters)\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","description":"","image":"/images/definitive_guide_dax/cover.jpg","permalink":"https://mutt0-ds.github.io/posts/2022/09/personal-notes-about-dax-definitive-guide/","title":"Personal Notes about The Definitive Guide to DAX"},{"content":"\u003cp\u003eI was feeling curious\u0026hellip; So, I decided to challenge myself and try to learn a bit more about \u003cem\u003e\u003cstrong\u003eCO\u003c/strong\u003emmon \u003cstrong\u003eB\u003c/strong\u003eusiness-\u003cstrong\u003eO\u003c/strong\u003eriented \u003cstrong\u003eL\u003c/strong\u003eanguage\u003c/em\u003e aka \u003ca href=\"https://en.wikipedia.org/wiki/COBOL\"\u003eCOBOL\u003c/a\u003e, invented in 1959 by IBM. Itâ€™s not the most popular among programmers, being extremely old and with huge limitations compared to todayâ€™s modern languages\u0026hellip; Yet, as we will see, itâ€™s still alive, hidden in huge legacy codebases in the form of spaghetti code and difficult to get rid of without  an entire system redesign.\u003c/p\u003e\n\u003cp\u003eEspecially in the banking sector, this is a delicate topic because 3 trillion $ depend on COBOL code (95% of ATMs and 80% of all in-person credit card transaction are using it, \u003ca href=\"http://fingfx.thomsonreuters.com/gfx/rngs/USA-BANKS-COBOL/010040KH18J/\"\u003eReuters says\u003c/a\u003e), and few programmers want to mess up with something so critically important thatâ€™s still working reliably.\u003c/p\u003e\n\u003cp\u003eI also recommend \u003ca href=\"https://www.youtube.com/watch?v=7d7-etf-wNI\"\u003ethis brief introduction in 100 seconds\u003c/a\u003e if you are looking for a quick recap.\u003c/p\u003e\n\u003cp\u003eManaging legacy code of half a century ago is not my dream, but maybe, I thought, there\u0026rsquo;s something to learn from it! That\u0026rsquo;s why I\u0026rsquo;m here, sharing notes and personal thoughts about my overall experience with \u003ca href=\"https://www.ibm.com/blogs/ibm-training/free-course-announcing-learning-cobol-programming-with-vscode/\"\u003eIBM\u0026rsquo;s COBOL course for VS Code\u003c/a\u003e and this detailed tutorial by Derek Banas that saved me several times.\u003c/p\u003e\n\u003ciframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/TBs7HXI76yU\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen\u003e\u003c/iframe\u003e\r\n\u003ch2 id=\"cobols-essentials\"\u003eCOBOL\u0026rsquo;s essentials\u003c/h2\u003e\n\u003cp\u003eThe first impression isn\u0026rsquo;t great, since it\u0026rsquo;s such verbose language\u0026hellip; Let\u0026rsquo;s compare aâ€œHello Worldâ€ in Python, JS, and COBOL:\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e# ğŸ Python\r\nprint(\u0026#39;Hello World\u0026#39;)\r\n\r\n# ğŸ‘©â€ğŸ’» Javascript\r\nconsole.log(\u0026#39;Hello World\u0026#39;)\r\n\r\n# ğŸ˜¯ COBOL\r\n000001 IDENTIFICATION DIVISION.\r\n000002 PROGRAM-ID.     HELLOWORLD.\r\n000003 ENVIRONMENT DIVISION.\r\n000004 CONFIGURATION SECTION.\r\n000005 DATA DIVISION.\r\n000006 PROCEDURE DIVISION.\r\n000007\r\n000008     DISPLAY \u0026#39;HELLO WORLD.\u0026#39;.\r\n000009     STOP RUN.\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe line numbers and the indentation are peculiar because back in the day the code was written on physical punch cards!\nAlso, all the variables are global and have to be defined at the beginning of the code, in the WORKING-STORAGE SECTION. Since module imports are cumbersome, there\u0026rsquo;s a tendency of writing programs in monolithic blocks with so many declarations that finding unique names becomes a big issue.\u003c/p\u003e\n\u003cp\u003e\u003cdel\u003eIn addition, \u003ca href=\"https://stackoverflow.com/a/17616222\"\u003ebefore 2002, COBOL didnâ€™t support comments\u003c/a\u003e. Imagine working on a codebase of 50 years ago, with millions of dollars depending on it, thousands of variables, and no way to understand who, why and how someone made that choice in the 60s.\u003c/del\u003e (UPDATE: \u003ca href=\"https://nvlpubs.nist.gov/nistpubs/Legacy/hb/nbshandbook106.pdf\"\u003ethat\u0026rsquo;s wrong, the presence of comments is mentioned in older textbooks\u003c/a\u003e)\u003c/p\u003e\n\u003cp\u003eDespite its flaws, COBOL remains an easy language to learn and read, since it targets non-technical people by using English statements similar to SQL. Itâ€™s extremely stable and precise, thus its longevity.\u003c/p\u003e\n\u003ch2 id=\"how-to-setup-a-cobol-environment\"\u003eHow to setup a COBOL environment\u003c/h2\u003e\n\u003cp\u003eAt first, I laughed hard at Visual Studio Code displaying the punch card lines on the screen, but then the difficulties began when installing the compiler.\u003c/p\u003e\n\u003cp\u003eLuckily the Derek Banas video and \u003ca href=\"https://www.it-cooking.com/projects/how-to-install-gnucobol-for-cygwin/\"\u003ethis blog post\u003c/a\u003e contain a step-by-step installation guide. Iâ€™ll leave you to them if you are really willing to follow my path, I want to keep the post lightweight. It was quite a complex process, luckily everything was well documented.\u003c/p\u003e\n\u003cp\u003eIn short, I had to install on my Windows machine:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.cygwin.com/\"\u003ecygwin\u003c/a\u003e, a sort of Linux distro on Windows\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://gnucobol.sourceforge.io/\"\u003eGNUCOBOL\u003c/a\u003e, the compiler\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eALL\u003c/strong\u003e the libraries listed in \u003ca href=\"https://www.it-cooking.com/projects/how-to-install-gnucobol-for-cygwin/\"\u003ethe tutorial\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThen I ran the \u003ccode\u003e.configure\u003c/code\u003e script and waited for the completion (around 20 minutes). After that, I pasted the Hello World code of the previous paragraph into a hello.cob file and typed on cygwin \u003ccode\u003ecobc -x hello.cob \u0026amp;\u0026amp; ./hello\u003c/code\u003e to compile the code in a .exe and execute it.\u003c/p\u003e\n\u003ch2 id=\"what-i-did\"\u003eWhat I did\u003c/h2\u003e\n\u003cp\u003eI mostly messed around with COBOLâ€™s basic commands, created some tables, an interactive menu, performed calculations and logical operations.\u003c/p\u003e\n\u003cp\u003eYou can find a folder with my experiments \u003ca href=\"https://github.com/mutt0-ds/cobol-experiments\"\u003ehere\u003c/a\u003e, most of them are taken from the Derek Banas tutorial.\u003c/p\u003e\n\u003cp\u003eAfter having coded a bit, I tackled \u003ca href=\"https://www.ibm.com/blogs/ibm-training/free-course-announcing-learning-cobol-programming-with-vscode/\"\u003eIBMâ€™s course\u003c/a\u003e, which is not very long (16 hours, in theory, it took me way less to finish it because I already knew the basics) and adds some details about the different parts of a COBOL program, the differences between some versions and some simple patterns.\u003c/p\u003e\n\u003ch2 id=\"my-takeaways\"\u003eMy takeaways\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eWith COBOL, creating long spaghetti code is extremely easy and often unavoidable. Itâ€™s not an OOP, all the variables are global, loops and functions are extremely verbose, and importing other modules is not so easy.\u003c/li\u003e\n\u003cli\u003eItâ€™s also very clear and stable, and a non-technical person can easily read the code and figure out what it does.\u003c/li\u003e\n\u003cli\u003eI can see why COBOL has been the standard for ATMs all over the world: itâ€™s very powerful for making calculations, building reports and simple interactive menus to display on the terminal as an ATM does.\u003c/li\u003e\n\u003cli\u003eThere are several sections, for example for defining the data, the environment, the variables and then the process.\u003c/li\u003e\n\u003cli\u003eThe most annoying detail for me is that you have to define in advance (in the WORKING-STORAGE SECTION) the type and the size of the global variables you are going to use. If, for example, a string is longer than the N characters youâ€™ve assigned to its variable, well screw you, it will be truncated. If itâ€™s shorter, then COBOL will add a bunch of spaces before it.\u003c/li\u003e\n\u003cli\u003eAlso, arrays start at 1. So weird!\u003c/li\u003e\n\u003cli\u003eI read that \u003ca href=\"https://www.hackerrank.com/blog/the-inevitable-return-of-cobol/\"\u003eCOBOL programmers are well paid because thereâ€™s a scarcity of them\u003c/a\u003e, but be aware: learning the language is simple, what companies are looking for is someone willing to maintain such a cumbersome legacy codebase, with the ability to understand its complexities.\u003c/li\u003e\n\u003cli\u003eThe stability and the rigidity of the language are evident, I can see why itâ€™s so difficult to replace without adding bugs, especially on mathematical operations.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"what-have-i-learned\"\u003eWhat have I learned?\u003c/h2\u003e\n\u003cp\u003eStudying COBOL has certainly opened my eyes to how much technology has evolved during the years, but at the same time, I am fascinated by how this 63-year-old creature has kept many similarities to todayâ€™s stacks, for example with IF and SWITCH statements, tables, and functions. The basics are always the same.\u003c/p\u003e\n\u003cp\u003eI donâ€™t recommend IBMâ€™s course, verbose and not very intuitive (unless you want the certification?), while Derekâ€™s tutorial helped in getting my hands dirty and with the setup.\u003c/p\u003e\n\u003cp\u003eIt\u0026rsquo;s easy to make fun of COBOL and its archaic limits, but letâ€™s not forget the people that were writing my same codes on punch cards, without IDEs, Stack Overflow, the Internetâ€¦ And this code written in such an ancient context is still up today, working incessantly, giving your money when you use the ATM. Jokes apart, I would be proud of it.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://i.imgflip.com/43g61a.jpg\" alt=\"COBOL meme\"\u003e\u003c/p\u003e\n","description":"","image":"/images/meme_cobol.jpg","permalink":"https://mutt0-ds.github.io/posts/2022/09/my-surreal-experience-cobol/","title":"My surreal experience with COBOL"},{"content":"\u003cp\u003eI\u0026rsquo;m back with another post, this time exploring a new CSS framework, \u003ca href=\"https://tailwindcss.com/\"\u003eTailwind CSS\u003c/a\u003e!\u003c/p\u003e\n\u003cp\u003eIn the previous months I started using Angular and Typescript for some small web apps and dashboards, but I always found CSS management cumbersome. I could spend hours tweaking font-size and align-items parameters and hard-coding variables, and this wasn\u0026rsquo;t a lot of fun.\u003c/p\u003e\n\u003cp\u003eThat\u0026rsquo;s why I decided to try Tailwind, which is being heavily recommended by many people in the frontend community! I just needed the right idea before starting to code\u0026hellip;\u003c/p\u003e\n\u003ch2 id=\"-the-dashboard\"\u003eğŸ“Š The Dashboard\u003c/h2\u003e\n\u003cp\u003eThe idea was: I want to show the books I\u0026rsquo;ve been reading, with a nice UI!\u003c/p\u003e\n\u003cp\u003eI deployed \u003ca href=\"https://my-personal-library.netlify.app/\"\u003ea live demo of my dashboard on Netlify\u003c/a\u003e, while if you are interested in the code, the public repository is \u003ca href=\"https://github.com/mutt0-ds/my-books-tailwind\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/my-books-tailwind/main/src/assets/demo.gif\" alt=\"demo\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://github.com/mutt0-ds/my-books-tailwind/blob/main/src/assets/selected-book.png?raw=true\" alt=\"book\"\u003e\u003c/p\u003e\n\u003ch2 id=\"-the-dataset-my-books\"\u003eğŸ“š The Dataset: My Books\u003c/h2\u003e\n\u003cp\u003eFor my experiment, I wanted to create something unique, not clones of existing websites or basic pages. Since I\u0026rsquo;m already keeping trace of the books I\u0026rsquo;m reading on a Notion Database, I exported the data from the past two years and used it as a small dataset.\nI would have liked to include my detailed notes, but since I write them only for personal use they were an embarrassing hybrid of Italo-English which was taking too long for a complete translation. This wasn\u0026rsquo;t a data cleaning project!\u003c/p\u003e\n\u003cp\u003eThus I only used the columns Rating (1-5 â­), Brief Recap (a couple of lines\nI write for quickly presenting the book), Category, Author, Title and Date.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/notion-db-books.png\" alt=\"DB\"\u003e\u003c/p\u003e\n\u003ch2 id=\"-angular--tiltjs\"\u003eğŸ“¦ Angular + tilt.js\u003c/h2\u003e\n\u003cp\u003eThe project has been created using the \u003ca href=\"https://angular.io/cli\"\u003eAngular CLI\u003c/a\u003e, and I kept it really simple: there are 3 components.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eThe \u003cem\u003eheader\u003c/em\u003e, where the user can filter the category of the books\u003c/li\u003e\n\u003cli\u003eThe \u003cem\u003esidebar\u003c/em\u003e, for selecting the books from a list\u003c/li\u003e\n\u003cli\u003eThe \u003cem\u003ebook\u003c/em\u003e component, showing the Book Card with some info about the item\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eThe most complex part, because I somehow managed to overcomplicate things, was to read and clean the data from the Notion export. It was just a small CSV, but as I said my notes were a bit messy so I cleaned them directly after the import.\u003c/p\u003e\n\u003cp\u003eI also wanted to have fun with a nice little library called \u003ca href=\"https://github.com/micku7zu/vanilla-tilt.js\"\u003evanilla-tilt.js\u003c/a\u003e, which gives that modern tilting effect to the Book Card.\u003c/p\u003e\n\u003ch2 id=\"-but-why-tailwind\"\u003eğŸŒ¬ï¸ But why Tailwind?\u003c/h2\u003e\n\u003cp\u003eI started with the header and I immediately loved using Tailwind:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-html\" data-lang=\"html\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026lt;\u003cspan style=\"color:#f92672\"\u003ediv\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;sticky top-0 left-0 h-12 md:h-16 w-screen bg-gray-200 shadow-lg z-10\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u0026lt;\u003cspan style=\"color:#f92672\"\u003ediv\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;max-w-xl flex flex-row\u0026#34;\u003c/span\u003e\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026lt;\u003cspan style=\"color:#f92672\"\u003eh1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#a6e22e\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;flex items-center mx-5 md:text-xl text-sm text-blue-500 font-extrabold\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      Davide\u0026#39;s Library\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026lt;/\u003cspan style=\"color:#f92672\"\u003eh1\u003c/span\u003e\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u0026lt;/\u003cspan style=\"color:#f92672\"\u003ediv\u003c/span\u003e\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026lt;/\u003cspan style=\"color:#f92672\"\u003ediv\u003c/span\u003e\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIf you aren\u0026rsquo;t used to Tailwind\u0026rsquo;s unique paradigm, this may look messy. But in three lines the header was ready. Every class represented a CSS property: for example I wanted the header to be sticky at the top, so I gave it the \u003ccode\u003esticky\u003c/code\u003e, \u003ccode\u003etop: 0\u003c/code\u003e, \u003ccode\u003eleft: 0\u003c/code\u003e CSS properties using Tailwind classes. It\u0026rsquo;s very intuitive.\u003c/p\u003e\n\u003cp\u003eI also didn\u0026rsquo;t waste time with shadows: I applied the beautiful \u003ccode\u003eshadow-lg\u003c/code\u003e class and everything was ready.\u003c/p\u003e\n\u003cp\u003eIf you were wondering, \u003ccode\u003ebg-gray-200\u003c/code\u003e and \u003ccode\u003etext-blue-500\u003c/code\u003e are properties for defining the colors of the background and the text, using a \u003ca href=\"https://tailwindcss.com/docs/customizing-colors\"\u003edefault palette\u003c/a\u003e which I could configure in the settings.\u003c/p\u003e\n\u003cp\u003eIn the first hour I was a bit scared to create a monster with several lines of classes in my code, but in the end I found so useful to have HTML and CSS together in a single file. Everything was more intuitive, and I didn\u0026rsquo;t even have to tweak many Tailwind settings, except for a couple of animations I wanted to use. The default classes were already enough for such a simple site.\u003c/p\u003e\n\u003ch2 id=\"-mobile-responsive-you-say\"\u003eğŸ“± Mobile Responsive you say?\u003c/h2\u003e\n\u003cp\u003eI quickly deployed the webpage using the \u003ca href=\"https://www.netlify.com/blog/2019/09/23/first-steps-using-netlify-and-angular/\"\u003eNetlify CLI\u003c/a\u003e and, excited, I sent it via Whatsapp to a friend\u0026hellip; Forgetting that I didn\u0026rsquo;t optimize it for mobile! He saw a messy screen because the Book Card was hovering over the sidebar and the header icons were too big.\u003c/p\u003e\n\u003cp\u003eIt\u0026rsquo;s no use crying over spilled milk. Sobbing, I started to see \u003ca href=\"https://tailwindcss.com/docs/responsive-design\"\u003ehow to optimize a mobile-responsive design with Tailwind\u003c/a\u003e.\u003c/p\u003e\n\u003ch3 id=\"it-was-embarrassingly-trivial\"\u003eIt was embarrassingly trivial.\u003c/h3\u003e\n\u003cp\u003eI will use this code for the book card as an example: I wanted to display it right under the header if the screen was small (\u0026lsquo;md:\u0026rsquo; prefix in Tailwind means screen-size at most 1024px wide). On mobile, this avoids the issue of the card covering the sidebar, making some options unselectable.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-html\" data-lang=\"html\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eclass=\u0026#34;fixed md:top-1/3 md:w-1/2 md:h-96 lg:left-1/3 h-auto w-screen shadow-xl\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebg-white rounded-lg overflow-hidden z-10\u0026#34; *ngIf=\u0026#34;!selectedBook\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eSo, if a book is selected (thus the presence of Angular\u0026rsquo;s *ngIf), based on the screen size of the device the page renders the card in the upper part of the screen with a fixed small height for keeping the proportions correct. If the device is large, the card starts to float in the right section of the screen with a bigger height.\u003c/p\u003e\n\u003cp\u003eOther options included a white background, rounded corner, z-index of 10 and hidden overflow. The result isn\u0026rsquo;t an amazing example of UI design, but I achieved my objective in 5 minutes straight with just a few classes: the sidebar was clickable and the card was easy to read.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/my-books-tailwind/main/src/assets/mobile.png\" alt=\"mobile\"\u003e\u003c/p\u003e\n\u003ch2 id=\"conclusions\"\u003eConclusions\u003c/h2\u003e\n\u003cp\u003eThere are lots of posts explaining why Tailwind CSS is a great framework, such as this \u003ca href=\"https://www.swyx.io/why-tailwind\"\u003eone\u003c/a\u003e and this \u003ca href=\"https://www.webdesignerdepot.com/2021/09/the-pros-and-cons-of-tailwind-css/\"\u003eone\u003c/a\u003e, showing more technical details such as PurgeCSS or how to enable dark mode. I wanted to add my personal experience.\u003c/p\u003e\n\u003cp\u003eWith small projects like my Book Library, it was easy to keep trace of all the long lines full of classes that I had to use for styling the HTML page, and, most importantly, I had a lot of fun while working. I loved the way I was already used to such a disruptive approach after only a few minutes of coding, how the IDE helped me with IntelliSense, how quickly the result started to look good. Tailwind improved my performance by about 20%/30%, since I spend lots of time tweaking my CSS.\u003c/p\u003e\n\u003cp\u003eIt may be counter-intuitive to use it in larger projects, where the bloated HTML could create confusion, but that\u0026rsquo;s a choice I don\u0026rsquo;t have to take right now. For the sake of truth, I recommend \u003ca href=\"https://johanronsse.be/2020/07/08/why-youll-probably-regret-using-tailwind/\"\u003ethis article\u003c/a\u003e showing a different opinion.\nI agree that the framework is going to add a layer of complexity and problems, but considering that styling isn\u0026rsquo;t my personal priority and I just want something quick and easy to use, I\u0026rsquo;m comfortable with that.\u003c/p\u003e\n\u003cp\u003eI\u0026rsquo;ll keep using Tailwind in my future projects after this positive experience.\u003c/p\u003e\n","description":"","image":"/images/selected-book.png","permalink":"https://mutt0-ds.github.io/posts/2022/06/my-books-tailwind/","title":"First time with Tailwind CSS: showing off my books!"},{"content":"\u003cp\u003eHere\u0026rsquo;s the story of how I created my first full-stack project for monitoring my daily activities, using Python and SQL Server in backend and Appsmith for the GUI. I have a lot to learn and process yet, but hey, it\u0026rsquo;s a start.\u003c/p\u003e\n\u003ch2 id=\"-the-problem\"\u003eğŸ˜Ÿ The Problem\u003c/h2\u003e\n\u003cp\u003eThere are scripts I\u0026rsquo;m using that are particularly tedious to monitor. The typical structure is the following:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003eLoad data\u003c/strong\u003e (from a file or manual input)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eSend a request\u003c/strong\u003e to internal DB / very specific API\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCompare the data\u003c/strong\u003e received with the input and if something is wrong, notify me or a colleague.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eThey must operate locally on specific machines, can\u0026rsquo;t be containerized, there are severe API limitations in some cases.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eâ”\u003c/strong\u003e I know that there are some amazing automation libraries like \u003ca href=\"https://airflow.apache.org/\"\u003eAirflow\u003c/a\u003e and \u003ca href=\"https://github.com/spotify/luigi\"\u003eLuigi\u003c/a\u003e, but I chose to not use them because I needed something simpler and more customizable. I also wanted to test myself and build a whole project to be used in my day-to-day work.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eI also needed a custom dashboard (inspired by \u003ca href=\"https://airflow.apache.org/docs/apache-airflow/stable/ui.html\"\u003eAirflow\u0026rsquo;s one\u003c/a\u003e, to be used by my colleagues for monitoring the scripts assigned to their departments, opening tickets, and doing other unique actions.\u003c/p\u003e\n\u003ch2 id=\"-my-proposal\"\u003eğŸ’¡ My Proposal\u003c/h2\u003e\n\u003cp\u003eIn my mind, my logger would consist of three parts:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003eBackend\u003c/strong\u003e: a module to be imported by all the scripts that connect to the Database and store logging data and results. Since the majority of them are in Python, that\u0026rsquo;s the language I\u0026rsquo;m going to use.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eDatabase\u003c/strong\u003e: a SQL Server Express instance we have already set up for other tasks in our local server.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eFrontend\u003c/strong\u003e: I\u0026rsquo;m a newbie here; I needed something quick to spin up, hostable on the server, as easiest as possible to customize, capable to connect with our APIs. \u003ca href=\"https://www.appsmith.com/\"\u003eAppsmith\u003c/a\u003e was the right choice and I had a lot of fun with it.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"-backend-python-module-with-decorator\"\u003eğŸŒ Backend: Python module with decorator\u003c/h2\u003e\n\u003cp\u003eMy starting point was a previously existing library, which was already imported by all the scripts for handling exceptions and crashes. Every script contains this kind of template in its \u003ccode\u003emain.py\u003c/code\u003e file:\u003c/p\u003e\n\u003ch5 id=\"old-alert-library\"\u003eOld Alert Library\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e alert_library\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e():\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# the script does its magic here\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e __name__\u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;__main__\u0026#39;\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003etry\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    main()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eexcept\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eException\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eas\u003c/span\u003e e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    alert_library\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esend_error(e) \u003cspan style=\"color:#75715e\"\u003e# the module handles all the error cases and sends a report\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"the-joblogger-class\"\u003eThe JobLogger class\u003c/h5\u003e\n\u003cp\u003eFrom there, I rewrited the alert_library module into a so-called \u003ccode\u003ejob_logger\u003c/code\u003e, here\u0026rsquo;s its pseudo-code:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e helper_functions\u003cspan style=\"color:#f92672\"\u003e,\u003c/span\u003e db_functions\u003cspan style=\"color:#f92672\"\u003e,\u003c/span\u003e logging\u003cspan style=\"color:#f92672\"\u003e,\u003c/span\u003e etc...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e@dataclass\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eJoblogger\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  job_id: int\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  status: str \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Pending\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003e__post_init__\u003c/span\u003e(self):\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# looking for further data about the job in the db...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    data \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db_functions\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget_job_data(self\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ejob_id)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    self\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ejob_name \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e data\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;job_name\u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e#self.other_useful_info = ...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ebegin_job\u003c/span\u003e():\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    to_upload \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e {\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;job_id\u0026#39;\u003c/span\u003e : self\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e_job_id,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;h_begin\u0026#39;\u003c/span\u003e: datetime\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003enow(),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;status\u0026#39;\u003c/span\u003e: self\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estatus,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#75715e\"\u003e#other_useful_info...}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    self\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003erow_id \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e db_functions\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e_insert_on_db(to_upload)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efinish_job\u003c/span\u003e():\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    self\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estatus \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Done\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    to_upload \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;status\u0026#39;\u003c/span\u003e: self\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estatus,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;h_end\u0026#39;\u003c/span\u003e: datetime\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003enow(),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;message\u0026#39;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;OK\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;needs_validation\u0026#39;\u003c/span\u003e: helper_functions\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003echeck_validation(\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#75715e\"\u003e#other_useful_info...}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      db_functions\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e_update_on_db(self\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003erow_id, to_upload)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ehandle_error\u003c/span\u003e(e: \u003cspan style=\"color:#a6e22e\"\u003eException\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    self\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estatus \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ERROR\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    to_upload \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e {self\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estatus,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;traceback\u0026#39;\u003c/span\u003e: traceback\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eformat_exc(limit\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e, chain\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eFalse\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#75715e\"\u003e#other_useful_info...}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    db_functions\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003e_update_on_db(self\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003erow_id, to_upload)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# + old alert library for sending alerts\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNow all the scripts have this structure:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e job_logger \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e JobLogger\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e():\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# the script does its magic here\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e __name__\u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;__main__\u0026#39;\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  logger \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e JobLogger()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003etry\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    logger\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ebegin_job(job_id \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    main()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    logger\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003efinish_job()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eexcept\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eException\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eas\u003c/span\u003e e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    alert_library\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ehandle_error(e) \u003cspan style=\"color:#75715e\"\u003e# the module handles all the error cases and sends a report\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eMhhh\u0026hellip; slightly unkempt, verbose, and inconvenient to update for my tastes\u0026hellip; Let\u0026rsquo;s fashion a decorator so I don\u0026rsquo;t have to paste so many lines of code into every script!\u003c/p\u003e\n\u003ch3 id=\"the-joblogger-decorator\"\u003eThe JobLogger Decorator\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e job_logger \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e monitor_job\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e@monitor_job\u003c/span\u003e(job_id \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e():\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# the script does its magic here\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e __name__\u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;__main__\u0026#39;\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  main()\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eI admired this solution not only because it\u0026rsquo;s elegant, but eventually \u003cstrong\u003eif a colleague reads the code of the script, he won\u0026rsquo;t get confused by the logger logic\u003c/strong\u003e, and hence one can easily debug the code by commenting on just the decorator line. Simple, isn\u0026rsquo;t it?\u003c/p\u003e\n\u003ch2 id=\"-data-layer--sql-server-database\"\u003eğŸ“¦ Data Layer : SQL Server Database\u003c/h2\u003e\n\u003cp\u003eNot an area I have much expertise in, albeit we simply have an existing instance of a SQL Server upon which I created a new Database as per my convenience. There arenâ€™t a lot of scripts running every hour thus making the amount of data manageable to the point it could be handled even by SQLlite. The fascinating part is that I have already written a module for interacting with this specific database, administering all the permissions, etc.. (the scripts are run by distinct machines by separate owners). I wonâ€™t explore the DB logic upheld here, although the JobLogger database has a few tables:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cem\u003eUser Table\u003c/em\u003e\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eDepartment Table\u003c/em\u003e\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eJob Table\u003c/em\u003e, with all the details referencing the task, name, path, pc that should run it, scheduling details, and if it needs validation, etc\u0026hellip; The Key is the job_id, which is an auto incremental number, and therefore it\u0026rsquo;s significant to specify it in the Python decorator\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eLog History Table\u003c/em\u003e, which is the most important part: the history of all the run activities, including logs, warnings, comments, starting and ending times. Every execution of the \u003ccode\u003emonitor_job\u003c/code\u003e function creates a new row on the table.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"-frontend--appsmith\"\u003eğŸ“Š Frontend : Appsmith\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.appsmith.com/\"\u003e\u003cstrong\u003eAppsmith\u003c/strong\u003e\u003c/a\u003e is an efficient open-source framework to build internal tools with lesser code, easy to spin up, and a charm to work with. I\u0026rsquo;m also studying Angular, but right now time is of the essence and a quick set-up is needed, with access control and unable to cause nuisance until I pick up further skillsets with TypeScript and Javascript (which are utilized in Appsmith widgets, yet there are a few lines).\u003c/p\u003e\n\u003cp\u003eAppsmith is \u003cem\u003eridicously easy\u003c/em\u003e to set up (just run \u003ca href=\"https://docs.appsmith.com/setup/docker#docker-compose-configuration\"\u003ethis docker-compose.yml\u003c/a\u003e), and I was able to connect my DB and the Slack API within a few minutes.\u003c/p\u003e\n\u003cp\u003eA noteworthy feature that remains is \u003cstrong\u003ethe entire Dashboard, including widgets, JS Objects, and connections that can be exported as a simple JSON file\u003c/strong\u003e and imported into another instance of Appsmith. I struck on this discovery when I restarted the docker image, losing all my progress with the test I was creating and struggled hours with the docker commands, until realizing I should download the JSON and store it as a backup. You can also piece it together with a Github repo having SSL.\u003c/p\u003e\n\u003cp\u003eHereâ€™s \u003cstrong\u003ethe final result\u003c/strong\u003e: the \u0026ldquo;\u003cem\u003eDettagli\u003c/em\u003e\u0026rdquo; (Details) button contains additional information and a modal for opening a ticket. I connected a Sendgrid account to the App and quickly invited my colleague to share the fun!\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/mutt0-ds.github.io/master/images/dashboard.jpg\" alt=\"Dashboard\"\u003e\u003c/p\u003e\n\u003ch2 id=\"conclusions\"\u003eConclusions\u003c/h2\u003e\n\u003cp\u003eAs a junior Software Engineer, I have long ways to have comprehensive app-building knowledge, but \u003cstrong\u003emy JobLogger project acts as an enlightening first step\u003c/strong\u003e. I employ it on a daily basis since itâ€™s assisting my colleagues by monitoring our activities, which is excellent considering that I wasnâ€™t even thinking about putting it on (internal) production!\u003c/p\u003e\n\u003cp\u003eMy satisfaction with this outcome of the project is high, as I am already working on embedding more features such as opening tickets for a particular task, and visualizing the scheduled jobs requisite on any day.\u003c/p\u003e\n\u003cp\u003eFun and educative experience indeed, thanks for reading my experience! See you on the next project!\u003c/p\u003e\n","description":"","image":"/images/dashboard.jpg","permalink":"https://mutt0-ds.github.io/posts/2022/03/personal-airflow/","title":"My Personal Airflow - How I'm monitoring my scripts with Python, Appsmith and SQL Server"},{"content":"\u003cp\u003eWell, my GF\u0026rsquo;s tastes in memes are simple: she loves wholesome memes and, most importantly, \u003cstrong\u003eshe loves animals\u003c/strong\u003e.\u003c/p\u003e\n\u003cp\u003eThat\u0026rsquo;s why I created a fun little project that:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eSurfs the subreddit \u003ca href=\"https://www.reddit.com/r/wholesomememes/\"\u003er/wholesomemes\u003c/a\u003e using the reddit API\u003c/li\u003e\n\u003cli\u003eDownloads a few of the hottest memes in the contents folder\u003c/li\u003e\n\u003cli\u003eInitializes a ResNet50 model that recognizes images containing any animal\u003c/li\u003e\n\u003cli\u003eSends them via mail to my GF (positively welcomed)\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"final-email-3-memes-by-default\"\u003eFinal email (3 memes by default)\u003c/h3\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/mutt0-ds/memes-selector/main/media/result.png\" alt=\"finalmail\"\u003e\u003c/p\u003e\n\u003ch3 id=\"reddit\"\u003eReddit\u003c/h3\u003e\n\u003cp\u003eI\u0026rsquo;m using the praw library for downloading the memes, it requires a Reddit Bot enabled.\nUse \u003ca href=\"https://yojji.io/blog/how-to-make-a-reddit-bot\"\u003ethis guide\u003c/a\u003e for creating one, it\u0026rsquo;s a quick process.\u003c/p\u003e\n\u003ch3 id=\"resnet50\"\u003eResNet50\u003c/h3\u003e\n\u003cp\u003eResNet50 (\u003ca href=\"https://keras.io/api/applications/resnet/\"\u003emore info here\u003c/a\u003e) is an Image Recognition model that outputs a probability score (which I\u0026rsquo;m ignoring at the moment) and one of the 1000 labels available. The labels are mapped in the imagenet_class_index, and the first 397 are about animals (mostly cats and dogs).\nSo, if the model\u0026rsquo;s predicted label is in that sublist, we can classify the meme as \u0026ldquo;containing animals\u0026rdquo;.\u003c/p\u003e\n\u003ch3 id=\"email\"\u003eEmail\u003c/h3\u003e\n\u003cp\u003eI\u0026rsquo;m using smtplib for sending the email, so it just requires the email and password of the sender and the email of the receiver.\u003c/p\u003e\n\u003ch3 id=\"code\"\u003eCode\u003c/h3\u003e\n\u003cp\u003eSource code \u003ca href=\"https://github.com/mutt0-ds/memes-selector\"\u003ehere\u003c/a\u003e\u003c/p\u003e\n","description":"","image":"/images/meme_example.png","permalink":"https://mutt0-ds.github.io/posts/2021/05/nn-sending-memes/","title":"Using a Neural Network for sending memes to my girlfriend"}]